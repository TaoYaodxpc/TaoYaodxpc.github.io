<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>TaoYaopcğŸ</title>
  
  
  <link href="https://www.taoyaopc.live/atom.xml" rel="self"/>
  
  <link href="https://www.taoyaopc.live/"/>
  <updated>2023-07-01T16:10:24.910Z</updated>
  <id>https://www.taoyaopc.live/</id>
  
  <author>
    <name>TaoYaopcğŸ</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>åª’èµ„ç®¡ç†æ¨¡å—</title>
    <link href="https://www.taoyaopc.live/posts/6d608cd2.html"/>
    <id>https://www.taoyaopc.live/posts/6d608cd2.html</id>
    <published>2023-06-29T16:00:00.000Z</published>
    <updated>2023-07-01T16:10:24.910Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-æ¨¡å—éœ€æ±‚åˆ†æ"><a href="#1-æ¨¡å—éœ€æ±‚åˆ†æ" class="headerlink" title="1. æ¨¡å—éœ€æ±‚åˆ†æ"></a>1. æ¨¡å—éœ€æ±‚åˆ†æ</h1><h2 id="1-1-æ¨¡å—ä»‹ç»"><a href="#1-1-æ¨¡å—ä»‹ç»" class="headerlink" title="1.1 æ¨¡å—ä»‹ç»"></a>1.1 æ¨¡å—ä»‹ç»</h2><blockquote><p>åª’èµ„ç®¡ç†ç³»ç»Ÿæ˜¯æ¯ä¸ªåœ¨çº¿æ•™è‚²å¹³å°æ‰€å¿…é¡»å…·å¤‡çš„ï¼ŒæŸ¥é˜…ç™¾åº¦ç™¾ç§‘å¯¹å®ƒçš„å®šä¹‰å¦‚ä¸‹ï¼š</p><p>åª’ä½“èµ„æºç®¡ç†(Media Asset Managementï¼ŒMAM)ç³»ç»Ÿæ˜¯å»ºç«‹åœ¨å¤šåª’ä½“ã€ç½‘ç»œã€æ•°æ®åº“å’Œæ•°å­—å­˜å‚¨ç­‰å…ˆè¿›æŠ€æœ¯åŸºç¡€ä¸Šçš„ä¸€ä¸ªå¯¹å„ç§åª’ä½“åŠå†…å®¹(å¦‚è§†/éŸ³é¢‘èµ„æ–™ã€æ–‡æœ¬æ–‡ä»¶ã€å›¾è¡¨ç­‰)è¿›è¡Œæ•°å­—åŒ–å­˜å‚¨ã€ç®¡ç†ä»¥åŠåº”ç”¨çš„æ€»ä½“è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬æ•°å­—åª’ä½“çš„é‡‡é›†ã€ç¼–ç›®ã€ç®¡ç†ã€ä¼ è¾“å’Œç¼–ç è½¬æ¢ç­‰æ‰€æœ‰ç¯èŠ‚ã€‚å…¶ä¸»è¦æ˜¯æ»¡è¶³<a href="https://baike.baidu.com/item/åª’ä½“?fromModule=lemma_inlink">åª’ä½“</a>èµ„æºæ‹¥æœ‰è€…æ”¶é›†ã€ä¿å­˜ã€æŸ¥æ‰¾ã€ç¼–è¾‘ã€å‘å¸ƒå„ç§ä¿¡æ¯çš„è¦æ±‚ï¼Œä¸ºåª’ä½“èµ„æºçš„ä½¿ç”¨è€…æä¾›è®¿é—®å†…å®¹çš„ä¾¿æ·æ–¹æ³•ï¼Œå®ç°å¯¹åª’ä½“èµ„æºçš„é«˜æ•ˆç®¡ç†ï¼Œå¤§å¹…åº¦æé«˜åª’ä½“èµ„æºçš„ä»·å€¼ã€‚</p></blockquote><p>æ¯ä¸ªæ•™å­¦æœºæ„éƒ½å¯ä»¥åœ¨åª’èµ„ç³»ç»Ÿç®¡ç†è‡ªå·±çš„æ•™å­¦èµ„æºï¼ŒåŒ…æ‹¬ï¼šè§†é¢‘ã€æ•™æ¡ˆç­‰æ–‡ä»¶ã€‚</p><p>ç›®å‰åª’èµ„ç®¡ç†çš„ä¸»è¦ç®¡ç†å¯¹è±¡æ˜¯è§†é¢‘ã€å›¾ç‰‡ã€æ–‡æ¡£ç­‰ï¼ŒåŒ…æ‹¬ï¼šåª’èµ„æ–‡ä»¶çš„æŸ¥è¯¢ã€æ–‡ä»¶ä¸Šä¼ ã€è§†é¢‘å¤„ç†ç­‰ã€‚</p><ul><li><p>åª’èµ„æŸ¥è¯¢ï¼šæ•™å­¦æœºæ„æŸ¥è¯¢è‡ªå·±æ‰€æ‹¥æœ‰çš„åª’èµ„ä¿¡æ¯ã€‚</p></li><li><p>æ–‡ä»¶ä¸Šä¼ ï¼šåŒ…æ‹¬ä¸Šä¼ å›¾ç‰‡ã€ä¸Šä¼ æ–‡æ¡£ã€ä¸Šä¼ è§†é¢‘ã€‚</p></li><li><p>è§†é¢‘å¤„ç†ï¼šè§†é¢‘ä¸Šä¼ æˆåŠŸï¼Œç³»ç»Ÿè‡ªåŠ¨å¯¹è§†é¢‘è¿›è¡Œç¼–ç å¤„ç†ã€‚</p></li><li><p>æ–‡ä»¶åˆ é™¤ï¼šæ•™å­¦æœºæ„åˆ é™¤è‡ªå·±ä¸Šä¼ çš„åª’èµ„æ–‡ä»¶ã€‚</p></li></ul><p>ä¸‹å›¾æ˜¯è¯¾ç¨‹ç¼–è¾‘ä¸å‘å¸ƒçš„æ•´ä½“æµç¨‹ï¼Œé€šè¿‡ä¸‹å›¾å¯ä»¥çœ‹åˆ°åª’èµ„ç®¡ç†åœ¨æ•´ä½“æµç¨‹çš„ä½ç½®ï¼š</p><p><img src="./assets/image-20230531170817356.png" alt="image-20230531170817356"></p><h2 id="1-2-ä¸šåŠ¡æµç¨‹"><a href="#1-2-ä¸šåŠ¡æµç¨‹" class="headerlink" title="1.2 ä¸šåŠ¡æµç¨‹"></a>1.2 ä¸šåŠ¡æµç¨‹</h2><h3 id="1-2-1-ä¸Šä¼ å›¾ç‰‡"><a href="#1-2-1-ä¸Šä¼ å›¾ç‰‡" class="headerlink" title="1.2.1 ä¸Šä¼ å›¾ç‰‡"></a>1.2.1 ä¸Šä¼ å›¾ç‰‡</h3><p>æ•™å­¦æœºæ„äººå‘˜åœ¨è¯¾ç¨‹ä¿¡æ¯ç¼–è¾‘é¡µé¢ä¸Šä¼ è¯¾ç¨‹å›¾ç‰‡ï¼Œè¯¾ç¨‹å›¾ç‰‡ç»Ÿä¸€è®°å½•åœ¨åª’èµ„ç®¡ç†ç³»ç»Ÿã€‚</p><p>ä¸‹å›¾æ˜¯ä¸Šä¼ å›¾ç‰‡çš„ç•Œé¢ï¼š</p><p><img src="./assets/wps1-1685524177354-1.jpg" alt="img" style="zoom: 80%;" /></p><h3 id="1-2-2-ä¸Šä¼ è§†é¢‘"><a href="#1-2-2-ä¸Šä¼ è§†é¢‘" class="headerlink" title="1.2.2 ä¸Šä¼ è§†é¢‘"></a>1.2.2 ä¸Šä¼ è§†é¢‘</h3><ol><li>æ•™å­¦æœºæ„äººå‘˜è¿›å…¥åª’èµ„ç®¡ç†åˆ—è¡¨æŸ¥è¯¢è‡ªå·±ä¸Šä¼ çš„åª’èµ„æ–‡ä»¶ã€‚</li></ol><p>ç‚¹å‡»â€œåª’èµ„ç®¡ç†â€</p><p><img src="./assets/wps1-1685700983448-1.jpg" alt="img" style="zoom:50%;" /> </p><p>è¿›å…¥åª’èµ„ç®¡ç†åˆ—è¡¨é¡µé¢æŸ¥è¯¢æœ¬æœºæ„ä¸Šä¼ çš„åª’èµ„æ–‡ä»¶ã€‚</p><p><img src="./assets/wps2-1685700983449-2.jpg" alt="img"> </p><ol><li>æ•™è‚²æœºæ„ç”¨æˆ·åœ¨â€åª’èµ„ç®¡ç†â€é¡µé¢ä¸­ç‚¹å‡» â€œä¸Šä¼ è§†é¢‘â€ æŒ‰é’®ã€‚</li></ol><p><img src="./assets/wps3-1685700983449-3.jpg" alt="img"> </p><p>ç‚¹å‡»â€œä¸Šä¼ è§†é¢‘â€æ‰“å¼€ä¸Šä¼ é¡µé¢</p><p><img src="./assets/wps4-1685700983449-4.jpg" alt="img" style="zoom:50%;" /> </p><ol><li>é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶ï¼Œè‡ªåŠ¨æ‰§è¡Œæ–‡ä»¶ä¸Šä¼ ï¼Œè§†é¢‘ä¸Šä¼ æˆåŠŸä¼šè‡ªåŠ¨å¤„ç†ã€‚</li></ol><p><img src="./assets/wps5-1685700983449-5.jpg" alt="img" style="zoom:67%;" /> </p><h3 id="1-2-3-å¤„ç†è§†é¢‘"><a href="#1-2-3-å¤„ç†è§†é¢‘" class="headerlink" title="1.2.3 å¤„ç†è§†é¢‘"></a>1.2.3 å¤„ç†è§†é¢‘</h3><p>å¯¹éœ€è¦è½¬ç å¤„ç†çš„è§†é¢‘ç³»ç»Ÿä¼šè‡ªåŠ¨å¯¹å…¶å¤„ç†ï¼Œå¤„ç†åç”Ÿæˆè§†é¢‘çš„URLã€‚</p><p>å¤„ç†è§†é¢‘æ²¡æœ‰ç”¨æˆ·ç•Œé¢ï¼Œå®Œå…¨æ˜¯åå°è‡ªåŠ¨æ‰§è¡Œã€‚</p><h3 id="1-2-4-å®¡æ ¸è§†é¢‘"><a href="#1-2-4-å®¡æ ¸è§†é¢‘" class="headerlink" title="1.2.4 å®¡æ ¸è§†é¢‘"></a>1.2.4 å®¡æ ¸è§†é¢‘</h3><p>å®¡æ ¸åª’èµ„åŒ…æ‹¬ç¨‹åºè‡ªåŠ¨å®¡æ ¸å’Œäººå·¥å®¡æ ¸ï¼Œç¨‹åºå¯ä»¥é€šè¿‡é‰´é»„æ¥å£(<a href="https://www.aliyun.com/product/lvwang?spm=5176.19720258.J_3207526240.51.e93976f4rSq796)å®¡æ ¸è§†é¢‘ï¼Œå¯¹æœ‰å¼‚è®®çš„è§†é¢‘ç”±äººå·¥è¿›è¡Œå®¡æ ¸ã€‚">https://www.aliyun.com/product/lvwang?spm=5176.19720258.J_3207526240.51.e93976f4rSq796)å®¡æ ¸è§†é¢‘ï¼Œå¯¹æœ‰å¼‚è®®çš„è§†é¢‘ç”±äººå·¥è¿›è¡Œå®¡æ ¸ã€‚</a></p><ol><li>è¿è¥ç”¨æˆ·ç™»å…¥è¿è¥å¹³å°å¹¶è¿›å…¥åª’èµ„ç®¡ç†é¡µé¢ï¼ŒæŸ¥æ‰¾å¾…å®¡æ ¸åª’èµ„</li></ol><p><img src="./assets/wps6-1685701049018-12.jpg" alt="img" style="zoom: 67%;" /> </p><ol><li>ç‚¹å‡»åˆ—è¡¨ä¸­åª’èµ„åç§°é“¾æ¥ï¼Œå¯é¢„è§ˆè¯¥åª’èµ„ï¼Œè‹¥æ˜¯è§†é¢‘ï¼Œåˆ™æ’­æ”¾è§†é¢‘ã€‚</li></ol><p><img src="./assets/wps7-1685701049018-11.jpg" alt="img"> </p><ol><li>ç‚¹å‡»åˆ—è¡¨ä¸­æŸåª’èµ„åçš„â€å®¡æ ¸â€ æŒ‰é’®ï¼Œæ—¢å®Œæˆåª’èµ„çš„å®¡æ‰¹è¿‡ç¨‹ã€‚</li></ol><p><img src="./assets/wps8-1685701049018-13.jpg" alt="img"> </p><p> ç‚¹å‡»â€œå®¡æ ¸â€ï¼Œé€‰æ‹©å®¡æ ¸ç»“æœï¼Œè¾“å…¥å®¡æ ¸æ„è§ã€‚</p><p><img src="./assets/wps9-1685701049019-14.jpg" alt="img" style="zoom:33%;" /> </p><h3 id="1-2-5-ç»‘å®šåª’èµ„"><a href="#1-2-5-ç»‘å®šåª’èµ„" class="headerlink" title="1.2.5 ç»‘å®šåª’èµ„"></a>1.2.5 ç»‘å®šåª’èµ„</h3><p>è¯¾ç¨‹è®¡åˆ’åˆ›å»ºå¥½åéœ€è¦ç»‘å®šåª’èµ„æ–‡ä»¶ï¼Œæ¯”å¦‚ï¼šå¦‚æœè¯¾ç¨‹è®¡åˆ’ç»‘å®šäº†è§†é¢‘æ–‡ä»¶ï¼Œè¿›å…¥è¯¾ç¨‹åœ¨çº¿å­¦ä¹ ç•Œé¢åç‚¹è¯¾ç¨‹è®¡åˆ’åç§°åˆ™åœ¨çº¿æ’­æ”¾è§†é¢‘ã€‚å¦‚ä¸‹å›¾ï¼š</p><p><img src="./assets/wps10-1685701108927-23.jpg" alt="img"> </p><p>å¦‚ä½•å°†è¯¾ç¨‹è®¡åˆ’ç»‘å®šåª’èµ„å‘¢ï¼Ÿ</p><ol><li>æ•™è‚²æœºæ„ç”¨æˆ·è¿›å…¥è¯¾ç¨‹ç®¡ç†é¡µé¢å¹¶ç¼–è¾‘æŸä¸€ä¸ªè¯¾ç¨‹ï¼Œåœ¨â€è¯¾ç¨‹å¤§çº²â€æ ‡ç­¾é¡µçš„æŸä¸€å°èŠ‚åå¯ç‚¹å‡»â€æ·»åŠ è§†é¢‘â€œã€‚</li></ol><p><img src="./assets/wps11-1685701108926-19.jpg" alt="img" style="zoom:67%;" /> </p><ol><li>å¼¹å‡ºæ·»åŠ è§†é¢‘å¯¹è¯æ¡†ï¼Œå¯é€šè¿‡è§†é¢‘å…³é”®å­—æœç´¢å·²å®¡æ ¸é€šè¿‡çš„è§†é¢‘åª’èµ„ã€‚</li></ol><p><img src="./assets/wps12-1685701108927-21.jpg" alt="img" style="zoom:67%;" /> </p><ol><li>é€‰æ‹©è§†é¢‘åª’èµ„ï¼Œç‚¹å‡»æäº¤æŒ‰é’®ï¼Œå®Œæˆè¯¾ç¨‹è®¡åˆ’ç»‘å®šåª’èµ„æµç¨‹ã€‚</li></ol><p><img src="./assets/wps13-1685701108927-20.jpg" alt="img" style="zoom:67%;" /> </p><p>è¯¾ç¨‹è®¡åˆ’å…³è”è§†é¢‘åå¦‚ä¸‹å›¾ï¼š</p><p><img src="./assets/wps14-1685701108927-22.jpg" alt="img" style="zoom:67%;" /> </p><h1 id="2-æ­å»ºæ¨¡å—ç¯å¢ƒ"><a href="#2-æ­å»ºæ¨¡å—ç¯å¢ƒ" class="headerlink" title="2. æ­å»ºæ¨¡å—ç¯å¢ƒ"></a>2. æ­å»ºæ¨¡å—ç¯å¢ƒ</h1><h2 id="2-1-æ¶æ„çš„é—®é¢˜åˆ†æ"><a href="#2-1-æ¶æ„çš„é—®é¢˜åˆ†æ" class="headerlink" title="2.1 æ¶æ„çš„é—®é¢˜åˆ†æ"></a>2.1 æ¶æ„çš„é—®é¢˜åˆ†æ</h2><p>å½“å‰è¦å¼€å‘çš„æ˜¯åª’èµ„ç®¡ç†æœåŠ¡ï¼Œç›®å‰ä¸ºæ­¢å…±ä¸‰ä¸ªå¾®æœåŠ¡ï¼šå†…å®¹ç®¡ç†ã€ç³»ç»Ÿç®¡ç†ã€åª’èµ„ç®¡ç†ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="./assets/wps15.jpg" alt="img" style="zoom:67%;" /> </p><p>åæœŸè¿˜ä¼šæ·»åŠ æ›´å¤šçš„å¾®æœåŠ¡ï¼Œå½“å‰è¿™ç§ç”±å‰ç«¯ç›´æ¥è¯·æ±‚å¾®æœåŠ¡çš„æ–¹å¼å­˜åœ¨å¼Šç«¯ï¼š</p><p>å¦‚æœåœ¨å‰ç«¯å¯¹æ¯ä¸ªè¯·æ±‚åœ°å€éƒ½é…ç½®ç»å¯¹è·¯å¾„ï¼Œéå¸¸ä¸åˆ©äºç³»ç»Ÿç»´æŠ¤ï¼Œæ¯”å¦‚ä¸‹è¾¹ä»£ç ä¸­è¯·æ±‚ç³»ç»Ÿç®¡ç†æœåŠ¡çš„åœ°å€ä½¿ç”¨çš„æ˜¯localhost</p><p><img src="./assets/wps16.jpg" alt="img"> </p><p>å½“ç³»ç»Ÿä¸Šçº¿åè¿™é‡Œéœ€è¦æ”¹æˆå…¬ç½‘çš„åŸŸåï¼Œå¦‚æœè¿™ç§åœ°å€éå¸¸å¤šåˆ™éå¸¸éº»çƒ¦ã€‚</p><p>åŸºäºè¿™ä¸ªé—®é¢˜å¯ä»¥é‡‡ç”¨ç½‘å…³æ¥è§£å†³ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="./assets/wps17.jpg" alt="img" style="zoom:67%;" /> </p><p>è¿™æ ·åœ¨å‰ç«¯çš„ä»£ç ä¸­åªéœ€è¦æŒ‡å®šæ¯ä¸ªæ¥å£çš„ç›¸å¯¹è·¯å¾„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="./assets/wps18.jpg" alt="img"> </p><p>åœ¨å‰ç«¯ä»£ç çš„ä¸€ä¸ªå›ºå®šçš„åœ°æ–¹åœ¨æ¥å£åœ°å€å‰ç»Ÿä¸€åŠ ç½‘å…³çš„åœ°å€ï¼Œæ¯ä¸ªè¯·æ±‚ç»Ÿä¸€åˆ°ç½‘å…³ï¼Œç”±ç½‘å…³å°†è¯·æ±‚è½¬å‘åˆ°å…·ä½“çš„å¾®æœåŠ¡ã€‚</p><p>ä¸ºä»€ä¹ˆæ‰€æœ‰çš„è¯·æ±‚å…ˆåˆ°ç½‘å…³å‘¢ï¼Ÿ</p><p>æœ‰äº†ç½‘å…³å°±å¯ä»¥å¯¹è¯·æ±‚è¿›è¡Œè·¯ç”±ï¼Œè·¯ç”±åˆ°å…·ä½“çš„å¾®æœåŠ¡ï¼Œå‡å°‘å¤–ç•Œå¯¹æ¥å¾®æœåŠ¡çš„æˆæœ¬ï¼Œæ¯”å¦‚ï¼š400ç”µè¯ï¼Œè·¯ç”±çš„è¯•å¯ä»¥æ ¹æ®è¯·æ±‚è·¯å¾„è¿›è¡Œè·¯ç”±ã€æ ¹æ®hoståœ°å€è¿›è¡Œè·¯ç”±ç­‰ï¼Œ å½“å¾®æœåŠ¡æœ‰å¤šä¸ªå®ä¾‹æ—¶å¯ä»¥é€šè¿‡è´Ÿè½½å‡è¡¡ç®—æ³•è¿›è¡Œè·¯ç”±ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="./assets/wps19.jpg" alt="img" style="zoom: 67%;" /> </p><p>å¦å¤–ï¼Œç½‘å…³è¿˜å¯ä»¥å®ç°æƒé™æ§åˆ¶ã€é™æµç­‰åŠŸèƒ½ã€‚</p><p>é¡¹ç›®é‡‡ç”¨Spring Cloud Gatewayä½œä¸ºç½‘å…³ï¼Œç½‘å…³åœ¨è¯·æ±‚è·¯ç”±æ—¶éœ€è¦çŸ¥é“æ¯ä¸ªå¾®æœåŠ¡å®ä¾‹çš„åœ°å€ï¼Œé¡¹ç›®ä½¿ç”¨Nacosä½œç”¨æœåŠ¡å‘ç°ä¸­å¿ƒå’Œé…ç½®ä¸­å¿ƒï¼Œæ•´ä½“çš„æ¶æ„å›¾å¦‚ä¸‹ï¼š</p><p><img src="./assets/wps20.jpg" alt="img"> </p><p>æµç¨‹å¦‚ä¸‹ï¼š</p><ol><li><p>å¾®æœåŠ¡å¯åŠ¨ï¼Œå°†è‡ªå·±æ³¨å†Œåˆ°Nacosï¼ŒNacosè®°å½•äº†å„å¾®æœåŠ¡å®ä¾‹çš„åœ°å€ã€‚</p></li><li><p>ç½‘å…³ä»Nacosè¯»å–æœåŠ¡åˆ—è¡¨ï¼ŒåŒ…æ‹¬æœåŠ¡åç§°ã€æœåŠ¡åœ°å€ç­‰ã€‚</p></li><li><p>è¯·æ±‚åˆ°è¾¾ç½‘å…³ï¼Œç½‘å…³å°†è¯·æ±‚è·¯ç”±åˆ°å…·ä½“çš„å¾®æœåŠ¡ã€‚</p></li></ol><p>è¦ä½¿ç”¨ç½‘å…³é¦–å…ˆæ­å»ºNacosï¼ŒNacosæœ‰ä¸¤ä¸ªä½œç”¨ï¼š</p><ol><li><p>æœåŠ¡å‘ç°ä¸­å¿ƒã€‚</p><ul><li>å¾®æœåŠ¡å°†è‡ªèº«æ³¨å†Œè‡³Nacosï¼Œç½‘å…³ä»Nacosè·å–å¾®æœåŠ¡åˆ—è¡¨ã€‚</li></ul></li><li><p>é…ç½®ä¸­å¿ƒã€‚</p><ul><li>å¾®æœåŠ¡ä¼—å¤šï¼Œå®ƒä»¬çš„é…ç½®ä¿¡æ¯ä¹Ÿéå¸¸å¤æ‚ï¼Œä¸ºäº†æä¾›ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§ï¼Œå¾®æœåŠ¡çš„é…ç½®ä¿¡æ¯ç»Ÿä¸€åœ¨Nacosé…ç½®ã€‚</li></ul></li></ol><h2 id="2-2-æ­å»º-Nacos"><a href="#2-2-æ­å»º-Nacos" class="headerlink" title="2.2 æ­å»º Nacos"></a>2.2 æ­å»º Nacos</h2><h3 id="2-2-1-æœåŠ¡å‘ç°ä¸­å¿ƒ"><a href="#2-2-1-æœåŠ¡å‘ç°ä¸­å¿ƒ" class="headerlink" title="2.2.1 æœåŠ¡å‘ç°ä¸­å¿ƒ"></a>2.2.1 æœåŠ¡å‘ç°ä¸­å¿ƒ</h3><p>Spring Cloud ï¼šä¸€å¥—è§„èŒƒ</p><ul><li>Spring Cloud alibaba: nacosæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œé…ç½®ä¸­å¿ƒ</li></ul><p>æ ¹æ®ä¸ŠèŠ‚è®²è§£çš„ç½‘å…³çš„æ¶æ„å›¾ï¼Œè¦ä½¿ç”¨ç½‘å…³é¦–å…ˆæ­å»ºNacosã€‚</p><ol><li><p>é¦–å…ˆæ­å»ºNacosæœåŠ¡å‘ç°ä¸­å¿ƒã€‚</p><ul><li><p>åœ¨æ­å»ºNacosæœåŠ¡å‘ç°ä¸­å¿ƒä¹‹å‰éœ€è¦ææ¸…æ¥šä¸¤ä¸ªæ¦‚å¿µï¼šnamespaceå’Œgroup</p></li><li><p>namespaceï¼šç”¨äºåŒºåˆ†ç¯å¢ƒã€æ¯”å¦‚ï¼šå¼€å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒã€ç”Ÿäº§ç¯å¢ƒã€‚</p></li><li><p>groupï¼šç”¨äºåŒºåˆ†é¡¹ç›®ï¼Œæ¯”å¦‚ï¼šxuecheng-plusé¡¹ç›®ã€xuecheng2.0é¡¹ç›®</p></li></ul></li><li><p>é¦–å…ˆåœ¨nacosé…ç½®namespace:</p><ul><li><p>ç™»å½•Centosï¼Œå¯åŠ¨Naocsï¼Œä½¿ç”¨sh /data/soft/restart.shå°†è‡ªåŠ¨å¯åŠ¨Nacosã€‚</p></li><li><p>è®¿é—®ï¼š<a href="http://192.168.101.65:8848/nacos/">http://192.168.101.65:8848/nacos/</a></p></li><li>è´¦å·å¯†ç ï¼šnacos/nacos</li></ul></li><li><p>ç™»å½•æˆåŠŸï¼Œç‚¹å‡»å·¦ä¾§èœå•â€œå‘½åç©ºé—´â€è¿›å…¥å‘½åç©ºé—´ç®¡ç†ç•Œé¢ï¼Œ</p></li></ol><p>é¦–å…ˆå®Œæˆå„æœåŠ¡æ³¨å†Œåˆ°Naocsï¼Œä¸‹è¾¹å°†å†…å®¹ç®¡ç†æœåŠ¡æ³¨å†Œåˆ°nacosä¸­ã€‚</p><p>1) åœ¨xuecheng-plus-parentä¸­æ·»åŠ ä¾èµ–ç®¡ç† </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-alibaba-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-cloud-alibaba.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ol><li>åœ¨å†…å®¹ç®¡ç†æ¨¡å—çš„æ¥å£å·¥ç¨‹ã€ç³»ç»Ÿç®¡ç†æ¨¡å—çš„æ¥å£å·¥ç¨‹ä¸­æ·»åŠ å¦‚ä¸‹ä¾èµ–</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ol><li>é…ç½®nacosçš„åœ°å€</li></ol><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å¾®æœåŠ¡é…ç½®</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">system-service</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">server-addr:</span> <span class="number">192.168</span><span class="number">.101</span><span class="number">.65</span><span class="string">:8848</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line">        <span class="attr">group:</span> <span class="string">xuecheng-plus-project</span></span><br></pre></td></tr></table></figure><p>åœ¨å†…å®¹ç®¡ç†çš„æ¥å£å·¥ç¨‹çš„é…ç½®æ–‡ä»¶ä¸­é…ç½®å¦‚ä¸‹ä¿¡æ¯ï¼š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">content-api</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">server-addr:</span> <span class="number">192.168</span><span class="number">.101</span><span class="number">.65</span><span class="string">:8848</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line">        <span class="attr">group:</span> <span class="string">xuecheng-plus-project</span></span><br></pre></td></tr></table></figure><ol><li>é‡å¯å†…å®¹ç®¡ç†æœåŠ¡ã€ç³»ç»Ÿç®¡ç†æœåŠ¡ã€‚</li></ol><p>å¾…å¾®æœåŠ¡å¯åŠ¨æˆåŠŸï¼Œè¿›å…¥NacosæœåŠ¡æŸ¥çœ‹æœåŠ¡åˆ—è¡¨</p><p><img src="./assets/image-20230602195622335.png" alt="image-20230602195622335"></p><p>åœ¨ â€œå¼€å‘ç¯å¢ƒâ€ å‘½åç©ºé—´ä¸‹æœ‰ä¸¤ä¸ªæœåŠ¡è¿™è¯´æ˜å†…å®¹ç®¡ç†å¾®æœåŠ¡å’Œç³»ç»Ÿç®¡ç†å¾®æœåŠ¡åœ¨Nacosæ³¨å†ŒæˆåŠŸã€‚</p><p>ç‚¹å‡»å…¶å®ƒä¸€ä¸ªå¾®æœåŠ¡çš„â€œè¯¦æƒ…â€</p><h3 id="2-2-2-é…ç½®ä¸­å¿ƒ"><a href="#2-2-2-é…ç½®ä¸­å¿ƒ" class="headerlink" title="2.2.2 é…ç½®ä¸­å¿ƒ"></a>2.2.2 é…ç½®ä¸­å¿ƒ</h3><h4 id="2-2-2-1-é…ç½®ä¸‰è¦ç´ "><a href="#2-2-2-1-é…ç½®ä¸‰è¦ç´ " class="headerlink" title="2.2.2.1 é…ç½®ä¸‰è¦ç´ "></a>2.2.2.1 é…ç½®ä¸‰è¦ç´ </h4><p>æ­å»ºå®ŒæˆNacosæœåŠ¡å‘ç°ä¸­å¿ƒï¼Œä¸‹è¾¹æ­å»ºNacosä¸ºé…ç½®ä¸­å¿ƒï¼Œå…¶ç›®çš„å°±æ˜¯é€šè¿‡Nacoså»ç®¡ç†é¡¹ç›®çš„æ‰€æœ‰é…ç½®ã€‚</p><p>1ï¸âƒ£å…ˆå°†é¡¹ç›®ä¸­çš„é…ç½®æ–‡ä»¶åˆ†åˆ†ç±»ï¼š</p><ol><li><p>æ¯ä¸ªé¡¹ç›®ç‰¹æœ‰çš„é…ç½®</p><ul><li><p>æ˜¯æŒ‡è¯¥é…ç½®åªåœ¨æœ‰äº›é¡¹ç›®ä¸­éœ€è¦é…ç½®ï¼Œæˆ–è€…è¯¥é…ç½®åœ¨æ¯ä¸ªé¡¹ç›®ä¸­é…ç½®çš„å€¼ä¸åŒã€‚</p></li><li><p>æ¯”å¦‚ï¼šspring.application.nameæ¯ä¸ªé¡¹ç›®éƒ½éœ€è¦é…ç½®ä½†å€¼ä¸ä¸€æ ·ï¼Œä»¥åŠæœ‰äº›é¡¹ç›®éœ€è¦è¿æ¥æ•°æ®åº“è€Œæœ‰äº›é¡¹ç›®ä¸éœ€è¦ï¼Œæœ‰äº›é¡¹ç›®éœ€è¦é…ç½®æ¶ˆæ¯é˜Ÿåˆ—è€Œæœ‰äº›é¡¹ç›®ä¸éœ€è¦ã€‚</p></li></ul></li><li><p>é¡¹ç›®æ‰€å…¬ç”¨çš„é…ç½®</p><ul><li><p>æ˜¯æŒ‡åœ¨è‹¥å¹²é¡¹ç›®ä¸­é…ç½®å†…å®¹ç›¸åŒçš„é…ç½®ã€‚æ¯”å¦‚ï¼šredisçš„é…ç½®ï¼Œå¾ˆå¤šé¡¹ç›®ç”¨çš„åŒä¸€å¥—redisæœåŠ¡æ‰€ä»¥é…ç½®ä¹Ÿä¸€æ ·ã€‚</p></li><li><p>å¦å¤–è¿˜éœ€è¦çŸ¥é“nacoså¦‚ä½•å»å®šä½ä¸€ä¸ªå…·ä½“çš„é…ç½®æ–‡ä»¶ï¼Œå³ï¼šnamespaceã€groupã€dataid. </p></li></ul><ol><li><p>é€šè¿‡namespaceã€groupæ‰¾åˆ°å…·ä½“çš„ç¯å¢ƒå’Œå…·ä½“çš„é¡¹ç›®ã€‚</p></li><li><p>é€šè¿‡dataidæ‰¾åˆ°å…·ä½“çš„é…ç½®æ–‡ä»¶ï¼Œdataidæœ‰ä¸‰éƒ¨åˆ†ç»„æˆ</p><ul><li><p>æ¯”å¦‚ï¼šcontent-service-dev.yamlé…ç½®æ–‡ä»¶  ç”±ï¼ˆcontent-serviceï¼‰-ï¼ˆdevï¼‰. (yaml)ä¸‰éƒ¨åˆ†ç»„æˆ</p></li><li><p>content-serviceï¼šç¬¬ä¸€éƒ¨åˆ†ï¼Œå®ƒæ˜¯åœ¨application.yamlä¸­é…ç½®çš„åº”ç”¨åï¼Œå³spring.application.nameçš„å€¼ã€‚</p></li><li><p>devï¼šç¬¬äºŒéƒ¨åˆ†ï¼Œå®ƒæ˜¯ç¯å¢ƒåï¼Œé€šè¿‡spring.profiles.activeæŒ‡å®šï¼Œ</p></li><li>Yaml: ç¬¬ä¸‰éƒ¨åˆ†ï¼Œå®ƒæ˜¯é…ç½®æ–‡ä»¶ çš„åç¼€ï¼Œç›®å‰nacosæ”¯æŒpropertiesã€yamlç­‰æ ¼å¼ç±»å‹ï¼Œæœ¬é¡¹ç›®é€‰æ‹©yamlæ ¼å¼ç±»å‹ã€‚</li></ul></li></ol></li></ol><p>2ï¸âƒ£æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬è¦é…ç½®content-serviceå·¥ç¨‹çš„é…ç½®æ–‡ä»¶:</p><ul><li>åœ¨å¼€å‘ç¯å¢ƒä¸­é…ç½®content-service-dev.yaml</li><li>åœ¨æµ‹è¯•ç¯å¢ƒä¸­é…ç½®content-service-test.yaml</li><li>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­é…ç½®content-service-prod.yaml</li></ul><p>æˆ‘ä»¬å¯åŠ¨é¡¹ç›®ä¸­ä¼ å…¥spring.profiles.activeçš„å‚æ•°å†³å®šå¼•ç”¨å“ªä¸ªç¯å¢ƒçš„é…ç½®æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼šä¼ å…¥spring.profiles.active=devè¡¨ç¤ºä½¿ç”¨devç¯å¢ƒçš„é…ç½®æ–‡ä»¶å³content-service-dev.yamlã€‚</p><h4 id="2-2-2-2-é…ç½®-content-service"><a href="#2-2-2-2-é…ç½®-content-service" class="headerlink" title="2.2.2.2 é…ç½® content-service"></a>2.2.2.2 é…ç½® content-service</h4><p>1ï¸âƒ£ä¸‹è¾¹ä»¥å¼€å‘ç¯å¢ƒä¸ºä¾‹å¯¹content-serviceå·¥ç¨‹çš„é…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®ï¼Œè¿›å…¥nacosï¼Œè¿›å…¥å¼€å‘ç¯å¢ƒã€‚</p><ul><li>ç‚¹å‡»åŠ å·ï¼Œæ·»åŠ ä¸€ä¸ªé…ç½®</li><li>è¾“å…¥data idã€groupä»¥åŠé…ç½®æ–‡ä»¶å†…å®¹ã€‚</li></ul><p><img src="./assets/image-20230602200138421.png" alt="image-20230602200138421"></p><p>2ï¸âƒ£ä¸ºä»€ä¹ˆæ²¡åœ¨nacosä¸­é…ç½®ä¸‹è¾¹çš„å†…å®¹ ï¼Ÿ</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">content-service</span></span><br></pre></td></tr></table></figure><ul><li>å› ä¸ºåˆšæ‰è¯´äº†dataidç¬¬ä¸€éƒ¨åˆ†å°±æ˜¯spring.application.nameï¼Œnacos å®¢æˆ·ç«¯è¦æ ¹æ®æ­¤å€¼ç¡®å®šé…ç½®æ–‡ä»¶ åç§°ï¼Œ</li><li>æ‰€ä»¥spring.application.nameä¸åœ¨nacosä¸­é…ç½®ï¼Œè€Œæ˜¯è¦åœ¨å·¥ç¨‹çš„æœ¬åœ°è¿›è¡Œé…ç½®ã€‚</li></ul><p>3ï¸âƒ£åœ¨content-serviceå·¥ç¨‹çš„test/resources ä¸­æ·»åŠ bootstrap.yamlï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">content-service</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">server-addr:</span> <span class="number">192.168</span><span class="number">.101</span><span class="number">.65</span><span class="string">:8848</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">namespace:</span> <span class="string">ty_xc_dev</span></span><br><span class="line">        <span class="attr">group:</span> <span class="string">xuecheng-plus-project</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="attr">namespace:</span> <span class="string">ty_xc_dev</span></span><br><span class="line">        <span class="attr">group:</span> <span class="string">xuecheng-plus-project</span></span><br><span class="line">        <span class="attr">file-extension:</span> <span class="string">yaml</span></span><br><span class="line">        <span class="attr">refresh-enabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#profilesé»˜è®¤ä¸ºdev</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span></span><br></pre></td></tr></table></figure><p>4ï¸âƒ£åœ¨å†…å®¹ç®¡ç†æ¨¡å—çš„æ¥å£å·¥ç¨‹å’Œserviceå·¥ç¨‹é…ç½®ä¾èµ–ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-config<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>é…ç½®å®Œæˆï¼Œè¿è¡Œcontent-serviceå·¥ç¨‹ çš„å•å…ƒæµ‹è¯•æ–‡ä»¶ï¼Œèƒ½å¦æ­£å¸¸æµ‹è¯•ï¼Œè·Ÿè¸ªå•å…ƒæµ‹è¯•æ–¹æ³•å¯ä»¥æ­£å¸¸è¯»å–æ•°æ®åº“çš„æ•°æ®ï¼Œè¯´æ˜ä»nacosè¯»å–é…ç½®ä¿¡æ¯æ­£å¸¸ã€‚</p><p>é€šè¿‡è¿è¡Œè§‚å¯Ÿæ§åˆ¶å°æ‰“å°å‡ºä¸‹è¾¹çš„ä¿¡æ¯ï¼ŒNacosRestTemplate.javaé€šè¿‡Postæ–¹å¼ä¸nacosæœåŠ¡ç«¯äº¤äº’è¯»å–é…ç½®ä¿¡æ¯ã€‚</p><h4 id="2-2-2-3-é…ç½®-content-api"><a href="#2-2-2-3-é…ç½®-content-api" class="headerlink" title="2.2.2.3 é…ç½® content-api"></a>2.2.2.3 é…ç½® content-api</h4><p>ä»¥ç›¸åŒçš„æ–¹æ³•é…ç½®content-apiå·¥ç¨‹çš„é…ç½®æ–‡ä»¶ï¼Œåœ¨nacosä¸­çš„å¼€å‘ç¯å¢ƒä¸­é…ç½®content-api-dev.yamlï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">servlet:</span></span><br><span class="line">    <span class="attr">context-path:</span> <span class="string">/content</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">63040</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ—¥å¿—æ–‡ä»¶é…ç½®è·¯å¾„</span></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">config:</span> <span class="string">classpath:log4j2-dev.xml</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># swagger æ–‡æ¡£é…ç½®</span></span><br><span class="line"><span class="attr">swagger:</span></span><br><span class="line">  <span class="attr">title:</span> <span class="string">&quot;å­¦æˆåœ¨çº¿å†…å®¹ç®¡ç†ç³»ç»Ÿ&quot;</span></span><br><span class="line">  <span class="attr">description:</span> <span class="string">&quot;å†…å®¹ç³»ç»Ÿç®¡ç†ç³»ç»Ÿå¯¹è¯¾ç¨‹ç›¸å…³ä¿¡æ¯è¿›è¡Œä¸šåŠ¡ç®¡ç†æ•°æ®&quot;</span></span><br><span class="line">  <span class="attr">base-package:</span> <span class="string">com.xuecheng.content</span></span><br><span class="line">  <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">version:</span> <span class="number">1.0</span><span class="number">.0</span></span><br></pre></td></tr></table></figure><p>åœ¨content-apiå·¥ç¨‹ çš„æœ¬åœ°é…ç½®bootstrap.yamlï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å¾®æœåŠ¡é…ç½®</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">content-api</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">server-addr:</span> <span class="number">192.168</span><span class="number">.101</span><span class="number">.65</span><span class="string">:8848</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">namespace:</span> <span class="string">ty_xc_dev</span></span><br><span class="line">        <span class="attr">group:</span> <span class="string">xuecheng-plus-project</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="attr">namespace:</span> <span class="string">ty_xc_dev</span></span><br><span class="line">        <span class="attr">group:</span> <span class="string">xuecheng-plus-project</span></span><br><span class="line">        <span class="attr">file-extension:</span> <span class="string">yaml</span></span><br><span class="line">        <span class="attr">refresh-enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">extension-configs:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">data-id:</span> <span class="string">content-service-$&#123;spring.profiles.active&#125;.yaml</span></span><br><span class="line">            <span class="attr">group:</span> <span class="string">xuecheng-plus-project</span></span><br><span class="line">            <span class="attr">refresh:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span></span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šå› ä¸ºapiæ¥å£å·¥ç¨‹ä¾èµ–äº†serviceå·¥ç¨‹ çš„jarï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨extension-configsæ‰©å±•é…ç½®æ–‡ä»¶ çš„æ–¹å¼å¼•ç”¨serviceå·¥ç¨‹æ‰€ç”¨åˆ°çš„é…ç½®æ–‡ä»¶ã€‚</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">extension-configs:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">data-id:</span> <span class="string">content-service-$&#123;spring.profiles.active&#125;.yaml</span></span><br><span class="line">    <span class="attr">group:</span> <span class="string">xuecheng-plus-project</span></span><br><span class="line">    <span class="attr">refresh:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>å¦‚æœæ·»åŠ å¤šä¸ªæ‰©å±•æ–‡ä»¶ï¼Œç»§ç»­åœ¨ä¸‹æ·»åŠ å³å¯ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">extension-configs:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">data-id:</span> <span class="string">content-service-$&#123;spring.profiles.active&#125;.yaml</span></span><br><span class="line">    <span class="attr">group:</span> <span class="string">xuecheng-plus-project</span></span><br><span class="line">    <span class="attr">refresh:</span> <span class="literal">true</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">data-id:</span> <span class="string">å¡«å†™æ–‡ä»¶</span> <span class="string">dataid</span></span><br><span class="line">    <span class="attr">group:</span> <span class="string">xuecheng-plus-project</span></span><br><span class="line">    <span class="attr">refresh:</span> <span class="literal">true</span>           </span><br></pre></td></tr></table></figure></blockquote><p>å¯åŠ¨content-apiå·¥ç¨‹ï¼ŒæŸ¥è¯¢æ§åˆ¶å°æ˜¯å¦æ‰“å°å‡ºäº†è¯·æ±‚nacosçš„æ—¥å¿—ï¼Œå¦‚ä¸‹:</p><p>å¹¶ä½¿ç”¨Httpclientæµ‹è¯•è¯¾ç¨‹æŸ¥è¯¢æ¥å£æ˜¯å¦å¯ä»¥æ­£å¸¸æŸ¥è¯¢ã€‚</p><h3 id="2-2-3-å…¬ç”¨é…ç½®"><a href="#2-2-3-å…¬ç”¨é…ç½®" class="headerlink" title="2.2.3 å…¬ç”¨é…ç½®"></a>2.2.3 å…¬ç”¨é…ç½®</h3><p>1ï¸âƒ£è¿˜æœ‰ä¸€ä¸ªä¼˜åŒ–çš„ç‚¹æ˜¯å¦‚ä½•åœ¨nacosä¸­é…ç½®é¡¹ç›®çš„å…¬ç”¨é…ç½®å‘¢ï¼Ÿ</p><ul><li><p>nacosæä¾›äº†shared-configså¯ä»¥å¼•å…¥å…¬ç”¨é…ç½®ã€‚</p></li><li><p>åœ¨content-apiä¸­é…ç½®äº†swaggerï¼Œæ‰€æœ‰çš„æ¥å£å·¥ç¨‹ éƒ½éœ€è¦é…ç½®swaggerï¼Œ</p></li><li>è¿™é‡Œå°±å¯ä»¥å°†swaggerçš„é…ç½®å®šä¹‰ä¸ºä¸€ä¸ªå…¬ç”¨é…ç½®ï¼Œå“ªä¸ªé¡¹ç›®ç”¨å¼•å…¥å³å¯ã€‚</li></ul><p>2ï¸âƒ£å•ç‹¬åœ¨xuecheng-plus-commonåˆ†ç»„ä¸‹åˆ›å»ºxuecheng-plusçš„å…¬ç”¨é…ç½®ï¼Œ</p><ul><li><p>è¿›å…¥nacosçš„å¼€å‘ç¯å¢ƒï¼Œæ·»åŠ swagger-dev.yamlå…¬ç”¨é…ç½®</p></li><li><p>å†ä»¥ç›¸åŒ çš„æ–¹æ³•é…ç½®æ—¥å¿—çš„å…¬ç”¨é…ç½®ã€‚</p></li></ul><p><img src="./assets/image-20230602200917855.png" alt="image-20230602200917855"></p><p>3ï¸âƒ£åˆ é™¤æ¥å£å·¥ç¨‹ä¸­å¯¹swaggerçš„é…ç½®ã€‚</p><ul><li>é¡¹ç›®ä½¿ç”¨shared-configså¯ä»¥å¼•å…¥å…¬ç”¨é…ç½®ã€‚åœ¨æ¥å£å·¥ç¨‹çš„æœ¬åœ°é…ç½®æ–‡ä»¶ ä¸­å¼•å…¥å…¬ç”¨é…ç½®ï¼Œå¦‚ä¸‹ï¼š</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">content-api</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">server-addr:</span> <span class="number">192.168</span><span class="number">.101</span><span class="number">.65</span><span class="string">:8848</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">namespace:</span> <span class="string">ty_xc_dev</span></span><br><span class="line">        <span class="attr">group:</span> <span class="string">xuecheng-plus-project</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="attr">namespace:</span> <span class="string">ty_xc_dev</span></span><br><span class="line">        <span class="attr">group:</span> <span class="string">xuecheng-plus-project</span></span><br><span class="line">        <span class="attr">file-extension:</span> <span class="string">yaml</span></span><br><span class="line">        <span class="attr">refresh-enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">extension-configs:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">data-id:</span> <span class="string">content-service-$&#123;spring.profiles.active&#125;.yaml</span></span><br><span class="line">            <span class="attr">group:</span> <span class="string">xuecheng-plus-project</span></span><br><span class="line">            <span class="attr">refresh:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">shared-configs:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">data-id:</span> <span class="string">swagger-$&#123;spring.profiles.active&#125;.yaml</span></span><br><span class="line">            <span class="attr">group:</span> <span class="string">xuecheng-plus-common</span></span><br><span class="line">            <span class="attr">refresh:</span> <span class="literal">true</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">data-id:</span> <span class="string">logging-$&#123;spring.profiles.active&#125;.yaml</span></span><br><span class="line">            <span class="attr">group:</span> <span class="string">xuecheng-plus-common</span></span><br><span class="line">            <span class="attr">refresh:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span></span><br></pre></td></tr></table></figure><p>4ï¸âƒ£é…ç½®å®Œæˆï¼Œé‡å¯content-apiæ¥å£å·¥ç¨‹ï¼Œè®¿é—®<a href="http://localhost:63040/content/swagger-ui.html">http://localhost:63040/content/swagger-ui.html</a> æŸ¥çœ‹swaggeræ¥å£æ–‡æ¡£æ˜¯å¦å¯ä»¥æ­£å¸¸è®¿é—®ï¼ŒæŸ¥çœ‹æ§åˆ¶å°log4j2æ—¥å¿—è¾“å‡ºæ˜¯å¦æ­£å¸¸ã€‚</p><h3 id="2-2-4-é…ç½®ä¼˜å…ˆçº§"><a href="#2-2-4-é…ç½®ä¼˜å…ˆçº§" class="headerlink" title="2.2.4 é…ç½®ä¼˜å…ˆçº§"></a>2.2.4 é…ç½®ä¼˜å…ˆçº§</h3><p>1ï¸âƒ£åˆ°ç›®å‰ä¸ºæ­¢å·²å°†æ‰€æœ‰å¾®æœåŠ¡çš„é…ç½®ç»Ÿä¸€åœ¨nacosè¿›è¡Œé…ç½®ï¼Œç”¨åˆ°çš„é…ç½®æ–‡ä»¶æœ‰æœ¬åœ°çš„é…ç½®æ–‡ä»¶ bootstrap.yamlå’Œnacosä¸Šçš„é…ç½®æ–‡ä»¶ï¼ŒSpringBootè¯»å–é…ç½®æ–‡ä»¶ çš„é¡ºåºå¦‚ä¸‹ï¼š</p><p><img src="./assets/wps21.jpg" alt="img"> </p><p>å¼•å…¥é…ç½®æ–‡ä»¶çš„å½¢å¼æœ‰ï¼š</p><ol><li><p>ä»¥é¡¹ç›®åº”ç”¨åæ–¹å¼å¼•å…¥</p></li><li><p>ä»¥æ‰©å±•é…ç½®æ–‡ä»¶æ–¹å¼å¼•å…¥</p></li><li><p>ä»¥å…±äº«é…ç½®æ–‡ä»¶ æ–¹å¼å¼•å…¥</p></li><li><p>æœ¬åœ°é…ç½®æ–‡ä»¶</p></li></ol><p>å„é…ç½®æ–‡ä»¶çš„==ä¼˜å…ˆçº§==ï¼šé¡¹ç›®åº”ç”¨åé…ç½®æ–‡ä»¶ &gt; æ‰©å±•é…ç½®æ–‡ä»¶  &gt; å…±äº«é…ç½®æ–‡ä»¶ &gt; æœ¬åœ°é…ç½®æ–‡ä»¶ã€‚</p><p>2ï¸âƒ£æœ‰æ—¶å€™æˆ‘ä»¬åœ¨æµ‹è¯•ç¨‹åºæ—¶ç›´æ¥åœ¨æœ¬åœ°åŠ ä¸€ä¸ªé…ç½®è¿›è¡Œæµ‹è¯•ï¼Œæ¯”å¦‚ä¸‹è¾¹çš„ä¾‹å­ï¼š</p><ul><li>æˆ‘ä»¬æƒ³å¯åŠ¨ä¸¤ä¸ªå†…å®¹ç®¡ç†å¾®æœåŠ¡ï¼Œæ­¤æ—¶éœ€è¦åœ¨æœ¬åœ°æŒ‡å®šä¸åŒçš„ç«¯å£ï¼Œé€šè¿‡VM Optionså‚æ•°ï¼Œåœ¨IDEAé…ç½®å¯åŠ¨å‚æ•°</li></ul><p><img src="./assets/wps22.jpg" alt="img" style="zoom:50%;" /> </p><p>é€šè¿‡-DæŒ‡å®šå‚æ•°åå’Œå‚æ•°å€¼ï¼Œå‚æ•°åå³åœ¨bootstrap.ymlä¸­é…ç½®çš„server.portã€‚</p><p><img src="./assets/wps23.jpg" alt="img"> </p><ul><li>å¯åŠ¨ContentApplication2ï¼Œå‘ç°ç«¯å£ä»ç„¶æ˜¯63040ï¼Œè¿™è¯´æ˜æœ¬åœ°çš„é…ç½®æ²¡æœ‰ç”Ÿæ•ˆã€‚</li></ul><p>3ï¸âƒ£è¿™æ—¶æˆ‘ä»¬æƒ³è®©æœ¬åœ°æœ€ä¼˜å…ˆï¼Œå¯ä»¥åœ¨nacosé…ç½®æ–‡ä»¶ ä¸­é…ç½®å¦‚ä¸‹å³å¯å®ç°ï¼š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é…ç½®æœ¬åœ°ä¼˜å…ˆ</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"> <span class="attr">cloud:</span></span><br><span class="line">  <span class="attr">config:</span></span><br><span class="line">    <span class="attr">override-none:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>4ï¸âƒ£å†æ¬¡å¯åŠ¨ContentApplication2ï¼Œç«¯å£ä¸º63041ã€‚</p><h3 id="2-2-5-å¯¼å…¥é…ç½®æ–‡ä»¶"><a href="#2-2-5-å¯¼å…¥é…ç½®æ–‡ä»¶" class="headerlink" title="2.2.5 å¯¼å…¥é…ç½®æ–‡ä»¶"></a>2.2.5 å¯¼å…¥é…ç½®æ–‡ä»¶</h3><p>è¯¾ç¨‹èµ„æ–™ä¸­æä¾›äº†ç³»ç»Ÿç”¨çš„æ‰€æœ‰é…ç½®æ–‡ä»¶nacos_config_export.zipï¼Œä¸‹è¾¹å°†nacos_config_export.zipå¯¼å…¥nacosã€‚</p><p>è¿›å…¥å…·ä½“çš„å‘½åç©ºé—´ï¼Œç‚¹å‡»â€œå¯¼å…¥é…ç½®â€</p><h2 id="2-3-æ­å»º-Gateway"><a href="#2-3-æ­å»º-Gateway" class="headerlink" title="2.3 æ­å»º Gateway"></a>2.3 æ­å»º Gateway</h2><p>æœ¬é¡¹ç›®ä½¿ç”¨Spring Cloud Gatewayä½œä¸ºç½‘å…³ï¼Œä¸‹è¾¹åˆ›å»ºç½‘å…³å·¥ç¨‹ã€‚</p><p>1ï¸âƒ£æ–°å»ºä¸€ä¸ªç½‘å…³å·¥ç¨‹ã€‚</p><p><img src="./assets/image-20230604202626045.png" alt="image-20230604202626045" style="zoom:50%;" /></p><p>2ï¸âƒ£ä¿®æ”¹pom.xmlï¼Œæ·»åŠ ç›¸å…³ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xuecheng<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xuecheng-plus-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>&gt;</span>../xuecheng-plus-parent<span class="tag">&lt;/<span class="name">relativePath</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xuecheng-plus-gateway<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>xuecheng-plus-gateway<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>xuecheng-plus-gateway<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--ç½‘å…³--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-gateway<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--æœåŠ¡å‘ç°ä¸­å¿ƒ--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-config<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æ’é™¤ Spring Boot ä¾èµ–çš„æ—¥å¿—åŒ…å†²çª --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Spring Boot é›†æˆ log4j2 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-log4j2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><p>3ï¸âƒ£é…ç½®ç½‘å…³çš„bootstrap.yamlé…ç½®æ–‡ä»¶</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å¾®æœåŠ¡é…ç½®</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">gateway</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">server-addr:</span> <span class="number">192.168</span><span class="number">.101</span><span class="number">.65</span><span class="string">:8848</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">namespace:</span> <span class="string">ty_xc_dev</span></span><br><span class="line">        <span class="attr">group:</span> <span class="string">xuecheng-plus-project</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="attr">namespace:</span> <span class="string">ty_xc_dev</span></span><br><span class="line">        <span class="attr">group:</span> <span class="string">xuecheng-plus-project</span></span><br><span class="line">        <span class="attr">file-extension:</span> <span class="string">yaml</span></span><br><span class="line">        <span class="attr">refresh-enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">shared-configs:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">data-id:</span> <span class="string">logging-$&#123;spring.profiles.active&#125;.yaml</span></span><br><span class="line">            <span class="attr">group:</span> <span class="string">xuecheng-plus-common</span></span><br><span class="line">            <span class="attr">refresh:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span></span><br></pre></td></tr></table></figure><p>4ï¸âƒ£åœ¨nacosä¸Šé…ç½®ç½‘å…³è·¯ç”±ç­–ç•¥ï¼š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">63010</span> <span class="comment"># ç½‘å…³ç«¯å£</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line"><span class="comment">#      filter:</span></span><br><span class="line"><span class="comment">#        strip-prefix:</span></span><br><span class="line"><span class="comment">#          enabled: true</span></span><br><span class="line">      <span class="attr">routes:</span> <span class="comment"># ç½‘å…³è·¯ç”±é…ç½®</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">content-api</span> <span class="comment"># è·¯ç”±idï¼Œè‡ªå®šä¹‰ï¼Œåªè¦å”¯ä¸€å³å¯</span></span><br><span class="line">          <span class="comment"># uri: http://127.0.0.1:8081 # è·¯ç”±çš„ç›®æ ‡åœ°å€ httpå°±æ˜¯å›ºå®šåœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://content-api</span> <span class="comment"># è·¯ç”±çš„ç›®æ ‡åœ°å€ lbå°±æ˜¯è´Ÿè½½å‡è¡¡ï¼Œåé¢è·ŸæœåŠ¡åç§°</span></span><br><span class="line">          <span class="attr">predicates:</span> <span class="comment"># è·¯ç”±æ–­è¨€ï¼Œä¹Ÿå°±æ˜¯åˆ¤æ–­è¯·æ±‚æ˜¯å¦ç¬¦åˆè·¯ç”±è§„åˆ™çš„æ¡ä»¶</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/content/**</span> <span class="comment"># è¿™ä¸ªæ˜¯æŒ‰ç…§è·¯å¾„åŒ¹é…ï¼Œåªè¦ä»¥/content/å¼€å¤´å°±ç¬¦åˆè¦æ±‚</span></span><br><span class="line"><span class="comment">#          filters:</span></span><br><span class="line"><span class="comment">#            - StripPrefix=1</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">system-api</span></span><br><span class="line">          <span class="comment"># uri: http://127.0.0.1:8081</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://system-api</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/system/**</span></span><br><span class="line"><span class="comment">#          filters:</span></span><br><span class="line"><span class="comment">#            - StripPrefix=1</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">media-api</span></span><br><span class="line">          <span class="comment"># uri: http://127.0.0.1:8081</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://media-api</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/media/**</span></span><br><span class="line"><span class="comment">#          filters:</span></span><br><span class="line"><span class="comment">#            - StripPrefix=1</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">search-service</span></span><br><span class="line">          <span class="comment"># uri: http://127.0.0.1:8081</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://search</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/search/**</span></span><br><span class="line"><span class="comment">#          filters:</span></span><br><span class="line"><span class="comment">#            - StripPrefix=1</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">auth-service</span></span><br><span class="line">          <span class="comment"># uri: http://127.0.0.1:8081</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://auth-service</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/auth/**</span></span><br><span class="line"><span class="comment">#          filters:</span></span><br><span class="line"><span class="comment">#            - StripPrefix=1</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">checkcode</span></span><br><span class="line">          <span class="comment"># uri: http://127.0.0.1:8081</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://checkcode</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/checkcode/**</span></span><br><span class="line"><span class="comment">#          filters:</span></span><br><span class="line"><span class="comment">#            - StripPrefix=1</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">learning-api</span></span><br><span class="line">          <span class="comment"># uri: http://127.0.0.1:8081</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://learning-api</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/learning/**</span></span><br><span class="line"><span class="comment">#          filters:</span></span><br><span class="line"><span class="comment">#            - StripPrefix=1</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">orders-api</span></span><br><span class="line">          <span class="comment"># uri: http://127.0.0.1:8081</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://orders-api</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/orders/**</span></span><br><span class="line"><span class="comment">#          filters:</span></span><br><span class="line"><span class="comment">#            - StripPrefix=1</span></span><br></pre></td></tr></table></figure><p>5ï¸âƒ£å¯åŠ¨ç½‘å…³å·¥ç¨‹ï¼Œé€šè¿‡ç½‘å…³å·¥ç¨‹è®¿é—®å¾®æœåŠ¡è¿›è¡Œæµ‹è¯•ã€‚</p><ul><li>åœ¨http-client-env.jsonä¸­é…ç½®ç½‘å…³çš„åœ°å€</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;dev&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;access_token&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;gateway_host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;localhost:63010&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;content_host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;localhost:63040&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;system_host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;localhost:63110&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;media_host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;localhost:63050&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;search_host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;localhost:63080&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;auth_host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;localhost:63070&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;checkcode_host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;localhost:63075&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;learning_host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;localhost:63020&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>6ï¸âƒ£ä½¿ç”¨httpclientæµ‹è¯•è¯¾ç¨‹æŸ¥è¯¢ æ¥å£ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">### æŸ¥è¯¢è¯¾ç¨‹ä¿¡æ¯</span><br><span class="line">POST &#123;&#123;gateway_host&#125;&#125;/content/course/list?pageNo=1&amp;pageSize=2</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;auditStatus&quot;: &quot;202004&quot;,</span><br><span class="line">  &quot;courseName&quot;: &quot;java&quot;,</span><br><span class="line">  &quot;publishStatus&quot;: &quot;&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œï¼Œè§‚å¯Ÿæ˜¯å¦å¯ä»¥æ­£å¸¸è®¿é—®æ¥å£ ï¼Œå¦‚ä¸‹æ‰€ç¤ºå¯ä»¥æ­£å¸¸è¯·æ±‚æ¥å£ã€‚</p><p>7ï¸âƒ£ç½‘å…³å·¥ç¨‹æ­å»ºå®Œæˆå³å¯å°†å‰ç«¯å·¥ç¨‹ä¸­çš„æ¥å£åœ°å€æ”¹ä¸ºç½‘å…³çš„åœ°å€</p><p>å¯åŠ¨å‰ç«¯å·¥ç¨‹ï¼Œæµ‹è¯•ä¹‹å‰å¼€å‘å†…å®¹ç®¡ç†æ¨¡å—çš„åŠŸèƒ½ã€‚</p><p>è§‚å¯Ÿç½‘å…³æ§åˆ¶å°ï¼Œé€šè¿‡ç½‘å…³è½¬å‘è¯¾ç¨‹æŸ¥è¯¢çš„æ—¥å¿—å¦‚ä¸‹ï¼š</p><h2 id="2-4-æ­å»ºåª’èµ„å·¥ç¨‹"><a href="#2-4-æ­å»ºåª’èµ„å·¥ç¨‹" class="headerlink" title="2.4 æ­å»ºåª’èµ„å·¥ç¨‹"></a>2.4 æ­å»ºåª’èµ„å·¥ç¨‹</h2><p>è‡³æ­¤ç½‘å…³ã€Nacoså·²ç»æ­å»ºå®Œæˆï¼Œä¸‹è¾¹å°†åª’èµ„å·¥ç¨‹å¯¼å…¥é¡¹ç›®ã€‚</p><p>ä»è¯¾ç¨‹èµ„æ–™ä¸­è·å–åª’èµ„å·¥ç¨‹ xuecheng-plus-mediaï¼Œæ‹·è´åˆ°é¡¹ç›®å·¥ç¨‹æ ¹ç›®å½•ã€‚</p><p>å³é”®pom.xmlè½¬ä¸ºmavenå·¥ç¨‹ã€‚</p><p><img src="./assets/image-20230604204151711.png" alt="image-20230604204151711" style="zoom: 67%;" /></p><p>ä¸‹è¾¹åšå¦‚ä¸‹é…ç½®ï¼š</p><ol><li><p>åˆ›å»ºåª’èµ„æ•°æ®åº“xc_mediaï¼Œå¹¶å¯¼å…¥èµ„æ–™ç›®å½•ä¸­çš„xcplus_media.sql</p></li><li><p>ä¿®æ”¹nacosä¸Šçš„media-service-dev.yamlé…ç½®æ–‡ä»¶ä¸­çš„æ•°æ®åº“é“¾æ¥ä¿¡æ¯</p></li></ol><p>é‡å¯media-apiå·¥ç¨‹åªè¦èƒ½æ­£å¸¸å¯åŠ¨æˆåŠŸå³å¯ï¼Œç¨åæ ¹æ®éœ€æ±‚å†™æ¥å£ã€‚</p><h1 id="3-åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ"><a href="#3-åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="3. åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ"></a>3. åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ</h1><h2 id="3-1-ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ"><a href="#3-1-ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="3.1 ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ"></a>3.1 ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ</h2><p>1ï¸âƒ£è¦ç†è§£åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿé¦–å…ˆäº†è§£ä»€ä¹ˆæ˜¯æ–‡ä»¶ç³»ç»Ÿã€‚</p><p>æŸ¥é˜…ç™¾åº¦ç™¾ç§‘ï¼š</p><p><img src="./assets/wps1-1685883229820-1.jpg" alt="img"> </p><p>æ–‡ä»¶ç³»ç»Ÿæ˜¯è´Ÿè´£ç®¡ç†å’Œå­˜å‚¨æ–‡ä»¶çš„ç³»ç»Ÿè½¯ä»¶ï¼Œæ“ä½œç³»ç»Ÿé€šè¿‡æ–‡ä»¶ç³»ç»Ÿæä¾›çš„æ¥å£å»å­˜å–æ–‡ä»¶ï¼Œç”¨æˆ·é€šè¿‡æ“ä½œç³»ç»Ÿè®¿é—®ç£ç›˜ä¸Šçš„æ–‡ä»¶ã€‚</p><p>ä¸‹å›¾æŒ‡ç¤ºäº†æ–‡ä»¶ç³»ç»Ÿæ‰€å¤„çš„ä½ç½®ï¼š</p><p><img src="./assets/wps2-1685883229821-2.jpg" alt="img"> </p><p><strong>å¸¸è§çš„æ–‡ä»¶ç³»ç»Ÿ</strong>ï¼šFAT16/FAT32ã€NTFSã€HFSã€UFSã€APFSã€XFSã€Ext4ç­‰ ã€‚</p><p>2ï¸âƒ£ç°åœ¨æœ‰ä¸ªé—®é¢˜ï¼Œä¸€æ­¤çŸ­è§†é¢‘å¹³å°æ‹¥æœ‰å¤§é‡çš„è§†é¢‘ã€å›¾ç‰‡ï¼Œè¿™äº›è§†é¢‘æ–‡ä»¶ã€å›¾ç‰‡æ–‡ä»¶è¯¥å¦‚ä½•å­˜å‚¨å‘¢ï¼Ÿ</p><ul><li><p>å¦‚ä½•å­˜å‚¨å¯ä»¥æ»¡è¶³äº’è”ç½‘ä¸Šæµ·é‡ç”¨æˆ·çš„æµè§ˆã€‚</p></li><li><p>ä»Šå¤©è®²çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿå°±æ˜¯æµ·é‡ç”¨æˆ·æŸ¥é˜…æµ·é‡æ–‡ä»¶çš„æ–¹æ¡ˆã€‚</p></li></ul><p>æˆ‘ä»¬é˜…è¯»ç™¾åº¦ç™¾ç§‘å»ç†è§£åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿçš„å®šä¹‰ï¼š</p><p><img src="./assets/wps3-1685883229822-3.jpg" alt="img"> </p><p>é€šè¿‡æ¦‚å¿µå¯ä»¥ç®€å•ç†è§£ä¸ºï¼šä¸€ä¸ªè®¡ç®—æœºæ— æ³•å­˜å‚¨æµ·é‡çš„æ–‡ä»¶ï¼Œé€šè¿‡ç½‘ç»œå°†è‹¥å¹²è®¡ç®—æœºç»„ç»‡èµ·æ¥å…±åŒå»å­˜å‚¨æµ·é‡çš„æ–‡ä»¶ï¼Œ</p><ul><li>å»æ¥æ”¶æµ·é‡ç”¨æˆ·çš„è¯·æ±‚ï¼Œè¿™äº›ç»„ç»‡èµ·æ¥çš„è®¡ç®—æœºé€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡ï¼Œå¦‚ä¸‹å›¾ï¼š</li></ul><p><img src="./assets/wps4-1685883229822-4.jpg" alt="img"> </p><p>å¥½å¤„ï¼š</p><ol><li><p>ä¸€å°è®¡ç®—æœºçš„æ–‡ä»¶ç³»ç»Ÿå¤„ç†èƒ½åŠ›æ‰©å……åˆ°å¤šå°è®¡ç®—æœºåŒæ—¶å¤„ç†ã€‚</p></li><li><p>ä¸€å°è®¡ç®—æœºæŒ‚äº†è¿˜æœ‰å¦å¤–å‰¯æœ¬è®¡ç®—æœºæä¾›æ•°æ®ã€‚</p></li><li><p>æ¯å°è®¡ç®—æœºå¯ä»¥æ”¾åœ¨ä¸åŒçš„åœ°åŸŸï¼Œè¿™æ ·ç”¨æˆ·å°±å¯ä»¥å°±è¿‘è®¿é—®ï¼Œæé«˜è®¿é—®é€Ÿåº¦ã€‚</p></li></ol><p>3ï¸âƒ£å¸‚é¢ä¸Šæœ‰å“ªäº›åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿçš„äº§å“å‘¢ï¼Ÿ</p><ol><li>NFS</li></ol><p>é˜…è¯»ç™¾åº¦ç™¾ç§‘ï¼š</p><p><img src="./assets/wps5-1685883229822-5.jpg" alt="img"> </p><p><img src="./assets/wps6-1685883229822-7.jpg" alt="img" style="zoom: 67%;" /> </p><p>ç‰¹ç‚¹ï¼š</p><p>1ï¼‰åœ¨å®¢æˆ·ç«¯ä¸Šæ˜ å°„NFSæœåŠ¡å™¨çš„é©±åŠ¨å™¨ã€‚</p><p>2ï¼‰å®¢æˆ·ç«¯é€šè¿‡ç½‘ç»œè®¿é—®NFSæœåŠ¡å™¨çš„ç¡¬ç›˜å®Œå…¨é€æ˜ã€‚</p><ol><li>GFS</li></ol><p><img src="./assets/wps7-1685883229822-6.jpg" alt="img"> </p><p><img src="./assets/wps8-1685883229822-8.jpg" alt="img"> </p><p>1ï¼‰GFSé‡‡ç”¨ä¸»ä»ç»“æ„ï¼Œä¸€ä¸ªGFSé›†ç¾¤ç”±ä¸€ä¸ªmasterå’Œå¤§é‡çš„chunkserverç»„æˆã€‚</p><p>2ï¼‰masterå­˜å‚¨äº†æ•°æ®æ–‡ä»¶çš„å…ƒæ•°æ®ï¼Œä¸€ä¸ªæ–‡ä»¶è¢«åˆ†æˆäº†è‹¥å¹²å—å­˜å‚¨åœ¨å¤šä¸ªchunkserverä¸­ã€‚</p><p>3ï¼‰ç”¨æˆ·ä»masterä¸­è·å–æ•°æ®å…ƒä¿¡æ¯ï¼Œå‘chunkserverå­˜å‚¨æ•°æ®ã€‚</p><ol><li>HDFS</li></ol><p>HDFSï¼Œæ˜¯Hadoop Distributed File Systemçš„ç®€ç§°ï¼Œæ˜¯HadoopæŠ½è±¡æ–‡ä»¶ç³»ç»Ÿçš„ä¸€ç§å®ç°ã€‚</p><ul><li>HDFSæ˜¯ä¸€ä¸ªé«˜åº¦å®¹é”™æ€§çš„ç³»ç»Ÿï¼Œé€‚åˆéƒ¨ç½²åœ¨å»‰ä»·çš„æœºå™¨ä¸Šã€‚</li><li>HDFSèƒ½æä¾›é«˜ååé‡çš„æ•°æ®è®¿é—®ï¼Œéå¸¸é€‚åˆå¤§è§„æ¨¡æ•°æ®é›†ä¸Šçš„åº”ç”¨ã€‚</li><li>HDFSçš„æ–‡ä»¶åˆ†å¸ƒåœ¨é›†ç¾¤æœºå™¨ä¸Šï¼ŒåŒæ—¶æä¾›å‰¯æœ¬è¿›è¡Œå®¹é”™åŠå¯é æ€§ä¿è¯ã€‚</li><li>ä¾‹å¦‚å®¢æˆ·ç«¯å†™å…¥è¯»å–æ–‡ä»¶çš„ç›´æ¥æ“ä½œéƒ½æ˜¯åˆ†å¸ƒåœ¨é›†ç¾¤å„ä¸ªæœºå™¨ä¸Šçš„ï¼Œæ²¡æœ‰å•ç‚¹æ€§èƒ½å‹åŠ›ã€‚</li></ul><p>ä¸‹å›¾æ˜¯HDFSçš„æ¶æ„å›¾ï¼š</p><p><img src="./assets/wps9-1685883229822-9.jpg" alt="img"> </p><p>1ï¼‰HDFSé‡‡ç”¨ä¸»ä»ç»“æ„ï¼Œä¸€ä¸ªHDFSé›†ç¾¤ç”±ä¸€ä¸ªåç§°ç»“ç‚¹å’Œè‹¥å¹²æ•°æ®ç»“ç‚¹ç»„æˆã€‚</p><p>2ï¼‰åç§°ç»“ç‚¹å­˜å‚¨æ•°æ®çš„å…ƒä¿¡æ¯ï¼Œä¸€ä¸ªå®Œæ•´çš„æ•°æ®æ–‡ä»¶åˆ†æˆè‹¥å¹²å—å­˜å‚¨åœ¨æ•°æ®ç»“ç‚¹ã€‚</p><p>3ï¼‰å®¢æˆ·ç«¯ä»åç§°ç»“ç‚¹è·å–æ•°æ®çš„å…ƒä¿¡æ¯åŠæ•°æ®åˆ†å—çš„ä¿¡æ¯ï¼Œå¾—åˆ°ä¿¡æ¯å®¢æˆ·ç«¯å³å¯ä»æ•°æ®å—æ¥å­˜å–æ•°æ®ã€‚</p><p><strong>4. äº‘è®¡ç®—å‚å®¶</strong></p><p>é˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼ˆObject Storage Serviceï¼Œç®€ç§° OSSï¼‰ï¼Œæ˜¯é˜¿é‡Œäº‘æä¾›çš„æµ·é‡ã€å®‰å…¨ã€ä½æˆæœ¬ã€é«˜å¯é çš„äº‘å­˜å‚¨æœåŠ¡ã€‚å…¶æ•°æ®è®¾è®¡æŒä¹…æ€§ä¸ä½äº 99.9999999999%ï¼ˆ12 ä¸ª 9ï¼‰ï¼ŒæœåŠ¡è®¾è®¡å¯ç”¨æ€§ï¼ˆæˆ–ä¸šåŠ¡è¿ç»­æ€§ï¼‰ä¸ä½äº 99.995%ã€‚</p><p><em>å®˜æ–¹ç½‘ç«™ï¼š</em><a href="https://www.aliyun.com/product/oss"><em>https://www.aliyun.com/product/oss</em></a> </p><p>ç™¾åº¦å¯¹è±¡å­˜å‚¨BOSæä¾›ç¨³å®šã€å®‰å…¨ã€é«˜æ•ˆã€é«˜å¯æ‰©å±•çš„äº‘å­˜å‚¨æœåŠ¡ã€‚æ‚¨å¯ä»¥å°†ä»»æ„æ•°é‡å’Œå½¢å¼çš„éç»“æ„åŒ–æ•°æ®å­˜å…¥BOSï¼Œå¹¶å¯¹æ•°æ®è¿›è¡Œç®¡ç†å’Œå¤„ç†ã€‚BOSæ”¯æŒæ ‡å‡†ã€ä½é¢‘ã€å†·å’Œå½’æ¡£å­˜å‚¨ç­‰å¤šç§å­˜å‚¨ç±»å‹ï¼Œæ»¡è¶³å¤šåœºæ™¯çš„å­˜å‚¨éœ€æ±‚ã€‚ </p><p><em>å®˜æ–¹ç½‘ç«™ï¼š</em><a href="https://cloud.baidu.com/product/bos.html"><em>https://cloud.baidu.com/product/bos.html</em></a> </p><h2 id="3-2-MinIo"><a href="#3-2-MinIo" class="headerlink" title="3.2 MinIo"></a>3.2 MinIo</h2><h3 id="3-2-1-ä»‹ç»"><a href="#3-2-1-ä»‹ç»" class="headerlink" title="3.2.1 ä»‹ç»"></a>3.2.1 ä»‹ç»</h3><blockquote><p>æœ¬é¡¹ç›®é‡‡ç”¨MinIOæ„å»ºåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œ</p><p>MinIO æ˜¯ä¸€ä¸ªéå¸¸è½»é‡çš„æœåŠ¡,å¯ä»¥å¾ˆç®€å•çš„å’Œå…¶ä»–åº”ç”¨çš„ç»“åˆä½¿ç”¨ï¼Œå®ƒå…¼å®¹äºšé©¬é€Š S3 äº‘å­˜å‚¨æœåŠ¡æ¥å£ï¼Œéå¸¸é€‚åˆäºå­˜å‚¨å¤§å®¹é‡éç»“æ„åŒ–çš„æ•°æ®ï¼Œä¾‹å¦‚å›¾ç‰‡ã€è§†é¢‘ã€æ—¥å¿—æ–‡ä»¶ã€å¤‡ä»½æ•°æ®å’Œå®¹å™¨/è™šæ‹Ÿæœºé•œåƒç­‰ã€‚</p><p>å®ƒä¸€å¤§ç‰¹ç‚¹å°±æ˜¯è½»é‡ï¼Œä½¿ç”¨ç®€å•ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œæ”¯æŒå„ç§å¹³å°ï¼Œå•ä¸ªæ–‡ä»¶æœ€å¤§5TBï¼Œå…¼å®¹ Amazon S3æ¥å£ï¼Œæä¾›äº† Javaã€Pythonã€GOç­‰å¤šç‰ˆæœ¬SDKæ”¯æŒã€‚</p><p>å®˜ç½‘ï¼š<a href="https://min.io">https://min.io</a></p><p>ä¸­æ–‡ï¼š<a href="https://www.minio.org.cn/ï¼Œhttp://docs.minio.org.cn/docs/">https://www.minio.org.cn/ï¼Œhttp://docs.minio.org.cn/docs/</a></p></blockquote><p>MinIOé›†ç¾¤é‡‡ç”¨å»ä¸­å¿ƒåŒ–å…±äº«æ¶æ„ï¼Œæ¯ä¸ªç»“ç‚¹æ˜¯å¯¹ç­‰å…³ç³»ï¼Œé€šè¿‡Nginxå¯å¯¹MinIOè¿›è¡Œè´Ÿè½½å‡è¡¡è®¿é—®ã€‚</p><p>å»ä¸­å¿ƒåŒ–æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ</p><p>åœ¨å¤§æ•°æ®é¢†åŸŸï¼Œé€šå¸¸çš„è®¾è®¡ç†å¿µéƒ½æ˜¯æ— ä¸­å¿ƒå’Œåˆ†å¸ƒå¼ã€‚</p><ul><li>Minioåˆ†å¸ƒå¼æ¨¡å¼å¯ä»¥å¸®åŠ©ä½ æ­å»ºä¸€ä¸ªé«˜å¯ç”¨çš„å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™äº›å­˜å‚¨è®¾å¤‡ï¼Œè€Œä¸ç”¨è€ƒè™‘å…¶çœŸå®ç‰©ç†ä½ç½®ã€‚</li></ul><p>å®ƒå°†åˆ†å¸ƒåœ¨ä¸åŒæœåŠ¡å™¨ä¸Šçš„å¤šå—ç¡¬ç›˜ç»„æˆä¸€ä¸ªå¯¹è±¡å­˜å‚¨æœåŠ¡ã€‚ç”±äºç¡¬ç›˜åˆ†å¸ƒåœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Šï¼Œåˆ†å¸ƒå¼Minioé¿å…äº†å•ç‚¹æ•…éšœã€‚å¦‚ä¸‹å›¾ï¼š</p><p><img src="./assets/wps1-1685965514753-1.jpg" alt="img" style="zoom:67%;" /> </p><p>Minioä½¿ç”¨çº åˆ ç æŠ€æœ¯æ¥ä¿æŠ¤æ•°æ®ï¼Œå®ƒæ˜¯ä¸€ç§æ¢å¤ä¸¢å¤±å’ŒæŸåæ•°æ®çš„æ•°å­¦ç®—æ³•ï¼Œ</p><ul><li>å®ƒå°†æ•°æ®åˆ†å—å†—ä½™çš„åˆ†æ•£å­˜å‚¨åœ¨å„å„èŠ‚ç‚¹çš„ç£ç›˜ä¸Šï¼Œæ‰€æœ‰çš„å¯ç”¨ç£ç›˜ç»„æˆä¸€ä¸ªé›†åˆï¼Œ</li><li>ä¸Šå›¾ç”±8å—ç¡¬ç›˜ç»„æˆä¸€ä¸ªé›†åˆï¼Œå½“ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶æ—¶ä¼šé€šè¿‡çº åˆ ç ç®—æ³•è®¡ç®—å¯¹æ–‡ä»¶è¿›è¡Œåˆ†å—å­˜å‚¨ï¼Œé™¤äº†å°†æ–‡ä»¶æœ¬èº«åˆ†æˆ4ä¸ªæ•°æ®å—ï¼Œ</li><li>è¿˜ä¼šç”Ÿæˆ4ä¸ªæ ¡éªŒå—ï¼Œæ•°æ®å—å’Œæ ¡éªŒå—ä¼šåˆ†æ•£çš„å­˜å‚¨åœ¨è¿™8å—ç¡¬ç›˜ä¸Šã€‚</li></ul><p>ä½¿ç”¨çº åˆ ç çš„å¥½å¤„æ˜¯å³ä¾¿ä¸¢å¤±ä¸€åŠæ•°é‡ï¼ˆN/2ï¼‰çš„ç¡¬ç›˜ï¼Œä»ç„¶å¯ä»¥æ¢å¤æ•°æ®ã€‚ </p><ul><li>æ¯”å¦‚ä¸Šè¾¹é›†åˆä¸­æœ‰4ä¸ªä»¥å†…çš„ç¡¬ç›˜æŸå®³ä»å¯ä¿è¯æ•°æ®æ¢å¤ï¼Œä¸å½±å“ä¸Šä¼ å’Œä¸‹è½½ï¼Œ</li><li>å¦‚æœå¤šäºä¸€åŠçš„ç¡¬ç›˜åäº†åˆ™æ— æ³•æ¢å¤ã€‚</li></ul><h3 id="3-2-2-æµ‹è¯•docker-ç¯å¢ƒ"><a href="#3-2-2-æµ‹è¯•docker-ç¯å¢ƒ" class="headerlink" title="3.2.2 æµ‹è¯•docker ç¯å¢ƒ"></a>3.2.2 æµ‹è¯•docker ç¯å¢ƒ</h3><p>å¼€å‘é˜¶æ®µå’Œç”Ÿäº§é˜¶æ®µç»Ÿä¸€ä½¿ç”¨Dockerä¸‹çš„MINIOã€‚</p><p>åœ¨ä¸‹å‘çš„è™šæ‹Ÿæœºä¸­å·²å®‰è£…äº†MinIOçš„é•œåƒå’Œå®¹å™¨ï¼Œæ‰§è¡Œsh /data/soft /restart.shå¯åŠ¨Dockerä¸‹çš„MinIO</p><p>å¯åŠ¨å®Œæˆç™»å½•MinIOæŸ¥çœ‹æ˜¯å¦æ­£å¸¸ã€‚</p><p>è®¿é—®<a href="http://192.168.101.65:9000">http://192.168.101.65:9000</a></p><p><img src="./assets/image-20230605195548163.png" alt="image-20230605195548163"></p><p>æœ¬é¡¹ç›®åˆ›å»ºä¸¤ä¸ªbucketsï¼š</p><ul><li><p>mediafilesï¼š æ™®é€šæ–‡ä»¶</p></li><li><p>videoï¼šè§†é¢‘æ–‡ä»¶</p></li></ul><h3 id="3-2-4-SDK"><a href="#3-2-4-SDK" class="headerlink" title="3.2.4 SDK"></a>3.2.4 SDK</h3><h4 id="ä¸Šä¼ æ–‡ä»¶"><a href="#ä¸Šä¼ æ–‡ä»¶" class="headerlink" title="ä¸Šä¼ æ–‡ä»¶"></a>ä¸Šä¼ æ–‡ä»¶</h4><p>MinIOæä¾›å¤šä¸ªè¯­è¨€ç‰ˆæœ¬SDKçš„æ”¯æŒï¼Œä¸‹è¾¹æ‰¾åˆ°javaç‰ˆæœ¬çš„æ–‡æ¡£ï¼š</p><p>åœ°å€ï¼š<a href="https://docs.min.io/docs/java-client-quickstart-guide.html">https://docs.min.io/docs/java-client-quickstart-guide.html</a></p><p>æœ€ä½éœ€æ±‚Java 1.8æˆ–æ›´é«˜ç‰ˆæœ¬:</p><p>mavenä¾èµ–å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.minio<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>minio<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.4.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.squareup.okhttp3<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>okhttp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨media-serviceå·¥ç¨‹æ·»åŠ æ­¤ä¾èµ–ã€‚</p><p>å‚æ•°è¯´æ˜ï¼š</p><p>éœ€è¦ä¸‰ä¸ªå‚æ•°æ‰èƒ½è¿æ¥åˆ°minioæœåŠ¡ã€‚</p><div class="table-container"><table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>Endpoint</td><td>å¯¹è±¡å­˜å‚¨æœåŠ¡çš„URL</td></tr><tr><td>Access Key</td><td>Access keyå°±åƒç”¨æˆ·IDï¼Œå¯ä»¥å”¯ä¸€æ ‡è¯†ä½ çš„è´¦æˆ·ã€‚</td></tr><tr><td>Secret Key</td><td>Secret keyæ˜¯ä½ è´¦æˆ·çš„å¯†ç ã€‚</td></tr></tbody></table></div><p>å®˜æ–¹çš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.minio.BucketExistsArgs;</span><br><span class="line"><span class="keyword">import</span> io.minio.MakeBucketArgs;</span><br><span class="line"><span class="keyword">import</span> io.minio.MinioClient;</span><br><span class="line"><span class="keyword">import</span> io.minio.UploadObjectArgs;</span><br><span class="line"><span class="keyword">import</span> io.minio.errors.MinioException;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.security.InvalidKeyException;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileUploader</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span><span class="keyword">throws</span> IOException, NoSuchAlgorithmException, InvalidKeyException &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// Create a minioClient with the MinIO server playground, its access key and secret key.</span></span><br><span class="line">            <span class="type">MinioClient</span> <span class="variable">minioClient</span> <span class="operator">=</span></span><br><span class="line">                MinioClient.builder()</span><br><span class="line">                .endpoint(<span class="string">&quot;https://play.min.io&quot;</span>)</span><br><span class="line">                .credentials(<span class="string">&quot;Q3AM3UQ867SPQQA43P2F&quot;</span>, <span class="string">&quot;zuf+tfteSlswRu7BJ86wekitnifILbZam1KYY3TG&quot;</span>)</span><br><span class="line">                .build();</span><br><span class="line">            <span class="comment">// Make &#x27;asiatrip&#x27; bucket if not exist.</span></span><br><span class="line">            <span class="type">boolean</span> <span class="variable">found</span> <span class="operator">=</span></span><br><span class="line">                minioClient.bucketExists(BucketExistsArgs.builder().bucket(<span class="string">&quot;asiatrip&quot;</span>).build());</span><br><span class="line">            <span class="keyword">if</span> (!found) &#123;</span><br><span class="line">                <span class="comment">// Make a new bucket called &#x27;asiatrip&#x27;.</span></span><br><span class="line">                minioClient.makeBucket(MakeBucketArgs.builder().bucket(<span class="string">&quot;asiatrip&quot;</span>).build());</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Bucket &#x27;asiatrip&#x27; already exists.&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// Upload &#x27;/home/user/Photos/asiaphotos.zip&#x27; as object name &#x27;asiaphotos-2015.zip&#x27; to bucket</span></span><br><span class="line">            <span class="comment">// &#x27;asiatrip&#x27;.</span></span><br><span class="line">            minioClient.uploadObject(</span><br><span class="line">                UploadObjectArgs.builder()</span><br><span class="line">                .bucket(<span class="string">&quot;asiatrip&quot;</span>)</span><br><span class="line">                .object(<span class="string">&quot;asiaphotos-2015.zip&quot;</span>)</span><br><span class="line">                .filename(<span class="string">&quot;/home/user/Photos/asiaphotos.zip&quot;</span>)</span><br><span class="line">                .build());</span><br><span class="line">            System.out.println(</span><br><span class="line">                <span class="string">&quot;&#x27;/home/user/Photos/asiaphotos.zip&#x27; is successfully uploaded as &quot;</span></span><br><span class="line">                + <span class="string">&quot;object &#x27;asiaphotos-2015.zip&#x27; to bucket &#x27;asiatrip&#x27;.&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (MinioException e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Error occurred: &quot;</span> + e);</span><br><span class="line">            System.out.println(<span class="string">&quot;HTTP trace: &quot;</span> + e.httpTrace());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‚è€ƒç¤ºä¾‹åœ¨media-serviceå·¥ç¨‹ä¸­ æµ‹è¯•ä¸Šä¼ æ–‡ä»¶åŠŸèƒ½ï¼Œ</p><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªç”¨äºæµ‹è¯•çš„bucket</p><ul><li>æ³¨æ„è¦è®¾ç½®æƒé™ä¸º public</li></ul><p>åœ¨xuecheng-plus-media-serviceå·¥ç¨‹ çš„testä¸‹ç¼–å†™æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.media;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.minio.BucketExistsArgs;</span><br><span class="line"><span class="keyword">import</span> io.minio.MakeBucketArgs;</span><br><span class="line"><span class="keyword">import</span> io.minio.MinioClient;</span><br><span class="line"><span class="keyword">import</span> io.minio.UploadObjectArgs;</span><br><span class="line"><span class="keyword">import</span> io.minio.errors.MinioException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.security.InvalidKeyException;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æµ‹è¯•MinIO</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Mr.M</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/9/11 21:24</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MinioTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="type">MinioClient</span> <span class="variable">minioClient</span> <span class="operator">=</span></span><br><span class="line">            MinioClient.builder()</span><br><span class="line">                    .endpoint(<span class="string">&quot;http://192.168.101.65:9000&quot;</span>)</span><br><span class="line">                    .credentials(<span class="string">&quot;minioadmin&quot;</span>, <span class="string">&quot;minioadmin&quot;</span>)</span><br><span class="line">                    .build();</span><br><span class="line"></span><br><span class="line">   <span class="comment">//ä¸Šä¼ æ–‡ä»¶</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span>  <span class="keyword">void</span> <span class="title function_">upload</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">UploadObjectArgs</span> <span class="variable">testbucket</span> <span class="operator">=</span> UploadObjectArgs.builder()</span><br><span class="line">                    .bucket(<span class="string">&quot;testbucket&quot;</span>)</span><br><span class="line"><span class="comment">//                    .object(&quot;test001.mp4&quot;)</span></span><br><span class="line">                    .object(<span class="string">&quot;001/test001.mp4&quot;</span>)<span class="comment">//æ·»åŠ å­ç›®å½•</span></span><br><span class="line">                    .filename(<span class="string">&quot;D:\\develop\\upload\\1mp4.temp&quot;</span>)</span><br><span class="line">                    .contentType(<span class="string">&quot;video/mp4&quot;</span>)<span class="comment">//é»˜è®¤æ ¹æ®æ‰©å±•åç¡®å®šæ–‡ä»¶å†…å®¹ç±»å‹ï¼Œä¹Ÿå¯ä»¥æŒ‡å®š</span></span><br><span class="line">                    .build();</span><br><span class="line">            minioClient.uploadObject(testbucket);</span><br><span class="line">            System.out.println(<span class="string">&quot;ä¸Šä¼ æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            System.out.println(<span class="string">&quot;ä¸Šä¼ å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œuploadæ–¹æ³•ï¼Œåˆ†åˆ«æµ‹è¯•å‘æ¡¶çš„æ ¹ç›®å½•ä¸Šä¼ æ–‡ä»¶ä»¥åŠå­ç›®å½•ä¸Šä¼ æ–‡ä»¶ã€‚</p><ul><li>ä¸Šä¼ æˆåŠŸï¼Œé€šè¿‡webæ§åˆ¶å°æŸ¥çœ‹æ–‡ä»¶ï¼Œå¹¶é¢„è§ˆæ–‡ä»¶ã€‚</li></ul><p>è¯´æ˜ï¼š</p><ul><li><p>è®¾ç½®contentTypeå¯ä»¥é€šè¿‡com.j256.simplemagic.ContentTypeæšä¸¾ç±»æŸ¥çœ‹å¸¸ç”¨çš„mimeTypeï¼ˆåª’ä½“ç±»å‹ï¼‰</p></li><li><p>é€šè¿‡æ‰©å±•åå¾—åˆ°mimeTypeï¼Œä»£ç å¦‚ä¸‹ï¼š</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ ¹æ®æ‰©å±•åå–å‡ºmimeType</span></span><br><span class="line"><span class="type">ContentInfo</span> <span class="variable">extensionMatch</span> <span class="operator">=</span> ContentInfoUtil.findExtensionMatch(<span class="string">&quot;.mp4&quot;</span>);</span><br><span class="line"><span class="type">String</span> <span class="variable">mimeType</span> <span class="operator">=</span> MediaType.APPLICATION_OCTET_STREAM_VALUE;<span class="comment">//é€šç”¨mimeTypeï¼Œå­—èŠ‚æµ</span></span><br></pre></td></tr></table></figure><p>å®Œå–„ä¸Šè¾¹çš„ä»£ç  å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title function_">upload</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//æ ¹æ®æ‰©å±•åå–å‡ºmimeType</span></span><br><span class="line">    <span class="type">ContentInfo</span> <span class="variable">extensionMatch</span> <span class="operator">=</span> ContentInfoUtil.findExtensionMatch(<span class="string">&quot;.mp4&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">mimeType</span> <span class="operator">=</span> MediaType.APPLICATION_OCTET_STREAM_VALUE;<span class="comment">//é€šç”¨mimeTypeï¼Œå­—èŠ‚æµ</span></span><br><span class="line">    <span class="keyword">if</span>(extensionMatch!=<span class="literal">null</span>)&#123;</span><br><span class="line">        mimeType = extensionMatch.getMimeType();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">UploadObjectArgs</span> <span class="variable">testbucket</span> <span class="operator">=</span> UploadObjectArgs.builder()</span><br><span class="line">            .bucket(<span class="string">&quot;testbucket&quot;</span>)</span><br><span class="line">            <span class="comment">//                    .object(&quot;test001.mp4&quot;)</span></span><br><span class="line">            .object(<span class="string">&quot;001/test001.mp4&quot;</span>)<span class="comment">//æ·»åŠ å­ç›®å½•</span></span><br><span class="line">            .filename(<span class="string">&quot;D:\\develop\\upload\\1mp4.temp&quot;</span>)</span><br><span class="line">            .contentType(mimeType)<span class="comment">//é»˜è®¤æ ¹æ®æ‰©å±•åç¡®å®šæ–‡ä»¶å†…å®¹ç±»å‹ï¼Œä¹Ÿå¯ä»¥æŒ‡å®š</span></span><br><span class="line">            .build();</span><br><span class="line">        minioClient.uploadObject(testbucket);</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸Šä¼ æˆåŠŸ&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸Šä¼ å¤±è´¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åˆ é™¤æ–‡ä»¶"><a href="#åˆ é™¤æ–‡ä»¶" class="headerlink" title="åˆ é™¤æ–‡ä»¶"></a>åˆ é™¤æ–‡ä»¶</h4><p>ä¸‹è¾¹æµ‹è¯•åˆ é™¤æ–‡ä»¶</p><p>å‚è€ƒï¼š<a href="https://docs.min.io/docs/java-client-api-reference#removeObject">https://docs.min.io/docs/java-client-api-reference#removeObject</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        minioClient.removeObject(</span><br><span class="line">               RemoveObjectArgs.builder().bucket(<span class="string">&quot;testbucket&quot;</span>).object(<span class="string">&quot;001/test001.mp4&quot;</span>).build());</span><br><span class="line">        System.out.println(<span class="string">&quot;åˆ é™¤æˆåŠŸ&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">       e.printStackTrace();</span><br><span class="line">        System.out.println(<span class="string">&quot;åˆ é™¤å¤±è´¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æŸ¥è¯¢æ–‡ä»¶"><a href="#æŸ¥è¯¢æ–‡ä»¶" class="headerlink" title="æŸ¥è¯¢æ–‡ä»¶"></a>æŸ¥è¯¢æ–‡ä»¶</h4><p>é€šè¿‡æŸ¥è¯¢æ–‡ä»¶æŸ¥çœ‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨minioä¸­ã€‚</p><p>å‚è€ƒï¼š<a href="https://docs.min.io/docs/java-client-api-reference#getObject">https://docs.min.io/docs/java-client-api-reference#getObject</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Java</span><br><span class="line"><span class="comment">//æŸ¥è¯¢æ–‡ä»¶</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getFile</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">GetObjectArgs</span> <span class="variable">getObjectArgs</span> <span class="operator">=</span> GetObjectArgs.builder().bucket(<span class="string">&quot;testbucket&quot;</span>).object(<span class="string">&quot;test001.mp4&quot;</span>).build();</span><br><span class="line">    <span class="keyword">try</span>(</span><br><span class="line">        <span class="type">FilterInputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> minioClient.getObject(getObjectArgs);</span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;D:\\develop\\upload\\1_2.mp4&quot;</span>));</span><br><span class="line">     ) &#123;</span><br><span class="line">        IOUtils.copy(inputStream,outputStream);</span><br><span class="line">     &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¡éªŒæ–‡ä»¶çš„å®Œæ•´æ€§ï¼Œå¯¹æ–‡ä»¶è®¡ç®—å‡ºmd5å€¼ï¼Œæ¯”è¾ƒåŸå§‹æ–‡ä»¶çš„md5å’Œç›®æ ‡æ–‡ä»¶çš„md5ï¼Œä¸€è‡´åˆ™è¯´æ˜å®Œæ•´</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ ¡éªŒæ–‡ä»¶çš„å®Œæ•´æ€§å¯¹æ–‡ä»¶çš„å†…å®¹è¿›è¡Œmd5</span></span><br><span class="line"><span class="type">FileInputStream</span> <span class="variable">fileInputStream1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;D:\\develop\\upload\\1.mp4&quot;</span>));</span><br><span class="line"><span class="type">String</span> <span class="variable">source_md5</span> <span class="operator">=</span> DigestUtils.md5Hex(fileInputStream1);</span><br><span class="line"><span class="type">FileInputStream</span> <span class="variable">fileInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;D:\\develop\\upload\\1a.mp4&quot;</span>));</span><br><span class="line"><span class="type">String</span> <span class="variable">local_md5</span> <span class="operator">=</span> DigestUtils.md5Hex(fileInputStream);</span><br><span class="line"><span class="keyword">if</span>(source_md5.equals(local_md5))&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;ä¸‹è½½æˆåŠŸ&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="4-ä¸Šä¼ å›¾ç‰‡"><a href="#4-ä¸Šä¼ å›¾ç‰‡" class="headerlink" title="4. ä¸Šä¼ å›¾ç‰‡"></a>4. ä¸Šä¼ å›¾ç‰‡</h1><h2 id="4-1-éœ€æ±‚åˆ†æ"><a href="#4-1-éœ€æ±‚åˆ†æ" class="headerlink" title="4.1 éœ€æ±‚åˆ†æ"></a>4.1 éœ€æ±‚åˆ†æ</h2><h3 id="4-1-1-ä¸šåŠ¡æµç¨‹"><a href="#4-1-1-ä¸šåŠ¡æµç¨‹" class="headerlink" title="4.1.1 ä¸šåŠ¡æµç¨‹"></a>4.1.1 ä¸šåŠ¡æµç¨‹</h3><p>è¯¾ç¨‹å›¾ç‰‡æ˜¯å®£ä¼ è¯¾ç¨‹éå¸¸é‡è¦çš„ä¿¡æ¯ï¼Œåœ¨æ–°å¢è¯¾ç¨‹ç•Œé¢ä¸Šä¼ è¯¾ç¨‹å›¾ç‰‡ï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹è¯¾ç¨‹å›¾ç‰‡ã€‚</p><p>å¦‚ä¸‹å›¾ï¼š</p><p><img src="./assets/wps1-1686138025194-1.jpg" alt="img" style="zoom:50%;" /> </p><p>ä¸Šä¼ è¯¾ç¨‹å›¾ç‰‡æ€»ä½“ä¸ŠåŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼š</p><ol><li><p>ä¸Šä¼ è¯¾ç¨‹å›¾ç‰‡å‰ç«¯è¯·æ±‚åª’èµ„ç®¡ç†æœåŠ¡å°†æ–‡ä»¶ä¸Šä¼ è‡³åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶ä¸”åœ¨åª’èµ„ç®¡ç†æ•°æ®åº“ä¿å­˜æ–‡ä»¶ä¿¡æ¯ã€‚</p></li><li><p>ä¸Šä¼ å›¾ç‰‡æˆåŠŸä¿å­˜å›¾ç‰‡åœ°å€åˆ°è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯è¡¨ä¸­ã€‚</p></li></ol><p>è¯¦ç»†æµç¨‹å¦‚ä¸‹ï¼š</p><p><img src="./assets/wps2-1686138025194-2.jpg" alt="img"> </p><ol><li><p>å‰ç«¯è¿›å…¥ä¸Šä¼ å›¾ç‰‡ç•Œé¢</p></li><li><p>ä¸Šä¼ å›¾ç‰‡ï¼Œè¯·æ±‚åª’èµ„ç®¡ç†æœåŠ¡ã€‚</p></li><li><p>åª’èµ„ç®¡ç†æœåŠ¡å°†å›¾ç‰‡æ–‡ä»¶å­˜å‚¨åœ¨MinIOã€‚</p></li><li><p>åª’èµ„ç®¡ç†è®°å½•æ–‡ä»¶ä¿¡æ¯åˆ°æ•°æ®åº“ã€‚</p></li><li><p>å‰ç«¯è¯·æ±‚å†…å®¹ç®¡ç†æœåŠ¡ä¿å­˜è¯¾ç¨‹ä¿¡æ¯ï¼Œåœ¨å†…å®¹ç®¡ç†æ•°æ®åº“ä¿å­˜å›¾ç‰‡åœ°å€ã€‚</p></li></ol><h3 id="4-1-2-æ•°æ®æ¨¡å‹"><a href="#4-1-2-æ•°æ®æ¨¡å‹" class="headerlink" title="4.1.2 æ•°æ®æ¨¡å‹"></a>4.1.2 æ•°æ®æ¨¡å‹</h3><p>æ¶‰åŠåˆ°çš„æ•°æ®è¡¨æœ‰ï¼šè¯¾ç¨‹ä¿¡æ¯è¡¨ä¸­çš„å›¾ç‰‡å­—æ®µã€åª’èµ„æ•°æ®åº“çš„æ–‡ä»¶è¡¨ï¼Œä¸‹è¾¹ä¸»è¦çœ‹åª’èµ„æ•°æ®åº“çš„æ–‡ä»¶è¡¨ã€‚</p><p><img src="./assets/image-20230607195217426.png" alt="image-20230607195217426" style="zoom:50%;" /></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">create table media_files</span><br><span class="line">(</span><br><span class="line">    id           varchar(32)             not null comment &#x27;æ–‡ä»¶id,md5å€¼&#x27;</span><br><span class="line">        primary key,</span><br><span class="line">    company_id   bigint                  null comment &#x27;æœºæ„ID&#x27;,</span><br><span class="line">    company_name varchar(255)            null comment &#x27;æœºæ„åç§°&#x27;,</span><br><span class="line">    filename     varchar(255)            not null comment &#x27;æ–‡ä»¶åç§°&#x27;,</span><br><span class="line">    file_type    varchar(12)             null comment &#x27;æ–‡ä»¶ç±»å‹ï¼ˆå›¾ç‰‡ã€æ–‡æ¡£ï¼Œè§†é¢‘ï¼‰&#x27;,</span><br><span class="line">    tags         varchar(120)            null comment &#x27;æ ‡ç­¾&#x27;,</span><br><span class="line">    bucket       varchar(128)            null comment &#x27;å­˜å‚¨ç›®å½•&#x27;,</span><br><span class="line">    file_path    varchar(512)            null comment &#x27;å­˜å‚¨è·¯å¾„&#x27;,</span><br><span class="line">    file_id      varchar(32)             not null comment &#x27;æ–‡ä»¶id&#x27;,</span><br><span class="line">    url          varchar(1024)           null comment &#x27;åª’èµ„æ–‡ä»¶è®¿é—®åœ°å€&#x27;,</span><br><span class="line">    username     varchar(60)             null comment &#x27;ä¸Šä¼ äºº&#x27;,</span><br><span class="line">    create_date  datetime                null comment &#x27;ä¸Šä¼ æ—¶é—´&#x27;,</span><br><span class="line">    change_date  datetime                null comment &#x27;ä¿®æ”¹æ—¶é—´&#x27;,</span><br><span class="line">    status       varchar(12) default &#x27;1&#x27; null comment &#x27;çŠ¶æ€,1:æ­£å¸¸ï¼Œ0:ä¸å±•ç¤º&#x27;,</span><br><span class="line">    remark       varchar(32)             null comment &#x27;å¤‡æ³¨&#x27;,</span><br><span class="line">    audit_status varchar(12)             null comment &#x27;å®¡æ ¸çŠ¶æ€&#x27;,</span><br><span class="line">    audit_mind   varchar(255)            null comment &#x27;å®¡æ ¸æ„è§&#x27;,</span><br><span class="line">    file_size    bigint                  null comment &#x27;æ–‡ä»¶å¤§å°&#x27;,</span><br><span class="line">    constraint unique_fileid</span><br><span class="line">        unique (file_id) comment &#x27;æ–‡ä»¶idå”¯ä¸€ç´¢å¼• &#x27;</span><br><span class="line">)</span><br><span class="line">    comment &#x27;åª’èµ„ä¿¡æ¯&#x27; charset = utf8</span><br><span class="line">                       row_format = DYNAMIC;</span><br></pre></td></tr></table></figure><h2 id="4-2-å‡†å¤‡ç¯å¢ƒ"><a href="#4-2-å‡†å¤‡ç¯å¢ƒ" class="headerlink" title="4.2 å‡†å¤‡ç¯å¢ƒ"></a>4.2 å‡†å¤‡ç¯å¢ƒ</h2><p>1ï¸âƒ£é¦–å…ˆåœ¨minioé…ç½®bucketï¼Œbucketåç§°ä¸ºï¼šmediafilesï¼Œå¹¶è®¾ç½®bucketçš„æƒé™ä¸ºå…¬å¼€ã€‚</p><p>2ï¸âƒ£åœ¨nacosé…ç½®ä¸­minioçš„ç›¸å…³ä¿¡æ¯ï¼Œè¿›å…¥media-service-dev.yaml:</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">minio:</span></span><br><span class="line">  <span class="attr">endpoint:</span> <span class="string">http://192.168.101.65:9000</span></span><br><span class="line">  <span class="attr">accessKey:</span> <span class="string">minioadmin</span></span><br><span class="line">  <span class="attr">secretKey:</span> <span class="string">minioadmin</span></span><br><span class="line">  <span class="attr">bucket:</span></span><br><span class="line">    <span class="attr">files:</span> <span class="string">mediafiles</span></span><br><span class="line">    <span class="attr">videofiles:</span> <span class="string">video</span></span><br></pre></td></tr></table></figure><p>3ï¸âƒ£åœ¨media-serviceå·¥ç¨‹ç¼–å†™minioçš„é…ç½®ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.media.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.minio.MinioClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> v1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> TODO</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/6/7 19:59</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MinioConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;minio.endpoint&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String endpoint;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;minio.accessKey&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String accessKey;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;minio.secretKey&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String secretKey;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MinioClient <span class="title function_">minioClient</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">MinioClient</span> <span class="variable">minioClient</span> <span class="operator">=</span></span><br><span class="line">                MinioClient.builder()</span><br><span class="line">                        .endpoint(endpoint)</span><br><span class="line">                        .credentials(accessKey, secretKey)</span><br><span class="line">                        .build();</span><br><span class="line">        <span class="keyword">return</span> minioClient;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-3-æ¥å£å®šä¹‰"><a href="#4-3-æ¥å£å®šä¹‰" class="headerlink" title="4.3 æ¥å£å®šä¹‰"></a>4.3 æ¥å£å®šä¹‰</h2><p>æ ¹æ®éœ€æ±‚åˆ†æï¼Œä¸‹è¾¹è¿›è¡Œæ¥å£å®šä¹‰ï¼Œæ­¤æ¥å£å®šä¹‰ä¸ºä¸€ä¸ªé€šç”¨çš„ä¸Šä¼ æ–‡ä»¶æ¥å£ï¼Œå¯ä»¥ä¸Šä¼ å›¾ç‰‡æˆ–å…¶å®ƒæ–‡ä»¶ã€‚</p><p>1ï¸âƒ£é¦–å…ˆåˆ†ææ¥å£ï¼š</p><ul><li><p>è¯·æ±‚åœ°å€ï¼š/media/upload/coursefile</p></li><li><p>è¯·æ±‚å†…å®¹ï¼š<strong>Content-Type:</strong> multipart/form-data;</p></li><li><p>form-data; name=â€filedataâ€; filename=â€å…·ä½“çš„æ–‡ä»¶åç§°â€</p><p>å“åº”å‚æ•°ï¼šæ–‡ä»¶ä¿¡æ¯ï¼Œå¦‚ä¸‹</p></li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;a16da7a132559daf9e1193166b3e7f52&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;companyId&quot;</span><span class="punctuation">:</span> <span class="number">1232141425</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;companyName&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;filename&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;fileType&quot;</span><span class="punctuation">:</span> <span class="string">&quot;001001&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;tags&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;bucket&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/testbucket/2022/09/12/a16da7a132559daf9e1193166b3e7f52.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;fileId&quot;</span><span class="punctuation">:</span> <span class="string">&quot;a16da7a132559daf9e1193166b3e7f52&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/testbucket/2022/09/12/a16da7a132559daf9e1193166b3e7f52.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;timelength&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;createDate&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2022-09-12T21:57:18&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;changeDate&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;remark&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;auditStatus&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;auditMind&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;fileSize&quot;</span><span class="punctuation">:</span> <span class="number">248329</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>2ï¸âƒ£å®šä¹‰ä¸Šä¼ å“åº”æ¨¡å‹ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.media.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.xuecheng.media.model.po.MediaFiles;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> v1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> TODO</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/6/7 20:06</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UploadFileResultDto</span> <span class="keyword">extends</span> <span class="title class_">MediaFiles</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3ï¸âƒ£å®šä¹‰æ¥å£å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;ä¸Šä¼ å›¾ç‰‡&quot;)</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;/upload/coursefile&quot;, consumes = MediaType.MULTIPART_FORM_DATA_VALUE)</span></span><br><span class="line"><span class="keyword">public</span> UploadFileResultDto <span class="title function_">upload</span><span class="params">(<span class="meta">@RequestPart(&quot;filedata&quot;)</span>MultipartFile filedata)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4ï¸âƒ£æ¥å£å®šä¹‰å¥½åå¯ä»¥ç”¨httpclientå·¥å…·æµ‹è¯•ä¸€ä¸‹</p><ul><li>ä½¿ç”¨httpclientæµ‹è¯•</li></ul><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">### ä¸Šä¼ æ–‡ä»¶</span><br><span class="line">POST &#123;&#123;media_host&#125;&#125;/media/upload/coursefile</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=WebAppBoundary</span><br><span class="line"></span><br><span class="line">--WebAppBoundary</span><br><span class="line"><span class="attribute">Content-Disposition</span><span class="punctuation">: </span>form-data; name=&quot;filedata&quot;; filename=&quot;1.jpg&quot;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/octet-stream</span><br><span class="line"></span><br><span class="line">&lt; d:/develop/upload/1.jpg</span><br></pre></td></tr></table></figure><h2 id="4-4-æ¥å£å¼€å‘"><a href="#4-4-æ¥å£å¼€å‘" class="headerlink" title="4.4 æ¥å£å¼€å‘"></a>4.4 æ¥å£å¼€å‘</h2><h3 id="4-4-1-DAO-å¼€å‘"><a href="#4-4-1-DAO-å¼€å‘" class="headerlink" title="4.4.1 DAO å¼€å‘"></a>4.4.1 DAO å¼€å‘</h3><p>æ ¹æ®éœ€æ±‚åˆ†æDAOå±‚å®ç°å‘media_filesè¡¨æ’å…¥ä¸€æ¡è®°å½•ï¼Œä½¿ç”¨media_filesè¡¨ç”Ÿæˆçš„mapperå³å¯ã€‚</p><h3 id="4-4-2-Service-å¼€å‘"><a href="#4-4-2-Service-å¼€å‘" class="headerlink" title="4.4.2 Service å¼€å‘"></a>4.4.2 Service å¼€å‘</h3><p>Serviceæ–¹æ³•éœ€è¦æä¾›ä¸€ä¸ªæ›´åŠ é€šç”¨çš„ä¿å­˜æ–‡ä»¶çš„æ–¹æ³•ã€‚</p><p>1ï¸âƒ£å®šä¹‰è¯·æ±‚å‚æ•°ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.media.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> v1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ–‡ä»¶ä¿¡æ¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/6/7 20:09</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UploadFileParamsDto</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–‡ä»¶åç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String filename;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–‡ä»¶ç±»å‹ï¼ˆæ–‡æ¡£ï¼ŒéŸ³é¢‘ï¼Œè§†é¢‘ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String fileType;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–‡ä»¶å¤§å°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long fileSize;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ‡ç­¾</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String tags;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸Šä¼ äºº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¤‡æ³¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String remark;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ï¸âƒ£å®šä¹‰serviceæ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> companyId æœºæ„id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> uploadFileParamsDto æ–‡ä»¶ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> localFilePath æ–‡ä»¶æœ¬åœ°è·¯å¾„</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> UploadFileResultDto</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">UploadFileResultDto <span class="title function_">upload</span><span class="params">(Long companyId, UploadFileParamsDto uploadFileParamsDto, String localFilePath)</span>;</span><br></pre></td></tr></table></figure><p>3ï¸âƒ£å®ç°æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.media.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Mr.M</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> TODO</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/9/10 8:58</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MediaFileServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">MediaFileService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> MediaFilesMapper mediaFilesMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> MinioClient minioClient;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> MediaFileService currentProxy;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å­˜å‚¨æ™®é€šæ–‡ä»¶</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;minio.bucket.files&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String bucket_mediafiles;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å­˜å‚¨è§†é¢‘</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;minio.bucket.videofiles&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String bucket_video;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> PageResult&lt;MediaFiles&gt; <span class="title function_">queryMediaFiels</span><span class="params">(Long companyId, PageParams pageParams, QueryMediaParamsDto queryMediaParamsDto)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ„å»ºæŸ¥è¯¢æ¡ä»¶å¯¹è±¡</span></span><br><span class="line">        LambdaQueryWrapper&lt;MediaFiles&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ†é¡µå¯¹è±¡</span></span><br><span class="line">        Page&lt;MediaFiles&gt; page = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(pageParams.getPageNo(), pageParams.getPageSize());</span><br><span class="line">        <span class="comment">// æŸ¥è¯¢æ•°æ®å†…å®¹è·å¾—ç»“æœ</span></span><br><span class="line">        Page&lt;MediaFiles&gt; pageResult = mediaFilesMapper.selectPage(page, queryWrapper);</span><br><span class="line">        <span class="comment">// è·å–æ•°æ®åˆ—è¡¨</span></span><br><span class="line">        List&lt;MediaFiles&gt; list = pageResult.getRecords();</span><br><span class="line">        <span class="comment">// è·å–æ•°æ®æ€»æ•°</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">total</span> <span class="operator">=</span> pageResult.getTotal();</span><br><span class="line">        <span class="comment">// æ„å»ºç»“æœé›†</span></span><br><span class="line">        PageResult&lt;MediaFiles&gt; mediaListResult = <span class="keyword">new</span> <span class="title class_">PageResult</span>&lt;&gt;(list, total, pageParams.getPageNo(), pageParams.getPageSize());</span><br><span class="line">        <span class="keyword">return</span> mediaListResult;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> UploadFileResultDto <span class="title function_">upload</span><span class="params">(Long companyId, UploadFileParamsDto uploadFileParamsDto, String localFilePath)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ–‡ä»¶å</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">filename</span> <span class="operator">=</span> uploadFileParamsDto.getFilename();</span><br><span class="line">        <span class="comment">// æ‹“å±•å</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">extension</span> <span class="operator">=</span> filename.substring(filename.lastIndexOf(<span class="string">&quot;.&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">mimeType</span> <span class="operator">=</span> getMimeType(extension);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ–‡ä»¶ç›®å½•</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">defaultFolderPath</span> <span class="operator">=</span> getDefaultFolderPath();</span><br><span class="line">        <span class="comment">// æ–‡ä»¶çš„md5å€¼</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">fileMd5</span> <span class="operator">=</span> getFileMd5(<span class="keyword">new</span> <span class="title class_">File</span>(localFilePath));</span><br><span class="line">        <span class="type">String</span> <span class="variable">objectName</span> <span class="operator">=</span> defaultFolderPath + fileMd5 + extension;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°†æ–‡ä»¶ä¸Šä¼ åˆ°minio</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> addMediaFilesToMinIO(localFilePath, mimeType, bucket_mediafiles, objectName);</span><br><span class="line">        <span class="keyword">if</span>(!result) &#123;</span><br><span class="line">            XueChengPlusException.cast(<span class="string">&quot;ä¸Šä¼ æ–‡ä»¶å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span> æ ¡éªŒæ–‡ä»¶ä¸Šä¼ æ˜¯å¦å®Œæ•´</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°†æ–‡ä»¶ä¿¡æ¯ä¿å­˜åˆ°æ•°æ®åº“</span></span><br><span class="line">        <span class="type">MediaFiles</span> <span class="variable">mediaFiles</span> <span class="operator">=</span> currentProxy.addMediaFilesToDb(companyId, fileMd5, uploadFileParamsDto, bucket_mediafiles, objectName);</span><br><span class="line">        <span class="keyword">if</span>(mediaFiles == <span class="literal">null</span>) &#123;</span><br><span class="line">            XueChengPlusException.cast(<span class="string">&quot;æ–‡ä»¶ä¸Šä¼ åä¿å­˜ä¿¡æ¯å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å‡†å¤‡è¿”å›å¯¹è±¡</span></span><br><span class="line">        <span class="type">UploadFileResultDto</span> <span class="variable">uploadFileResultDto</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UploadFileResultDto</span>();</span><br><span class="line">        BeanUtils.copyProperties(mediaFiles, uploadFileResultDto);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> uploadFileResultDto;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@description</span> å°†æ–‡ä»¶ä¿¡æ¯æ·»åŠ åˆ°æ–‡ä»¶è¡¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> companyId  æœºæ„id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fileMd5  æ–‡ä»¶md5å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> uploadFileParamsDto  ä¸Šä¼ æ–‡ä»¶çš„ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bucket  æ¡¶</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> objectName å¯¹è±¡åç§°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> com.xuecheng.media.model.po.MediaFiles</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@author</span> Mr.M</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@date</span> 2022/10/12 21:22</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> MediaFiles <span class="title function_">addMediaFilesToDb</span><span class="params">(Long companyId, String fileMd5, UploadFileParamsDto uploadFileParamsDto, String bucket, String objectName)</span> &#123;</span><br><span class="line">        <span class="type">MediaFiles</span> <span class="variable">mediaFiles</span> <span class="operator">=</span> mediaFilesMapper.selectById(fileMd5);</span><br><span class="line">        <span class="keyword">if</span>(mediaFiles == <span class="literal">null</span>) &#123;</span><br><span class="line">            mediaFiles = <span class="keyword">new</span> <span class="title class_">MediaFiles</span>();</span><br><span class="line">            BeanUtils.copyProperties(uploadFileParamsDto, mediaFiles);</span><br><span class="line">            <span class="comment">// æ–‡ä»¶id</span></span><br><span class="line">            mediaFiles.setId(fileMd5);</span><br><span class="line">            <span class="comment">// æœºæ„id</span></span><br><span class="line">            mediaFiles.setCompanyId(companyId);</span><br><span class="line">            <span class="comment">// æ¡¶</span></span><br><span class="line">            mediaFiles.setBucket(bucket);</span><br><span class="line">            <span class="comment">// file_path</span></span><br><span class="line">            mediaFiles.setFilePath(objectName);</span><br><span class="line">            <span class="comment">// file_id</span></span><br><span class="line">            mediaFiles.setFileId(fileMd5);</span><br><span class="line">            <span class="comment">// url</span></span><br><span class="line">            mediaFiles.setUrl(<span class="string">&quot;/&quot;</span> + bucket + <span class="string">&quot;/&quot;</span> + objectName);</span><br><span class="line">            <span class="comment">// ä¸Šä¼ æ—¶é—´</span></span><br><span class="line">            mediaFiles.setCreateDate(LocalDateTime.now());</span><br><span class="line">            <span class="comment">// çŠ¶æ€</span></span><br><span class="line">            mediaFiles.setStatus(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">            <span class="comment">// å®¡æ ¸çŠ¶æ€</span></span><br><span class="line">            mediaFiles.setAuditStatus(<span class="string">&quot;002003&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ’å…¥æ•°æ®åº“</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">insert</span> <span class="operator">=</span> mediaFilesMapper.insert(mediaFiles);</span><br><span class="line">            <span class="keyword">if</span>(insert &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">                log.debug(<span class="string">&quot;å‘æ•°æ®åº“ä¿å­˜æ–‡ä»¶å¤±è´¥, bucket:&#123;&#125;, objectName:&#123;&#125;,&quot;</span>, bucket, objectName);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> mediaFiles;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> mediaFiles;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è·å–æ–‡ä»¶çš„ md5 å€¼</span></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">getFileMd5</span><span class="params">(File file)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span>(<span class="type">FileInputStream</span> <span class="variable">fileInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file)) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">fileMd5</span> <span class="operator">=</span> DigestUtils.md5Hex(fileInputStream);</span><br><span class="line">            <span class="keyword">return</span> fileMd5;</span><br><span class="line">        &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–å½“å‰æ—¶é—´å¹¶è½¬æ¢ä¸º 2023/03/03/</span></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">getDefaultFolderPath</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">SimpleDateFormat</span> <span class="variable">sdf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy-MM-dd&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">folder</span> <span class="operator">=</span> sdf.format(<span class="keyword">new</span> <span class="title class_">Date</span>()).replace(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;/&quot;</span>) + <span class="string">&quot;/&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> folder;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®²æ–‡ä»¶ä¸Šä¼ åˆ° miniIO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> localFilePath æ–‡ä»¶æœ¬åœ°è·¯å¾„</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> mimeType åª’ä½“ç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bucket æ¡¶</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> objectName å¯¹è±¡å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> boolean</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">addMediaFilesToMinIO</span><span class="params">(String localFilePath, String mimeType, String bucket, String objectName)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">UploadObjectArgs</span> <span class="variable">uploadObjectArgs</span> <span class="operator">=</span> UploadObjectArgs.builder()</span><br><span class="line">                    .bucket(bucket)</span><br><span class="line">                    .filename(localFilePath)</span><br><span class="line">                    .object(objectName)</span><br><span class="line">                    .contentType(mimeType)</span><br><span class="line">                    .build();</span><br><span class="line">            <span class="comment">// ä¸Šä¼ æ–‡ä»¶</span></span><br><span class="line">            minioClient.uploadObject(uploadObjectArgs);</span><br><span class="line">            log.debug(<span class="string">&quot;ä¸Šä¼ æ–‡ä»¶åˆ°minioæˆåŠŸbucket:&#123;&#125;, objectName:&#123;&#125;,&quot;</span>, bucket, objectName);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            log.error(<span class="string">&quot;ä¸Šä¼ æ–‡ä»¶å‡ºé”™, bucket:&#123;&#125;, objectName:&#123;&#125;, é”™è¯¯ä¿¡æ¯:&#123;&#125;&quot;</span>, bucket, objectName, e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">getMimeType</span><span class="params">(String extension)</span> &#123;</span><br><span class="line">        <span class="type">ContentInfo</span> <span class="variable">extensionMatch</span> <span class="operator">=</span> ContentInfoUtil.findExtensionMatch(extension);</span><br><span class="line">        <span class="type">String</span> <span class="variable">mimeType</span> <span class="operator">=</span> MediaType.APPLICATION_OCTET_STREAM_VALUE;</span><br><span class="line">        <span class="keyword">if</span>(extensionMatch != <span class="literal">null</span>) &#123;</span><br><span class="line">            mimeType = extensionMatch.getMimeType();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> mimeType;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-4-3-å®Œå–„æ¥å£å±‚"><a href="#4-4-3-å®Œå–„æ¥å£å±‚" class="headerlink" title="4.4.3 å®Œå–„æ¥å£å±‚"></a>4.4.3 å®Œå–„æ¥å£å±‚</h3><p>å®Œå–„æ¥å£å±‚ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;ä¸Šä¼ å›¾ç‰‡&quot;)</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;/upload/coursefile&quot;, consumes = MediaType.MULTIPART_FORM_DATA_VALUE)</span></span><br><span class="line"><span class="keyword">public</span> UploadFileResultDto <span class="title function_">upload</span><span class="params">(<span class="meta">@RequestPart(&quot;filedata&quot;)</span>MultipartFile filedata)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="comment">// æœºæ„id</span></span><br><span class="line">    <span class="type">Long</span> <span class="variable">companyId</span> <span class="operator">=</span> <span class="number">1232141425L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‡†å¤‡ä¸Šä¼ æ–‡ä»¶çš„ä¿¡æ¯</span></span><br><span class="line">    <span class="type">UploadFileParamsDto</span> <span class="variable">uploadFileParamsDto</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UploadFileParamsDto</span>();</span><br><span class="line">    <span class="comment">// åŸå§‹æ–‡ä»¶åç§°</span></span><br><span class="line">    uploadFileParamsDto.setFilename(filedata.getOriginalFilename());</span><br><span class="line">    <span class="comment">// æ–‡ä»¶å¤§å°</span></span><br><span class="line">    uploadFileParamsDto.setFileSize(filedata.getSize());</span><br><span class="line">    <span class="comment">// æ–‡ä»¶ç±»å‹</span></span><br><span class="line">    uploadFileParamsDto.setFileType(<span class="string">&quot;001001&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¥æ”¶åˆ°æ–‡ä»¶äº†</span></span><br><span class="line">    <span class="type">File</span> <span class="variable">tempFile</span> <span class="operator">=</span> File.createTempFile(<span class="string">&quot;minio&quot;</span>, <span class="string">&quot;.temp&quot;</span>);</span><br><span class="line">    filedata.transferTo(tempFile);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">localFilePath</span> <span class="operator">=</span> tempFile.getAbsolutePath();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨ service ä¸Šä¼ å›¾ç‰‡</span></span><br><span class="line">    <span class="type">UploadFileResultDto</span> <span class="variable">uploadFileResultDto</span> <span class="operator">=</span> mediaFileService.upload(companyId, uploadFileParamsDto, localFilePath);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> uploadFileResultDto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-4-4-æ¥å£æµ‹è¯•"><a href="#4-4-4-æ¥å£æµ‹è¯•" class="headerlink" title="4.4.4 æ¥å£æµ‹è¯•"></a>4.4.4 æ¥å£æµ‹è¯•</h3><p>1ï¸âƒ£é¦–å…ˆä½¿ç”¨httpclientæµ‹è¯•</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">### ä¸Šä¼ æ–‡ä»¶</span><br><span class="line">POST &#123;&#123;media_host&#125;&#125;/media/upload/coursefile</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=WebAppBoundary</span><br><span class="line"></span><br><span class="line">--WebAppBoundary</span><br><span class="line"><span class="attribute">Content-Disposition</span><span class="punctuation">: </span>form-data; name=&quot;filedata&quot;; filename=&quot;1.jpg&quot;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/octet-stream</span><br><span class="line"></span><br><span class="line">&lt; d:/develop/upload/1.jpg</span><br></pre></td></tr></table></figure><p>2ï¸âƒ£å†è¿›è¡Œå‰åç«¯è”è°ƒæµ‹è¯•</p><ul><li>åœ¨æ–°å¢è¯¾ç¨‹ã€ç¼–è¾‘è¯¾ç¨‹ç•Œé¢ä¸Šä¼ å›¾ï¼Œä¿å­˜è¯¾ç¨‹ä¿¡æ¯åå†æ¬¡è¿›å…¥ç¼–è¾‘è¯¾ç¨‹ç•Œé¢ï¼ŒæŸ¥çœ‹æ˜¯å¦å¯ä»¥æ­£å¸¸ä¿å­˜è¯¾ç¨‹å›¾ç‰‡ä¿¡æ¯ã€‚</li></ul><p><img src="./assets/image-20230607220122805.png" alt="image-20230607220122805" style="zoom:50%;" /> </p><ul><li>ä¸Šå›¾å›¾ç‰‡å®Œæˆåï¼Œè¿›å…¥åª’èµ„ç®¡ç†ï¼ŒæŸ¥çœ‹æ–‡ä»¶åˆ—è¡¨ä¸­æ˜¯å¦æœ‰åˆšåˆšä¸Šä¼ çš„å›¾ç‰‡ä¿¡æ¯ã€‚</li></ul><h3 id="4-4-5-Service-äº‹åŠ¡ä¼˜åŒ–"><a href="#4-4-5-Service-äº‹åŠ¡ä¼˜åŒ–" class="headerlink" title="4.4.5 Service äº‹åŠ¡ä¼˜åŒ–"></a>4.4.5 Service äº‹åŠ¡ä¼˜åŒ–</h3><p>ä¸Šè¾¹çš„serviceæ–¹æ³•ä¼˜åŒ–åå¹¶æµ‹è¯•é€šè¿‡ï¼Œç°åœ¨æ€è€ƒ==å…³äºuploadFileæ–¹æ³•çš„æ˜¯å¦åº”è¯¥å¼€å¯äº‹åŠ¡==ã€‚</p><p>1ï¸âƒ£ç›®å‰æ˜¯åœ¨uploadFileæ–¹æ³•ä¸Šæ·»åŠ @Transactionalï¼Œå½“è°ƒç”¨uploadFileæ–¹æ³•å‰ä¼šå¼€å¯æ•°æ®åº“äº‹åŠ¡ï¼Œ</p><ul><li>å¦‚æœä¸Šä¼ æ–‡ä»¶è¿‡ç¨‹æ—¶é—´è¾ƒé•¿é‚£ä¹ˆæ•°æ®åº“çš„äº‹åŠ¡æŒç»­æ—¶é—´å°±ä¼šå˜é•¿ï¼Œ</li><li>è¿™æ ·æ•°æ®åº“é“¾æ¥é‡Šæ”¾å°±æ…¢ï¼Œæœ€ç»ˆå¯¼è‡´æ•°æ®åº“é“¾æ¥ä¸å¤Ÿç”¨ã€‚</li></ul><p>æˆ‘ä»¬åªå°†addMediaFilesToDbæ–¹æ³•æ·»åŠ äº‹åŠ¡æ§åˆ¶å³å¯ï¼ŒuploadFileæ–¹æ³•ä¸Šçš„@Transactionalæ³¨è§£å»æ‰ã€‚</p><ul><li>ä¼˜åŒ–åå¦‚ä¸‹ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">public</span> MediaFiles <span class="title function_">addMediaFilesToDb</span><span class="params">(Long companyId,String fileMd5,UploadFileParamsDto uploadFileParamsDto,String bucket,String objectName)</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä»æ•°æ®åº“æŸ¥è¯¢æ–‡ä»¶</span></span><br><span class="line">    <span class="type">MediaFiles</span> <span class="variable">mediaFiles</span> <span class="operator">=</span> mediaFilesMapper.selectById(fileMd5);</span><br><span class="line">    <span class="keyword">if</span> (mediaFiles == <span class="literal">null</span>) &#123;</span><br><span class="line">        mediaFiles = <span class="keyword">new</span> <span class="title class_">MediaFiles</span>();</span><br><span class="line">        <span class="comment">//æ‹·è´åŸºæœ¬ä¿¡æ¯</span></span><br><span class="line">        BeanUtils.copyProperties(uploadFileParamsDto, mediaFiles);</span><br><span class="line">        mediaFiles.setId(fileMd5);</span><br><span class="line">        mediaFiles.setFileId(fileMd5);</span><br><span class="line">        mediaFiles.setCompanyId(companyId);</span><br><span class="line">        mediaFiles.setUrl(<span class="string">&quot;/&quot;</span> + bucket + <span class="string">&quot;/&quot;</span> + objectName);</span><br><span class="line">        mediaFiles.setBucket(bucket);</span><br><span class="line">        mediaFiles.setFilePath(objectName);</span><br><span class="line">        mediaFiles.setCreateDate(LocalDateTime.now());</span><br><span class="line">        mediaFiles.setAuditStatus(<span class="string">&quot;002003&quot;</span>);</span><br><span class="line">        mediaFiles.setStatus(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">        <span class="comment">//ä¿å­˜æ–‡ä»¶ä¿¡æ¯åˆ°æ–‡ä»¶è¡¨</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">insert</span> <span class="operator">=</span> mediaFilesMapper.insert(mediaFiles);</span><br><span class="line">        <span class="keyword">if</span> (insert &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;ä¿å­˜æ–‡ä»¶ä¿¡æ¯åˆ°æ•°æ®åº“å¤±è´¥,&#123;&#125;&quot;</span>,mediaFiles.toString());</span><br><span class="line">            XueChengPlusException.cast(<span class="string">&quot;ä¿å­˜æ–‡ä»¶ä¿¡æ¯å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        log.debug(<span class="string">&quot;ä¿å­˜æ–‡ä»¶ä¿¡æ¯åˆ°æ•°æ®åº“æˆåŠŸ,&#123;&#125;&quot;</span>,mediaFiles.toString());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> mediaFiles;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ï¸âƒ£æˆ‘ä»¬äººä¸ºåœ¨ int insert = mediaFilesMapper.insert(mediaFiles);ä¸‹è¾¹æ·»åŠ ä¸€ä¸ª==å¼‚å¸¸ä»£ç int a=1/0==;</p><ul><li>æµ‹è¯•æ˜¯å¦äº‹åŠ¡æ§åˆ¶ã€‚å¾ˆé—æ†¾ï¼Œäº‹åŠ¡æ§åˆ¶å¤±è´¥ã€‚</li></ul><p>æ–¹æ³•ä¸Šå·²ç»æ·»åŠ äº†@Transactionalæ³¨è§£ä¸ºä»€ä¹ˆè¯¥æ–¹æ³•ä¸èƒ½è¢«äº‹åŠ¡æ§åˆ¶å‘¢ï¼Ÿ</p><ul><li>å¦‚æœæ˜¯åœ¨uploadFileæ–¹æ³•ä¸Šæ·»åŠ @Transactionalæ³¨è§£å°±å¯ä»¥æ§åˆ¶äº‹åŠ¡ï¼Œå»æ‰åˆ™ä¸è¡Œã€‚</li></ul><p>ç°åœ¨çš„é—®é¢˜å…¶å®æ˜¯ä¸€ä¸ªéäº‹åŠ¡æ–¹æ³•è°ƒåŒç±»ä¸€ä¸ªäº‹åŠ¡æ–¹æ³•ï¼Œäº‹åŠ¡æ— æ³•æ§åˆ¶ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ</p><p>3ï¸âƒ£ä¸‹è¾¹åˆ†æåŸå› ï¼š</p><ul><li>å¦‚æœåœ¨uploadFileæ–¹æ³•ä¸Šæ·»åŠ @Transactionalæ³¨è§£ï¼Œä»£ç†å¯¹è±¡æ‰§è¡Œæ­¤æ–¹æ³•å‰ä¼šå¼€å¯äº‹åŠ¡ï¼Œå¦‚ä¸‹å›¾ï¼š</li></ul><p><img src="./assets/wps5-1686146674786-12.jpg" alt="img" style="zoom:50%;" /> </p><ul><li>å¦‚æœåœ¨uploadFileæ–¹æ³•ä¸Šæ²¡æœ‰@Transactionalæ³¨è§£ï¼Œä»£ç†å¯¹è±¡æ‰§è¡Œæ­¤æ–¹æ³•å‰ä¸è¿›è¡Œäº‹åŠ¡æ§åˆ¶ï¼Œå¦‚ä¸‹å›¾ï¼š</li></ul><p><img src="./assets/wps6-1686146674786-13.jpg" alt="img" style="zoom:50%;" /> </p><ul><li>æ‰€ä»¥åˆ¤æ–­è¯¥æ–¹æ³•æ˜¯å¦å¯ä»¥äº‹åŠ¡æ§åˆ¶å¿…é¡»ä¿è¯æ˜¯==é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨æ­¤æ–¹æ³•ï¼Œä¸”æ­¤æ–¹æ³•ä¸Šæ·»åŠ äº†@Transactionalæ³¨è§£==ã€‚</li></ul><p>ç°åœ¨åœ¨addMediaFilesToDbæ–¹æ³•ä¸Šæ·»åŠ @Transactionalæ³¨è§£ï¼Œ</p><ul><li>ä¹Ÿä¸ä¼šè¿›è¡Œäº‹åŠ¡æ§åˆ¶æ˜¯å› ä¸ºå¹¶ä¸æ˜¯é€šè¿‡ä»£ç†å¯¹è±¡æ‰§è¡Œçš„addMediaFilesToDbæ–¹æ³•ã€‚</li><li>ä¸ºäº†åˆ¤æ–­åœ¨uploadFileæ–¹æ³•ä¸­å»è°ƒç”¨addMediaFilesToDbæ–¹æ³•æ˜¯å¦æ˜¯é€šè¿‡ä»£ç†å¯¹è±¡å»è°ƒç”¨ï¼Œæˆ‘ä»¬å¯ä»¥æ‰“æ–­ç‚¹è·Ÿè¸ªã€‚</li></ul><p><img src="./assets/wps7-1686146674787-14.jpg" alt="img"> </p><ul><li>æˆ‘ä»¬å‘ç°åœ¨uploadFileæ–¹æ³•ä¸­å»è°ƒç”¨addMediaFilesToDbæ–¹æ³•ä¸æ˜¯é€šè¿‡ä»£ç†å¯¹è±¡å»è°ƒç”¨ã€‚</li></ul><p>4ï¸âƒ£å¦‚ä½•è§£å†³å‘¢ï¼Ÿé€šè¿‡ä»£ç†å¯¹è±¡å»è°ƒç”¨addMediaFilesToDbæ–¹æ³•å³å¯è§£å†³ã€‚</p><ol><li>åœ¨MediaFileServiceçš„å®ç°ç±»ä¸­æ³¨å…¥MediaFileServiceçš„ä»£ç†å¯¹è±¡ï¼Œå¦‚ä¸‹ï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Resource</span></span><br><span class="line"><span class="keyword">private</span> MediaFileService currentProxy;</span><br></pre></td></tr></table></figure><ol><li>å°†addMediaFilesToDbæ–¹æ³•ææˆæ¥å£ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å°†æ–‡ä»¶ä¿¡æ¯æ·»åŠ åˆ°æ–‡ä»¶è¡¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> companyId  æœºæ„id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> fileMd5  æ–‡ä»¶md5å€¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> uploadFileParamsDto  ä¸Šä¼ æ–‡ä»¶çš„ä¿¡æ¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> bucket  æ¡¶</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> objectName å¯¹è±¡åç§°</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> com.xuecheng.media.model.po.MediaFiles</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/06/07 21:22</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">MediaFiles <span class="title function_">addMediaFilesToDb</span><span class="params">(Long companyId,String fileMd5,UploadFileParamsDto uploadFileParamsDto,String bucket,String objectName)</span>;</span><br></pre></td></tr></table></figure><ol><li>è°ƒç”¨addMediaFilesToDbæ–¹æ³•çš„ä»£ç å¤„æ”¹ä¸ºå¦‚ä¸‹ï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.....</span><br><span class="line"><span class="comment">//å†™å…¥æ–‡ä»¶è¡¨</span></span><br><span class="line"><span class="type">MediaFiles</span> <span class="variable">mediaFiles</span> <span class="operator">=</span> currentProxy.addMediaFilesToDb(companyId, fileMd5, uploadFileParamsDto, bucket_files, objectName);</span><br><span class="line"> ....</span><br></pre></td></tr></table></figure><p>5ï¸âƒ£å†æ¬¡æµ‹è¯•äº‹åŠ¡æ˜¯å¦å¯ä»¥æ­£å¸¸æ§åˆ¶ã€‚</p>]]></content>
    
    
    <summary type="html">ç¬¬ä¸‰ç«  åª’èµ„ç®¡ç†æ¨¡å—</summary>
    
    
    
    <category term="é¡¹ç›®" scheme="https://www.taoyaopc.live/categories/%E9%A1%B9%E7%9B%AE/"/>
    
    
    <category term="Java" scheme="https://www.taoyaopc.live/tags/Java/"/>
    
    <category term="Spring" scheme="https://www.taoyaopc.live/tags/Spring/"/>
    
    <category term="SpringCloud" scheme="https://www.taoyaopc.live/tags/SpringCloud/"/>
    
  </entry>
  
  <entry>
    <title>å†…å®¹ç®¡ç†æ¨¡å—</title>
    <link href="https://www.taoyaopc.live/posts/58d4e84e.html"/>
    <id>https://www.taoyaopc.live/posts/58d4e84e.html</id>
    <published>2023-06-28T16:00:00.000Z</published>
    <updated>2023-07-07T03:19:51.315Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-æ¨¡å—éœ€æ±‚åˆ†æ"><a href="#1-æ¨¡å—éœ€æ±‚åˆ†æ" class="headerlink" title="1. æ¨¡å—éœ€æ±‚åˆ†æ"></a>1. æ¨¡å—éœ€æ±‚åˆ†æ</h1><h2 id="1-1-ä»€ä¹ˆæ˜¯éœ€æ±‚åˆ†æ"><a href="#1-1-ä»€ä¹ˆæ˜¯éœ€æ±‚åˆ†æ" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯éœ€æ±‚åˆ†æ"></a>1.1 ä»€ä¹ˆæ˜¯éœ€æ±‚åˆ†æ</h2><blockquote><p>åœ¨ç™¾åº¦ç™¾ç§‘ä¸­å¯¹éœ€æ±‚åˆ†æçš„å®šä¹‰å¦‚ä¸‹ï¼š</p><ul><li><p>éœ€æ±‚åˆ†æä¹Ÿç§°ä¸ºè½¯ä»¶éœ€æ±‚åˆ†æã€ç³»ç»Ÿéœ€æ±‚åˆ†ææˆ–éœ€æ±‚åˆ†æå·¥ç¨‹ç­‰ï¼Œæ˜¯å¼€å‘äººå‘˜ç»è¿‡æ·±å…¥ç»†è‡´çš„è°ƒç ”å’Œåˆ†æï¼Œå‡†ç¡®ç†è§£ç”¨æˆ·å’Œé¡¹ç›®çš„åŠŸèƒ½ã€æ€§èƒ½ã€å¯é æ€§ç­‰å…·ä½“è¦æ±‚ï¼Œå°†ç”¨æˆ·éå½¢å¼çš„éœ€æ±‚è¡¨è¿°è½¬åŒ–ä¸ºå®Œæ•´çš„éœ€æ±‚å®šä¹‰ï¼Œä»è€Œç¡®å®šç³»ç»Ÿå¿…é¡»åšä»€ä¹ˆçš„è¿‡ç¨‹ã€‚</p></li><li><p>ç®€å•ç†è§£å°±æ˜¯è¦ææ¸…æ¥šé—®é¢˜åŸŸï¼Œé—®é¢˜åŸŸå°±æ˜¯ç”¨æˆ·çš„éœ€æ±‚ï¼Œè½¯ä»¶è¦ä¸ºç”¨æˆ·è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Œå®ç°å“ªäº›ä¸šåŠ¡åŠŸèƒ½ï¼Œæ»¡è¶³ä»€ä¹ˆæ ·çš„æ€§èƒ½è¦æ±‚ã€‚</p></li></ul></blockquote><h3 id="1-1-1-å¦‚ä½•ä½œéœ€æ±‚åˆ†æï¼Ÿ"><a href="#1-1-1-å¦‚ä½•ä½œéœ€æ±‚åˆ†æï¼Ÿ" class="headerlink" title="1.1.1 å¦‚ä½•ä½œéœ€æ±‚åˆ†æï¼Ÿ"></a>1.1.1 å¦‚ä½•ä½œéœ€æ±‚åˆ†æï¼Ÿ</h3><p><strong>ç¬¬ä¸€ï¼šé¦–å…ˆç¡®è®¤ç”¨æˆ·éœ€æ±‚</strong></p><ul><li><p>ç”¨æˆ·éœ€æ±‚å³ç”¨æˆ·çš„åŸå§‹éœ€æ±‚ã€‚</p></li><li><p>é€šè¿‡ç”¨æˆ·è®¿è°ˆã€é—®å·è°ƒæŸ¥ã€å¼€ä¼šè®¨è®ºã€æŸ¥é˜…èµ„æ–™ç­‰è°ƒç ”æ‰‹æ®µæ¢³ç†ç”¨æˆ·çš„åŸå§‹éœ€æ±‚ã€‚</p></li><li><p>äº§å“äººå‘˜æ ¹æ®ç”¨æˆ·éœ€æ±‚ä¼šç»˜åˆ¶ç•Œé¢åŸå‹ï¼Œé€šè¿‡ç•Œé¢åŸå‹å†å’Œç”¨æˆ·ç¡®è®¤éœ€æ±‚ã€‚</p></li></ul><p><strong>ç¬¬äºŒï¼šç¡®è®¤å…³é”®é—®é¢˜</strong></p><p>ç”¨æˆ·çš„åŸå§‹éœ€æ±‚å¯èƒ½ æ˜¯å«ç³Šä¸æ¸…çš„ï¼Œéœ€æ±‚åˆ†æè¦ä»ç¹æ‚çš„é—®é¢˜ä¸­æ¢³ç†å‡ºå…³é”®é—®é¢˜ã€‚</p><ul><li>æ¯”å¦‚ï¼šæ•™å­¦æœºæ„çš„è€å¸ˆæƒ³è¦å°†è¯¾ç¨‹å‘å¸ƒåˆ°ç½‘ä¸Šï¼Œè¿™æ˜¯åŸå§‹éœ€æ±‚ï¼Œæ ¹æ®è¿™ä¸ªç”¨æˆ·éœ€æ±‚æˆ‘ä»¬éœ€è¦è¿›è¡Œæ‰©å±•åˆ†æï¼Œæ‰©å±•å‡ºå‡ ä¸‹å‡ ç‚¹ï¼š<ol><li>è¯¾ç¨‹å‘å¸ƒéœ€è¦å‘å¸ƒå“ªäº›ä¿¡æ¯</li><li>å¦‚æœå‘å¸ƒäº†ä¸è‰¯ä¿¡æ¯æ€ä¹ˆåŠï¼Ÿ</li><li>è¯¾ç¨‹å‘å¸ƒåç”¨æˆ·æ€ä¹ˆæŸ¥çœ‹è¯¾ç¨‹ï¼Ÿ</li></ol></li></ul><p>æ ¹æ®ä»¥ä¸Šå‡ ç‚¹ç»§ç»­å»¶ä¼¸æ€§åˆ†æï¼š</p><ol><li>è¯¾ç¨‹å‘å¸ƒéœ€è¦å‘å¸ƒå“ªäº›ä¿¡æ¯</li></ol><p>è¯¾ç¨‹åç§°ã€è¯¾ç¨‹ä»‹ç»ã€è¯¾ç¨‹ä»·æ ¼ã€è¯¾ç¨‹å›¾ç‰‡ã€å¸ˆèµ„ç­‰ä¿¡æ¯</p><p>ç»§ç»­å»¶ä¼¸åˆ†æï¼š</p><ol><li>è¿™ä¹ˆå¤šè¯¾ç¨‹ä¿¡æ¯è¿›è¡Œå½’ç±»ï¼Œæ–¹ä¾¿ç”¨æˆ·ç¼–è¾‘ï¼Œåˆ†ä¸ºè¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ã€è¯¾ç¨‹è¥é”€ä¿¡æ¯ã€è¯¾ç¨‹å¸ˆèµ„ç­‰ä¿¡æ¯ã€‚</li></ol><ul><li><p>æŒ‰ç…§è¿™æ ·çš„æ€è·¯å¯¹ç”¨æˆ·éœ€æ±‚é€é¡¹åˆ†æï¼Œæ¢³ç†å‡ºè‹¥å¹²é—®é¢˜ï¼Œå†ä»ä¸­æ‰¾åˆ°å…³é”®é—®é¢˜ã€‚</p></li><li><p>æ¯”å¦‚ï¼šä¸Šè¾¹å¯¹è¯¾ç¨‹ä¿¡æ¯åˆ†ç±»åï¼Œå“ªäº›æ˜¯å…³é”®ä¿¡æ¯ï¼Œè¯¾ç¨‹åç§°ã€è¯¾ç¨‹å›¾ç‰‡ã€è¯¾ç¨‹ä»‹ç»ç­‰åŸºæœ¬ä¿¡æ¯ä¸ºå…³é”®ä¿¡æ¯ï¼Œæ‰€ä»¥å‘å¸ƒè¯¾ç¨‹çš„ç¬¬ä¸€æ­¥è¦ç¼–å†™è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ã€‚</p></li></ul><p>æ‰¾åˆ°äº†å…³é”®é—®é¢˜ï¼Œä¸‹ä¸€æ­¥å°±å¯ä»¥è¿›è¡Œæ•°æ®å»ºæ¨¡ï¼Œåˆ›å»ºè¯¾ç¨‹åŸºæœ¬ä¿¡æ¯è¡¨ï¼Œå¹¶è®¾è®¡å…¶ä¸­çš„å­—æ®µã€‚</p><p><strong>ç¬¬ä¸‰ï¼šæ¢³ç†ä¸šåŠ¡æµç¨‹</strong></p><p>â€‹    ä¸šåŠ¡æµç¨‹æ˜¯ç”±ä¸€ä¸ªæˆ–å¤šä¸ªç”¨æˆ·å‚ä¸å®Œæˆä¸ºäº†å®Œæˆä¸€ä¸ªç›®æ ‡æ‰€è¿›è¡Œçš„ä¸€ç³»åˆ—çš„ä¸šåŠ¡æ“ä½œï¼Œä¸è®ºæ˜¯æ•´ä¸ªç³»ç»Ÿè¿˜æ˜¯ä¸€ä¸ªæ¨¡å—é€šå¸¸é¦–å…ˆåˆ†ææ ¸å¿ƒçš„ä¸šåŠ¡æµç¨‹ï¼Œæ¯”å¦‚ï¼šå†…å®¹ç®¡ç†æ¨¡å—çš„æ ¸å¿ƒä¸šåŠ¡æµç¨‹æ˜¯è¯¾ç¨‹å‘å¸ƒï¼Œæœ¬é¡¹ç›®çš„æ ¸å¿ƒä¸šåŠ¡æµç¨‹æ˜¯å­¦ç”Ÿé€‰è¯¾å­¦ä¹ æµç¨‹ã€‚</p><p><strong>ç¬¬å››ï¼šæ•°æ®å»ºæ¨¡</strong></p><p>â€‹    æ•°æ®å»ºæ¨¡è¦æ ¹æ®åˆ†æçš„å…³é”®é—®é¢˜å°†å…¶ç›¸å…³çš„ä¿¡æ¯å…¨éƒ¨å»ºæ¨¡ã€‚æ¯”å¦‚ï¼šæ ¹æ®å‘å¸ƒè¯¾ç¨‹çš„ç”¨æˆ·éœ€æ±‚ï¼Œå¯åˆ›å»ºè¯¾ç¨‹åŸºæœ¬ä¿¡æ¯è¡¨ã€è¯¾ç¨‹è¥é”€ä¿¡æ¯è¡¨ã€è¯¾ç¨‹å¸ˆèµ„è¡¨ã€è¯¾ç¨‹å‘å¸ƒè®°å½•è¡¨ã€è¯¾ç¨‹å®¡æ ¸è®°å½•è¡¨ç­‰ã€‚</p><p><strong>ç¬¬äº”ï¼šç¼–å†™éœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦</strong></p><p>â€‹    éœ€æ±‚åˆ†æé˜¶æ®µçš„æˆæœç‰©æ˜¯éœ€æ±‚åˆ†æè§„æ ¼è¯´æ˜ä¹¦ï¼Œé’ˆå¯¹æ¯ä¸€ä¸ªé—®é¢˜ç¼–å†™éœ€æ±‚ç”¨ä¾‹ï¼Œéœ€æ±‚ç”¨ä¾‹åŒ…æ‹¬ï¼šåŠŸèƒ½åç§°ã€åŠŸèƒ½æè¿°ã€å‚ä¸è€…ã€åŸºæœ¬äº‹ä»¶æµç¨‹ã€å¯é€‰äº‹ä»¶æµã€æ•°æ®æè¿°ã€å‰ç½®æ¡ä»¶ã€åç½®æ¡ä»¶ç­‰å†…å®¹ã€‚</p><p>æ¯”å¦‚ï¼šæ·»åŠ è¯¾ç¨‹çš„éœ€æ±‚ç”¨ä¾‹å¦‚ä¸‹ï¼š</p><div class="table-container"><table><thead><tr><th>é¡¹ç›®</th><th>æ·»åŠ è¯¾ç¨‹</th></tr></thead><tbody><tr><td>åŠŸèƒ½åç§°</td><td>æ·»åŠ è¯¾ç¨‹</td></tr><tr><td>åŠŸèƒ½æè¿°</td><td>æ·»åŠ è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯</td></tr><tr><td>å‚ä¸è€…</td><td>æ•™å­¦æœºæ„ç®¡ç†å‘˜</td></tr><tr><td>å‰ç½®æ¡ä»¶</td><td>æ•™å­¦æœºæ„ç®¡ç†åªå…è®¸å‘è‡ªå·±æœºæ„æ·»åŠ è¯¾ç¨‹ æ‹¥æœ‰æ·»åŠ è¯¾ç¨‹çš„æƒé™</td></tr><tr><td>åŸºæœ¬äº‹ä»¶æµç¨‹</td><td>1ã€ç™»å½•æ•™å­¦æœºæ„å¹³å° 2ã€è¿›å…¥è¯¾ç¨‹åˆ—è¡¨é¡µé¢ 3ã€ç‚¹å‡»æ·»åŠ è¯¾ç¨‹æŒ‰é’®è¿›å…¥æ·»åŠ è¯¾ç¨‹ç•Œé¢ 4ã€å¡«å†™è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ 5ã€ç‚¹å‡»æäº¤ã€‚</td></tr><tr><td>å¯é€‰äº‹ä»¶æµç¨‹</td><td>æˆåŠŸï¼šæç¤ºæ·»åŠ æˆåŠŸï¼Œè·³è½¬åˆ°è¯¾ç¨‹è¥é”€ä¿¡æ¯æ·»åŠ ç•Œé¢ å¤±è´¥ï¼šæç¤ºå…·ä½“çš„å¤±è´¥ä¿¡æ¯ï¼Œç”¨æˆ·æ ¹æ®å¤±è´¥ä¿¡æ¯è¿›è¡Œä¿®æ”¹ã€‚</td></tr><tr><td>æ•°æ®æè¿°</td><td>è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ï¼šè¯¾ç¨‹idã€è¯¾ç¨‹åç§°ã€è¯¾ç¨‹ä»‹ç»ã€è¯¾ç¨‹å¤§åˆ†ç±»ã€è¯¾ç¨‹å°åˆ†ç±»ã€è¯¾ç¨‹ç­‰çº§ã€è¯¾ç¨‹å›¾ç‰‡ã€æ‰€å±æœºæ„ã€è¯¾ç¨‹åˆ›å»ºæ—¶é—´ã€è¯¾ç¨‹ä¿®æ”¹æ—¶é—´ã€è¯¾ç¨‹çŠ¶æ€</td></tr><tr><td>åç½®æ¡ä»¶</td><td>å‘è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯æ’å…¥ä¸€æ¡è®°å½•</td></tr><tr><td>è¡¥å……è¯´æ˜</td></tr></tbody></table></div><h2 id="1-2-æ¨¡å—ä»‹ç»"><a href="#1-2-æ¨¡å—ä»‹ç»" class="headerlink" title="1.2 æ¨¡å—ä»‹ç»"></a>1.2 æ¨¡å—ä»‹ç»</h2><p>å†…å®¹ç®¡ç†è¿™ä¸ªè¯å­˜åœ¨äºå¾ˆå¤šè½¯ä»¶ç³»ç»Ÿï¼Œä»€ä¹ˆæ˜¯å†…å®¹ç®¡ç† ï¼Ÿ</p><p>é€šè¿‡ç™¾åº¦ç™¾ç§‘æŸ¥è¯¢å…¶æ„æ€ï¼š<a href="https://baike.baidu.com/item/å†…å®¹ç®¡ç†ç³»ç»Ÿ/2683135?fromtitle=å†…å®¹ç®¡ç†&amp;fromid=9868820&amp;fr=aladdin">https://baike.baidu.com/item/%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/2683135?fromtitle=%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86&amp;fromid=9868820&amp;fr=aladdin</a></p><p>å†…å®¹ç®¡ç†ç³»ç»Ÿï¼ˆcontent management systemï¼ŒCMSï¼‰ï¼Œæ˜¯ä¸€ç§ä½äºWEBå‰ç«¯ï¼ˆWeb æœåŠ¡å™¨ï¼‰å’Œåç«¯åŠå…¬ç³»ç»Ÿæˆ–æµç¨‹ï¼ˆå†…å®¹åˆ›ä½œã€ç¼–è¾‘ï¼‰ä¹‹é—´çš„è½¯ä»¶ç³»ç»Ÿã€‚å†…å®¹çš„åˆ›ä½œäººå‘˜ã€ç¼–è¾‘äººå‘˜ã€å‘å¸ƒäººå‘˜ä½¿ç”¨å†…å®¹ç®¡ç†ç³»ç»Ÿæ¥æäº¤ã€ä¿®æ”¹ã€å®¡æ‰¹ã€å‘å¸ƒå†…å®¹ã€‚è¿™é‡ŒæŒ‡çš„â€œå†…å®¹â€å¯èƒ½åŒ…æ‹¬æ–‡ä»¶ã€è¡¨æ ¼ã€å›¾ç‰‡ã€æ•°æ®åº“ä¸­çš„æ•°æ®ç”šè‡³è§†é¢‘ç­‰ä¸€åˆ‡ä½ æƒ³è¦å‘å¸ƒåˆ°Internetã€Intranetä»¥åŠExtranetç½‘ç«™çš„ä¿¡æ¯ã€‚</p><p>æœ¬é¡¹ç›®ä½œä¸ºä¸€ä¸ªå¤§å‹çš„åœ¨çº¿æ•™è‚²å¹³å°ï¼Œå…¶å†…å®¹ç®¡ç†æ¨¡å—ä¸»è¦å¯¹<strong>è¯¾ç¨‹åŠç›¸å…³å†…å®¹è¿›è¡Œç®¡ç†</strong>ï¼ŒåŒ…æ‹¬ï¼šè¯¾ç¨‹çš„åŸºæœ¬ä¿¡æ¯ã€è¯¾ç¨‹å›¾ç‰‡ã€è¯¾ç¨‹å¸ˆèµ„ä¿¡æ¯ã€è¯¾ç¨‹çš„æˆè¯¾è®¡åˆ’ã€è¯¾ç¨‹è§†é¢‘ã€è¯¾ç¨‹æ–‡æ¡£ç­‰å†…å®¹çš„ç®¡ç†ã€‚</p><h2 id="1-3-ä¸šåŠ¡æµç¨‹"><a href="#1-3-ä¸šåŠ¡æµç¨‹" class="headerlink" title="1.3 ä¸šåŠ¡æµç¨‹"></a>1.3 ä¸šåŠ¡æµç¨‹</h2><p>å†…å®¹ç®¡ç†çš„ä¸šåŠ¡ç”±æ•™å­¦æœºæ„äººå‘˜å’Œå¹³å°çš„è¿è¥äººå‘˜å…±åŒå®Œæˆã€‚</p><p>æ•™å­¦æœºæ„äººå‘˜çš„ä¸šåŠ¡æµç¨‹å¦‚ä¸‹ï¼š</p><ol><li><p>ç™»å½•æ•™å­¦æœºæ„ã€‚</p></li><li><p>ç»´æŠ¤è¯¾ç¨‹ä¿¡æ¯ï¼Œæ·»åŠ ä¸€é—¨è¯¾ç¨‹éœ€è¦ç¼–è¾‘è¯¾ç¨‹çš„åŸºæœ¬ä¿¡æ¯ã€ä¸Šä¼ è¯¾ç¨‹å›¾ç‰‡ã€è¯¾ç¨‹è¥é”€ä¿¡æ¯ã€è¯¾ç¨‹è®¡åˆ’ã€ä¸Šä¼ è¯¾ç¨‹è§†é¢‘ã€è¯¾ç¨‹å¸ˆèµ„ä¿¡æ¯ç­‰å†…å®¹ã€‚</p></li><li><p>è¯¾ç¨‹ä¿¡æ¯ç¼–è¾‘å®Œæˆï¼Œé€šè¿‡è¯¾ç¨‹é¢„è§ˆç¡®è®¤æ— è¯¯åæäº¤è¯¾ç¨‹å®¡æ ¸ã€‚</p></li><li><p>å¾…è¿è¥äººå‘˜å¯¹è¯¾ç¨‹å®¡æ ¸é€šè¿‡åæ–¹å¯è¿›è¡Œè¯¾ç¨‹å‘å¸ƒã€‚</p></li></ol><p>è¿è¥äººå‘˜çš„ä¸šåŠ¡æµç¨‹å¦‚ä¸‹ï¼š</p><ol><li><p>æŸ¥è¯¢å¾…å®¡æ ¸çš„è¯¾ç¨‹ä¿¡æ¯ã€‚</p></li><li><p>å®¡æ ¸è¯¾ç¨‹ä¿¡æ¯ã€‚</p></li><li><p>æäº¤å®¡æ ¸ç»“æœã€‚</p></li></ol><p>ä¸‹å›¾æ˜¯è¯¾ç¨‹ç¼–è¾‘ä¸å‘å¸ƒçš„æ•´ä½“æµç¨‹ã€‚</p><p><img src="https://picbed1.taoyaopc.live/xczx/wps1.jpg" alt="img"> </p><h2 id="1-4-ç•Œé¢æ¨¡å‹"><a href="#1-4-ç•Œé¢æ¨¡å‹" class="headerlink" title="1.4 ç•Œé¢æ¨¡å‹"></a>1.4 ç•Œé¢æ¨¡å‹</h2><p>äº§å“å·¥ç¨‹å¸ˆæ ¹æ®ç”¨æˆ·éœ€æ±‚åˆ¶ä½œäº§å“ç•Œé¢åŸå‹ï¼Œå¼€å‘å·¥ç¨‹å¸ˆé™¤äº†æ ¹æ®ç”¨æˆ·éœ€æ±‚è¿›è¡Œéœ€æ±‚åˆ†æä»¥å¤–ï¼Œè¿˜ä¼šæ ¹æ®ç•Œé¢åŸå‹ä¸Šçš„å…ƒç´ ä¿¡æ¯è¿›è¡Œéœ€æ±‚åˆ†æã€‚</p><p>å†…å®¹ç®¡ç†æ¨¡å—çš„ç•Œé¢åŸå‹å¦‚ä¸‹ï¼š</p><p>è¯¾ç¨‹åˆ—è¡¨ ï¼š</p><p><img src="https://picbed1.taoyaopc.live/xczx/wps2.jpg" alt="img"> </p><p>ç‚¹å‡»æ·»åŠ è¯¾ç¨‹ï¼š</p><p><img src="https://picbed1.taoyaopc.live/xczx/wps3.jpg" alt="img" style="zoom: 50%;" /> </p><p>é€‰æ‹©å½•æ’­è¯¾ç¨‹ ï¼Œå¡«å†™è¯¾ç¨‹ä¿¡æ¯ï¼š</p><p><img src="https://picbed1.taoyaopc.live/xczx/wps4.jpg" alt="img"> </p><p>å¡«å†™è¯¾ç¨‹è®¡åˆ’ä¿¡æ¯ï¼š</p><p><img src="https://picbed1.taoyaopc.live/xczx/wps5.jpg" alt="img"> </p><p>å¡«å†™è¯¾ç¨‹å¸ˆèµ„ä¿¡æ¯ï¼š</p><p><img src="https://picbed1.taoyaopc.live/xczx/wps6.jpg" alt="img"> </p><p>è¯¾ç¨‹å¡«å†™å®Œæ¯•è¿›è¡Œè¯¾ç¨‹ å‘å¸ƒï¼š</p><p>å½“å®¡æ ¸çŠ¶æ€ä¸ºé€šè¿‡æ—¶å‘å¸ƒæŒ‰é’®ç‚¹äº®ï¼Œç‚¹å‡»å‘å¸ƒæŒ‰é’® å³å¯å¯¹è¯¥è¯¾ç¨‹è¿›è¡Œå‘å¸ƒã€‚</p><p><img src="https://picbed1.taoyaopc.live/xczx/wps7.jpg" alt="img"> </p><h2 id="1-5-æ•°æ®æ¨¡å‹"><a href="#1-5-æ•°æ®æ¨¡å‹" class="headerlink" title="1.5 æ•°æ®æ¨¡å‹"></a>1.5 æ•°æ®æ¨¡å‹</h2><p>å†…å®¹ç®¡ç†æ¨¡å—çš„åŸºç¡€è¡¨æ¶‰åŠ9å¼ ï¼Œå¦‚ä¸‹ï¼š</p><p>ä½¿ç”¨PowerDesigneræ‰“å¼€è¯¾ç¨‹èµ„æ–™ä¸‹çš„  â€œæ•°æ®åº“\æ¨¡å‹\å­¦æˆåœ¨çº¿é¡¹ç›®.swsâ€ </p><p><img src="https://picbed1.taoyaopc.live/xczx/wps8.jpg" alt="img"> </p><h1 id="2-åˆ›å»ºæ¨¡å—å·¥ç¨‹"><a href="#2-åˆ›å»ºæ¨¡å—å·¥ç¨‹" class="headerlink" title="2.åˆ›å»ºæ¨¡å—å·¥ç¨‹"></a>2.åˆ›å»ºæ¨¡å—å·¥ç¨‹</h1><h2 id="2-1-æ¨¡å—å·¥ç¨‹ç»“æ„"><a href="#2-1-æ¨¡å—å·¥ç¨‹ç»“æ„" class="headerlink" title="2.1 æ¨¡å—å·¥ç¨‹ç»“æ„"></a>2.1 æ¨¡å—å·¥ç¨‹ç»“æ„</h2><ul><li>åœ¨ç¬¬ä¸€ç« èŠ‚åˆ›å»ºäº†é¡¹ç›®çˆ¶å·¥ç¨‹ã€é¡¹ç›®åŸºç¡€å·¥ç¨‹ï¼Œå¦‚ä¸‹å›¾ï¼š</li></ul><p><img src="https://picbed1.taoyaopc.live/xczx/wps9.jpg" alt="img" style="zoom: 67%;" /> </p><ul><li><p>æ¥ä¸‹æ¥è¦åˆ›å»ºå†…å®¹ç®¡ç†æ¨¡å—çš„å·¥ç¨‹ç»“æ„ã€‚æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªå‰åç«¯åˆ†ç¦»é¡¹ç›®ï¼Œå‰ç«¯ä¸åç«¯å¼€å‘äººå‘˜ä¹‹é—´ä¸»è¦ä¾æ®æ¥å£è¿›è¡Œå¼€å‘ã€‚å‰åç«¯äº¤äº’çš„æµç¨‹å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p><ol><li><p>å‰ç«¯è¯·æ±‚åç«¯æœåŠ¡æä¾›çš„æ¥å£ã€‚ï¼ˆé€šå¸¸ä¸ºhttpåè®® ï¼‰</p></li><li><p>åç«¯æœåŠ¡çš„æ§åˆ¶å±‚Controlleræ¥æ”¶å‰ç«¯çš„è¯·æ±‚ã€‚</p></li><li><p>Contorllerå±‚è°ƒç”¨Serviceå±‚è¿›è¡Œä¸šåŠ¡å¤„ç†ã€‚</p></li><li><p>Serviceå±‚è°ƒç”¨DaoæŒä¹…å±‚å¯¹æ•°æ®æŒä¹…åŒ–ã€‚</p></li></ol></li></ul><p><img src="https://picbed1.taoyaopc.live/xczx/wps10.jpg" alt="img"> </p><ul><li><p>æ•´ä¸ªæµç¨‹åˆ†ä¸ºå‰ç«¯ã€æ¥å£å±‚ã€ä¸šåŠ¡å±‚ä¸‰éƒ¨åˆ†ã€‚æ‰€ä»¥æ¨¡å—å·¥ç¨‹çš„ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š </p><ul><li><p>xuecheng-plus-content-apiï¼šæ¥å£å·¥ç¨‹ï¼Œä¸ºå‰ç«¯æä¾›æ¥å£ã€‚</p></li><li><p>xuecheng-plus-content-service: ä¸šåŠ¡å·¥ç¨‹ï¼Œä¸ºæ¥å£å·¥ç¨‹æä¾›ä¸šåŠ¡æ”¯æ’‘ã€‚</p></li><li><p>xuecheng-plus-content-model: æ•°æ®æ¨¡å‹å·¥ç¨‹ï¼Œå­˜å‚¨æ•°æ®æ¨¡å‹ç±»ã€æ•°æ®ä¼ è¾“ç±»å‹ç­‰ã€‚</p></li></ul></li></ul><p><img src="https://picbed1.taoyaopc.live/xczx/wps11.jpg" alt="img" style="zoom:67%;" /></p><p>ç»“åˆé¡¹ç›®çˆ¶å·¥ç¨‹ã€é¡¹ç›®åŸºç¡€å·¥ç¨‹åï¼Œå¦‚ä¸‹å›¾ï¼š</p><ul><li>xuecheng-plus-contentï¼šå†…å®¹ç®¡ç†æ¨¡å—å·¥ç¨‹ï¼Œè´Ÿè´£èšåˆxuecheng-plus-content-apiã€xuecheng-plus-content-serviceã€xuecheng-plus-content-modelã€‚</li></ul><p><img src="https://picbed1.taoyaopc.live/xczx/wps12.jpg" alt="img"> </p><h2 id="2-2-åˆ›å»ºæ¨¡å—å·¥ç¨‹"><a href="#2-2-åˆ›å»ºæ¨¡å—å·¥ç¨‹" class="headerlink" title="2.2 åˆ›å»ºæ¨¡å—å·¥ç¨‹"></a>2.2 åˆ›å»ºæ¨¡å—å·¥ç¨‹</h2><p>åˆ›å»ºå·¥ç¨‹æ—¶ï¼Œåˆ é™¤ä¸å¿…è¦çš„æ–‡ä»¶ï¼Œç€é‡ä¿ç•™ pom.xml å’Œ src</p><ol><li><p>åˆ›å»ºå†…å®¹ç®¡ç†æ¨¡å—çˆ¶å·¥ç¨‹xuecheng-plus-contentï¼Œä¿®æ”¹pom.xmlï¼Œå£°æ˜ä¸ºèšåˆå·¥ç¨‹ï¼Œä¸”æœ‰ä¸‰ä¸ªå­æ¨¡å—</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xuecheng<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xuecheng-plus-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>&gt;</span>../xuecheng-plus-parent<span class="tag">&lt;/<span class="name">relativePath</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xuecheng<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xuecheng-plus-content<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>xuecheng-plus-content<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>xuecheng-plus-content<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modules</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span>&gt;</span>xuecheng-plus-content-api<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span>&gt;</span>xuecheng-plus-content-model<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span>&gt;</span>xuecheng-plus-content-service<span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">modules</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>åˆ›å»ºxuecheng-plus-content-apiå·¥ç¨‹ï¼Œè®¾ç½®çˆ¶å·¥ç¨‹ä¸º xuecheng-plus-contentï¼ŒæŒ‰ç…§ä¸Šå›¾ä¸­çš„ä¾èµ–å…³ç³»ä¿®æ”¹pomæ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xuecheng<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xuecheng-plus-content<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xuecheng-plus-content-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>xuecheng-plus-content-api<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>xuecheng-plus-content-api<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xuecheng<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xuecheng-plus-content-service<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xuecheng<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xuecheng-plus-content-model<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>åˆ›å»ºxuecheng-plus-content-modelå·¥ç¨‹ï¼Œè®¾ç½®çˆ¶å·¥ç¨‹ä¸º xuecheng-plus-content</p><p>ï¼ŒæŒ‰ç…§ä¸Šå›¾ä¸­çš„ä¾èµ–å…³ç³»ä¿®æ”¹pomæ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xuecheng<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xuecheng-plus-content<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xuecheng-plus-content-model<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>xuecheng-plus-content-model<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>xuecheng-plus-content-model<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xuecheng<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xuecheng-plus-base<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>åˆ›å»ºxuecheng-plus-content-serviceå·¥ç¨‹ï¼Œè®¾ç½®çˆ¶å·¥ç¨‹ä¸ºxuecheng-plus-content</p><p>ï¼ŒæŒ‰ç…§ä¸Šå›¾ä¸­çš„ä¾èµ–å…³ç³»ä¿®æ”¹pomæ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xuecheng<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xuecheng-plus-content<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xuecheng-plus-content-service<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>xuecheng-plus-content-service<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>xuecheng-plus-content-service<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xuecheng<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xuecheng-plus-content-model<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><ul><li>åˆ›å»ºå¥½çš„ç›®å½•ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤º</li></ul><p><img src="https://picbed1.taoyaopc.live/xczx/image-20230520111550776.png" alt="image-20230520111550776" style="zoom: 67%;" /></p><h1 id="3-è¯¾ç¨‹æŸ¥è¯¢"><a href="#3-è¯¾ç¨‹æŸ¥è¯¢" class="headerlink" title="3. è¯¾ç¨‹æŸ¥è¯¢"></a>3. è¯¾ç¨‹æŸ¥è¯¢</h1><h2 id="3-1-éœ€æ±‚åˆ†æ"><a href="#3-1-éœ€æ±‚åˆ†æ" class="headerlink" title="3.1 éœ€æ±‚åˆ†æ"></a>3.1 éœ€æ±‚åˆ†æ</h2><h3 id="3-1-1-ä¸šåŠ¡æµç¨‹"><a href="#3-1-1-ä¸šåŠ¡æµç¨‹" class="headerlink" title="3.1.1 ä¸šåŠ¡æµç¨‹"></a>3.1.1 ä¸šåŠ¡æµç¨‹</h3><p>è¯¾ç¨‹æŸ¥è¯¢çš„ä¸šåŠ¡æµç¨‹å¦‚ä¸‹ï¼š</p><ol><li>æ•™å­¦æœºæ„äººå‘˜ç‚¹å‡»è¯¾ç¨‹ç®¡ç†é¦–å…ˆè¿›å…¥è¯¾ç¨‹æŸ¥è¯¢ç•Œé¢ï¼Œå¦‚ä¸‹ï¼š</li></ol><p><img src="https://picbed1.taoyaopc.live/xczx/wps13.jpg" alt="img"> </p><ol><li>åœ¨è¯¾ç¨‹è¿›è¡Œåˆ—è¡¨æŸ¥è¯¢é¡µé¢è¾“å…¥æŸ¥è¯¢æ¡ä»¶æŸ¥è¯¢è¯¾ç¨‹ä¿¡æ¯<ul><li>å½“ä¸è¾“å…¥æŸ¥è¯¢æ¡ä»¶æ—¶è¾“å…¥å…¨éƒ¨è¯¾ç¨‹ä¿¡æ¯ã€‚</li><li>è¾“å…¥æŸ¥è¯¢æ¡ä»¶æŸ¥è¯¢ç¬¦åˆæ¡ä»¶çš„è¯¾ç¨‹ä¿¡æ¯ã€‚</li><li>çº¦æŸï¼šæœ¬æ•™å­¦æœºæ„æŸ¥è¯¢æœ¬æœºæ„çš„è¯¾ç¨‹ä¿¡æ¯ã€‚</li></ul></li></ol><p><img src="https://picbed1.taoyaopc.live/xczx/wps14.jpg" alt="img"> </p><h3 id="3-1-2-æ•°æ®æ¨¡å‹"><a href="#3-1-2-æ•°æ®æ¨¡å‹" class="headerlink" title="3.1.2 æ•°æ®æ¨¡å‹"></a>3.1.2 æ•°æ®æ¨¡å‹</h3><p>ä¸‹è¾¹ä»æŸ¥è¯¢æ¡ä»¶ã€æŸ¥è¯¢åˆ—è¡¨ä¸¤ä¸ªæ–¹é¢åˆ†ææ•°æ®æ¨¡å‹</p><ol><li><p>æŸ¥è¯¢æ¡ä»¶ï¼š</p><ul><li>åŒ…æ‹¬ï¼šè¯¾ç¨‹åç§°ã€è¯¾ç¨‹å®¡æ ¸çŠ¶æ€ã€è¯¾ç¨‹å‘å¸ƒçŠ¶æ€</li><li>è¯¾ç¨‹åç§°ï¼šå¯ä»¥æ¨¡ç³Šæœç´¢</li><li>è¯¾ç¨‹å®¡æ ¸çŠ¶æ€ï¼šæœªæäº¤ã€å·²æäº¤ã€å®¡æ ¸é€šè¿‡ã€å®¡æ ¸æœªé€šè¿‡</li><li>è¯¾ç¨‹å‘å¸ƒçŠ¶æ€ï¼šæœªå‘å¸ƒã€å·²å‘å¸ƒã€å·²ä¸‹çº¿</li><li>å› ä¸ºæ˜¯åˆ†é¡µæŸ¥è¯¢æ‰€ä»¥æŸ¥è¯¢æ¡ä»¶ä¸­è¿˜è¦åŒ…æ‹¬å½“å‰é¡µç ã€æ¯é¡µæ˜¾ç¤ºè®°å½•æ•°ã€‚</li></ul></li><li><p>æŸ¥è¯¢ç»“æœï¼š</p><ul><li>æŸ¥è¯¢ç»“æœä¸­åŒ…æ‹¬ï¼šè¯¾ç¨‹idã€è¯¾ç¨‹åç§°ã€ä»»åŠ¡æ•°ã€åˆ›å»ºæ—¶é—´ã€æ˜¯å¦ä»˜è´¹ã€å®¡æ ¸çŠ¶æ€ã€ç±»å‹ï¼Œæ“ä½œ</li><li>ä»»åŠ¡æ•°ï¼šè¯¥è¯¾ç¨‹æ‰€åŒ…å«çš„è¯¾ç¨‹è®¡åˆ’æ•°ï¼Œå³è¯¾ç¨‹ç« èŠ‚æ•°ã€‚</li><li>æ˜¯å¦ä»˜è´¹ï¼šè¯¾ç¨‹åŒ…æ‹¬å…è´¹ã€æ”¶è´¹ä¸¤ç§ã€‚</li><li>ç±»å‹ï¼šå½•æ’­ã€ç›´æ’­ã€‚</li><li>å› ä¸ºæ˜¯åˆ†é¡µæŸ¥è¯¢æ‰€ä»¥æŸ¥è¯¢ç»“æœä¸­è¿˜è¦åŒ…æ‹¬æ€»è®°å½•æ•°ã€å½“å‰é¡µã€æ¯é¡µæ˜¾ç¤ºè®°å½•æ•°ã€‚</li></ul></li></ol><h2 id="3-2-åˆ›å»ºæ•°æ®åº“è¡¨åŠPOç±»å‹"><a href="#3-2-åˆ›å»ºæ•°æ®åº“è¡¨åŠPOç±»å‹" class="headerlink" title="3.2 åˆ›å»ºæ•°æ®åº“è¡¨åŠPOç±»å‹"></a>3.2 åˆ›å»ºæ•°æ®åº“è¡¨åŠPOç±»å‹</h2><h3 id="3-2-1-åˆ›å»ºæ•°æ®åº“è¡¨"><a href="#3-2-1-åˆ›å»ºæ•°æ®åº“è¡¨" class="headerlink" title="3.2.1 åˆ›å»ºæ•°æ®åº“è¡¨"></a>3.2.1 åˆ›å»ºæ•°æ®åº“è¡¨</h3><ol><li>åˆ›å»ºå†…å®¹ç®¡ç†æ•°æ®åº“</li><li>å¯¼å…¥æ•°æ®<ul><li>é€‰ä¸­æä¾›çš„ sqlè„šæœ¬ï¼Œæ‰§è¡Œè„šæœ¬ç”Ÿæˆæ•°æ®è¡¨</li></ul></li></ol><p><img src="https://picbed1.taoyaopc.live/xczx/image-20230520105144654.png" alt="image-20230520105144654"></p><h3 id="3-2-2-ç”Ÿæˆ-PO-ç±»"><a href="#3-2-2-ç”Ÿæˆ-PO-ç±»" class="headerlink" title="3.2.2 ç”Ÿæˆ PO ç±»"></a>3.2.2 ç”Ÿæˆ PO ç±»</h3><p>PO å³æŒä¹…å¯¹è±¡ (Persistent Object)ï¼Œ</p><ul><li><p>å®ƒä»¬æ˜¯ç”±ä¸€ç»„å±æ€§å’Œå±æ€§çš„getå’Œsetæ–¹æ³•ç»„æˆï¼ŒPOå¯¹åº”äºæ•°æ®åº“çš„è¡¨ã€‚</p></li><li><p>åœ¨å¼€å‘æŒä¹…å±‚ä»£ç æ—¶éœ€è¦æ ¹æ®æ•°æ®è¡¨ç¼–å†™POç±»ï¼Œåœ¨å®é™…å¼€å‘ä¸­é€šå¸¸ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ï¼ˆå·¥å…·ï¼‰ç”ŸæˆPOç±»çš„ä»£ç ã€‚</p></li><li><p>ç”±äºåœ¨éœ€æ±‚åˆ†æé˜¶æ®µå¯¹æ•°æ®æ¨¡å‹è¿›è¡Œåˆ†æï¼ŒPOç±»å¯¹åº”äºæ•°æ®æ¨¡å‹ï¼Œæ‰€ä»¥åœ¨éœ€æ±‚åˆ†æé˜¶æ®µå³å¯ä½¿ç”¨å·¥å…·ç”ŸæˆPOç±»ï¼Œä¸ºä¸‹é¢çš„æ¥å£å®šä¹‰å‡†å¤‡å¥½æ¨¡å‹ç±»ã€‚</p></li></ul><p>åœ¨ä¼ä¸šå¼€å‘ä¸­é€šå¸¸ä½¿ç”¨ä»£ç ç”Ÿæˆå·¥å…·å»è‡ªåŠ¨ç”Ÿæˆè¿™äº›æ–‡ä»¶ï¼Œ</p><ul><li><p>æœ¬é¡¹ç›®ä½¿ç”¨mybatis-plusçš„generatorå·¥ç¨‹ç”ŸæˆPOç±»ã€Mapperæ¥å£ã€Mapperçš„xmlæ–‡ä»¶ï¼Œåœ°å€åœ¨ï¼š<a href="https://github.com/baomidou/generator">https://github.com/baomidou/generator</a></p></li><li><p>å°†è¯¾ç¨‹èµ„æ–™ç›®å½•ä¸‹çš„xuecheng-plus-generator.zipè§£å‹åæ‹·è´è‡³é¡¹ç›®å·¥ç¨‹æ ¹ç›®å½•ï¼Œ</p></li></ul><p>æ‰“å¼€IDEAå°†å…¶å¯¼å…¥é¡¹ç›®å·¥ç¨‹ ï¼Œæ‰“å¼€xuecheng-plus-generatorå·¥ç¨‹çš„pom.xmlï¼Œå³é”® ç‚¹å‡»â€œAdd as Maven Projectâ€ è‡ªåŠ¨è¯†åˆ«mavenå·¥ç¨‹ã€‚</p><p>æœ¬æ¬¡ç”Ÿæˆå†…å®¹ç®¡ç†æ¨¡å—çš„POç±»ã€Mapperæ¥å£å’ŒMapperçš„xmlæ–‡ä»¶ ï¼Œ</p><ol><li><p>æ‰¾åˆ°ContentCodeGeneratorç±»</p></li><li><p>ä¿®æ”¹ContentCodeGeneratorç±»ä¸­çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼šæ•°æ®åº“åœ°å€ã€æ•°æ®åº“è´¦å·ã€æ•°æ®åº“å¯†ç ã€ç”Ÿæˆçš„è¡¨ã€ç”Ÿæˆè·¯å¾„ï¼Œå¦‚ä¸‹ï¼š</p></li><li>ä¿®æ”¹å®Œæˆï¼Œæ‰§è¡Œè¯¥ç±»çš„mainæ–¹æ³•ï¼Œè‡ªåŠ¨ç”ŸæˆcontentåŒ…ï¼Œå¦‚ä¸‹ï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ•°æ®åº“è´¦å·</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DATA_SOURCE_USER_NAME</span>  <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line"><span class="comment">//æ•°æ®åº“å¯†ç </span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DATA_SOURCE_PASSWORD</span>  <span class="operator">=</span> <span class="string">&quot;mysql&quot;</span>;</span><br><span class="line"><span class="comment">//ç”Ÿæˆçš„è¡¨</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] TABLE_NAMES = <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;</span><br><span class="line">        <span class="string">&quot;course_base&quot;</span>,</span><br><span class="line">        <span class="string">&quot;course_market&quot;</span>,</span><br><span class="line">        <span class="string">&quot;course_teacher&quot;</span>,</span><br><span class="line">        <span class="string">&quot;course_category&quot;</span>,</span><br><span class="line">        <span class="string">&quot;teachplan&quot;</span>,</span><br><span class="line">        <span class="string">&quot;teachplan_media&quot;</span>,</span><br><span class="line">        <span class="string">&quot;course_publish&quot;</span>,</span><br><span class="line">        <span class="string">&quot;course_publish_pre&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// TODO é»˜è®¤ç”Ÿæˆentityï¼Œéœ€è¦ç”ŸæˆDTOä¿®æ”¹æ­¤å˜é‡</span></span><br><span class="line"><span class="comment">// ä¸€èˆ¬æƒ…å†µä¸‹è¦å…ˆç”Ÿæˆ DTOç±» ç„¶åä¿®æ”¹æ­¤å‚æ•°å†ç”Ÿæˆ PO ç±»ã€‚</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Boolean</span> <span class="variable">IS_DTO</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        ....</span><br><span class="line">        <span class="comment">//ç”Ÿæˆè·¯å¾„</span></span><br><span class="line">        gc.setOutputDir(System.getProperty(<span class="string">&quot;user.dir&quot;</span>) + <span class="string">&quot;/xuecheng-plus-generator/src/main/java&quot;</span>);</span><br><span class="line">        </span><br><span class="line">....</span><br><span class="line"><span class="comment">// æ•°æ®åº“é…ç½®</span></span><br><span class="line">        <span class="type">DataSourceConfig</span> <span class="variable">dsc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataSourceConfig</span>();</span><br><span class="line">        dsc.setDbType(DbType.MYSQL);</span><br><span class="line">        dsc.setUrl(<span class="string">&quot;jdbc:mysql://192.168.101.65:3306/xcplus_&quot;</span> + SERVICE_NAME+<span class="string">&quot;166&quot;</span></span><br><span class="line">                        + <span class="string">&quot;?serverTimezone=UTC&amp;useUnicode=true&amp;useSSL=false&amp;characterEncoding=utf8&quot;</span>);</span><br><span class="line">        ...</span><br></pre></td></tr></table></figure><ol><li>åœ¨è¯¥åŒ…ä¸‹è‡ªåŠ¨ç”Ÿæˆäº†å†…å®¹ç®¡ç†æ¨¡å—çš„controllerã€mapperã€poåŠserviceç›¸å…³ä»£ç ï¼Œè¿™é‡Œæˆ‘ä»¬åªéœ€è¦poç±»ã€‚å°†poç±»æ‹·è´åˆ° model å·¥ç¨‹</li></ol><p><img src="https://picbed1.taoyaopc.live/xczx/image-20230520113317195.png" alt="image-20230520113317195" style="zoom:50%;" /></p><h2 id="3-3-è®¾è®¡æ¥å£"><a href="#3-3-è®¾è®¡æ¥å£" class="headerlink" title="3.3 è®¾è®¡æ¥å£"></a>3.3 è®¾è®¡æ¥å£</h2><h3 id="3-3-1-æ¥å£è®¾è®¡åˆ†æ"><a href="#3-3-1-æ¥å£è®¾è®¡åˆ†æ" class="headerlink" title="3.3.1 æ¥å£è®¾è®¡åˆ†æ"></a>3.3.1 æ¥å£è®¾è®¡åˆ†æ</h3><p>è®¾è®¡ä¸€ä¸ªæ¥å£éœ€è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p><ol><li><p>åè®® </p><ul><li>é€šå¸¸åè®®é‡‡ç”¨HTTPï¼ŒæŸ¥è¯¢ç±»æ¥å£é€šå¸¸ä¸º get æˆ– postï¼ŒæŸ¥è¯¢æ¡ä»¶è¾ƒå°‘çš„ä½¿ç”¨ getï¼Œè¾ƒå¤šçš„ä½¿ç”¨ postã€‚</li><li>æœ¬æ¥å£ä½¿ç”¨ http postã€‚</li><li>è¿˜è¦ç¡®å®š content-typeï¼Œå‚æ•°ä»¥ä»€ä¹ˆæ•°æ®æ ¼å¼æäº¤ï¼Œç»“æœä»¥ä»€ä¹ˆæ•°æ®æ ¼å¼å“åº”ã€‚</li><li>ä¸€èˆ¬æƒ…å†µæ²¡æœ‰ç‰¹æ®Šæƒ…å†µç»“æœä»¥json æ ¼å¼å“åº”ã€‚</li></ul></li><li><p>åˆ†æè¯·æ±‚å‚æ•°</p><ul><li>æ ¹æ®å‰è¾¹å¯¹æ•°æ®æ¨¡å‹çš„åˆ†æï¼Œè¯·æ±‚å‚æ•°ä¸ºï¼šè¯¾ç¨‹åç§°ã€è¯¾ç¨‹å®¡æ ¸çŠ¶æ€ã€å½“å‰é¡µç ã€æ¯é¡µæ˜¾ç¤ºè®°å½•æ•°ã€‚</li><li>æ ¹æ®åˆ†æçš„è¯·æ±‚å‚æ•°å®šä¹‰æ¨¡å‹ç±»ã€‚</li></ul></li><li><p>åˆ†æå“åº”ç»“æœ</p><ul><li><p>æ ¹æ®å‰è¾¹å¯¹æ•°æ®æ¨¡å‹çš„åˆ†æï¼Œå“åº”ç»“æœä¸ºæ•°æ®åˆ—è¡¨åŠ ä¸€äº›åˆ†é¡µä¿¡æ¯ï¼ˆæ€»è®°å½•æ•°ã€å½“å‰é¡µã€æ¯é¡µæ˜¾ç¤ºè®°å½•æ•°ï¼‰ã€‚</p></li><li><p>æ•°æ®åˆ—è¡¨ä¸­æ•°æ®çš„å±æ€§åŒ…æ‹¬ï¼šè¯¾ç¨‹idã€è¯¾ç¨‹åç§°ã€ä»»åŠ¡æ•°ã€åˆ›å»ºæ—¶é—´ã€å®¡æ ¸çŠ¶æ€ã€ç±»å‹ã€‚</p></li><li><p>æ³¨æ„ï¼šæŸ¥è¯¢ç»“æœä¸­çš„å®¡æ ¸çŠ¶æ€ä¸ºæ•°æ®å­—å…¸ä¸­çš„ä»£ç å­—æ®µï¼Œå‰ç«¯ä¼šæ ¹æ®å®¡æ ¸çŠ¶æ€ä»£ç  æ‰¾åˆ°å¯¹åº”çš„åç§°æ˜¾ç¤ºã€‚</p></li></ul></li></ol><p>æ ¹æ®åˆ†æçš„å“åº”ç»“æœå®šä¹‰æ¨¡å‹ç±»ã€‚</p><ol><li><p>åˆ†æå®Œæˆï¼Œä½¿ç”¨ SpringBoot æ³¨è§£å¼€å‘ä¸€ä¸ªHttpæ¥å£ã€‚</p></li><li><p>ä½¿ç”¨æ¥å£æ–‡æ¡£å·¥å…·æŸ¥çœ‹æ¥å£çš„å†…å®¹ã€‚</p></li><li><p>æ¥å£ä¸­è°ƒç”¨Serviceæ–¹æ³•å®Œæˆä¸šåŠ¡å¤„ç†ã€‚</p><p><strong>æ¥å£è¯·æ±‚ç¤ºä¾‹</strong></p></li></ol><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">POST /content/course/list?pageNo=<span class="number">2</span>&amp;pageSize=<span class="number">1</span></span><br><span class="line">Content-Type<span class="punctuation">:</span> application/json</span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;auditStatus&quot;</span><span class="punctuation">:</span> <span class="string">&quot;202002&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;courseName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;publishStatus&quot;</span><span class="punctuation">:</span><span class="string">&quot;&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">###æˆåŠŸå“åº”ç»“æœ</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;items&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">26</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;companyId&quot;</span><span class="punctuation">:</span> <span class="number">1232141425</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;companyName&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;spring cloudå®æˆ˜&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;users&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æ‰€æœ‰äºº&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;tags&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;mt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1-3&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;mtName&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;st&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1-3-2&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;stName&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;grade&quot;</span><span class="punctuation">:</span> <span class="string">&quot;200003&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;teachmode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;201001&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æœ¬è¯¾ç¨‹ä¸»è¦ä»å››ä¸ªç« èŠ‚è¿›è¡Œè®²è§£ï¼š 1.å¾®æœåŠ¡æ¶æ„å…¥é—¨ 2.spring cloud åŸºç¡€å…¥é—¨ 3.å®æˆ˜Spring Boot 4.æ³¨å†Œä¸­å¿ƒeurekaã€‚&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;pic&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://cdn.educba.com/academy/wp-content/uploads/2018/08/Spring-BOOT-Interview-questions.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;createDate&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2019-09-04 09:56:19&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;changeDate&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2021-12-26 22:10:38&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;createPeople&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;changePeople&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;auditStatus&quot;</span><span class="punctuation">:</span> <span class="string">&quot;202002&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;auditMind&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;auditNums&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;auditDate&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;auditPeople&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;coursePubId&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;coursePubDate&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;counts&quot;</span><span class="punctuation">:</span> <span class="number">23</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;page&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;pageSize&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="3-3-2-å®šä¹‰æ¨¡å‹ç±»"><a href="#3-3-2-å®šä¹‰æ¨¡å‹ç±»" class="headerlink" title="3.3.2 å®šä¹‰æ¨¡å‹ç±»"></a>3.3.2 å®šä¹‰æ¨¡å‹ç±»</h3><p>æ ¹æ®æ¥å£åˆ†æéœ€è¦å®šä¹‰æ¨¡å‹ç±»æ¥æ”¶è¯·æ±‚çš„å‚æ•°ï¼Œå¹¶å®šä¹‰æ¨¡å‹ç±»ç”¨äºå“åº”ç»“æœã€‚</p><ol><li>åˆ†é¡µæŸ¥è¯¢æ¨¡å‹ç±»<ul><li>ç”±äºåˆ†é¡µæŸ¥è¯¢è¿™ä¸€ç±»çš„æ¥å£åœ¨é¡¹ç›®è¾ƒå¤šï¼Œè¿™é‡Œé’ˆå¯¹åˆ†é¡µæŸ¥è¯¢çš„å‚æ•°ï¼ˆå½“å‰é¡µç ã€æ¯é¡µæ˜¾ç¤ºè®°å½•æ•°ï¼‰å•ç‹¬åœ¨xuecheng-plus-baseåŸºç¡€å·¥ç¨‹ä¸­å®šä¹‰ã€‚</li></ul></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.base.model;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.ToString;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/20</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆ†é¡µæŸ¥è¯¢åˆ†é¡µå‚æ•°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PageParams</span> &#123;</span><br><span class="line">    <span class="comment">//å½“å‰é¡µç </span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Long</span> <span class="variable">pageNo</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ¯é¡µè®°å½•æ•°é»˜è®¤å€¼</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Long</span> <span class="variable">pageSize</span> <span class="operator">=</span> <span class="number">10L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">PageParams</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">PageParams</span><span class="params">(<span class="type">long</span> pageNo, <span class="type">long</span> pageSize)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.pageNo = pageNo;</span><br><span class="line">        <span class="built_in">this</span>.pageSize = pageSize;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol><li>æŸ¥è¯¢æ¡ä»¶æ¨¡å‹ç±»<ul><li>é™¤äº†åˆ†é¡µæŸ¥è¯¢å‚æ•°ï¼Œå‰©ä¸‹çš„å°±æ˜¯è¯¾ç¨‹æŸ¥è¯¢çš„ç‰¹æœ‰å‚æ•°ï¼Œæ­¤æ—¶éœ€è¦åœ¨å†…å®¹ç®¡ç†çš„modelå·¥ç¨‹ä¸­å®šä¹‰è¯¾ç¨‹æŸ¥è¯¢å‚æ•°æ¨¡å‹ç±»ã€‚</li></ul></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.content.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.ToString;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è¯¾ç¨‹æŸ¥è¯¢æ¡ä»¶æ¨¡å‹ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/20</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">QueryCourseParamsDto</span> &#123;</span><br><span class="line">    <span class="comment">//å®¡æ ¸çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">private</span> String auditStatus;</span><br><span class="line">    <span class="comment">//è¯¾ç¨‹åç§°</span></span><br><span class="line">    <span class="keyword">private</span> String courseName;</span><br><span class="line">    <span class="comment">//å‘å¸ƒçŠ¶æ€</span></span><br><span class="line">    <span class="keyword">private</span> String publishStatus;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>å“åº”æ¨¡å‹ç±»<ul><li>æ ¹æ®æ¥å£åˆ†æï¼Œä¸‹è¾¹å®šä¹‰å“åº”ç»“æœæ¨¡å‹ç±»ã€‚</li><li>é’ˆå¯¹åˆ†é¡µæŸ¥è¯¢ç»“æœç»è¿‡åˆ†æä¹Ÿå­˜åœ¨å›ºå®šçš„æ•°æ®å’Œæ ¼å¼ï¼Œæ‰€ä»¥åœ¨baseå·¥ç¨‹å®šä¹‰ä¸€ä¸ªåŸºç¡€çš„æ¨¡å‹ç±»ã€‚</li></ul></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.base.model;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.ToString;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> åˆ†é¡µæŸ¥è¯¢ç»“æœæ¨¡å‹ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/20 11:54</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PageResult</span>&lt;T&gt; <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ•°æ®åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;T&gt; items;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ€»è®°å½•æ•°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> counts;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å½“å‰é¡µç </span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> page;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ¯é¡µè®°å½•æ•°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> pageSize;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">PageResult</span><span class="params">(List&lt;T&gt; items, <span class="type">long</span> counts, <span class="type">long</span> page, <span class="type">long</span> pageSize)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.items = items;</span><br><span class="line">        <span class="built_in">this</span>.counts = counts;</span><br><span class="line">        <span class="built_in">this</span>.page = page;</span><br><span class="line">        <span class="built_in">this</span>.pageSize = pageSize;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-3-3-å®šä¹‰æ¥å£"><a href="#3-3-3-å®šä¹‰æ¥å£" class="headerlink" title="3.3.3 å®šä¹‰æ¥å£"></a>3.3.3 å®šä¹‰æ¥å£</h3><blockquote><p>æ ¹æ®åˆ†æï¼Œæ­¤æ¥å£æä¾› HTTP poståè®®ï¼ŒæŸ¥è¯¢æ¡ä»¶ä»¥jsonæ ¼å¼æäº¤ï¼Œå“åº”ç»“æœä¸ºjson æ ¼å¼ã€‚</p><p>å¯ä½¿ç”¨SpringBootæ³¨è§£åœ¨Controllerç±»ä¸­å®ç°ã€‚</p></blockquote><ol><li>åœ¨ api å·¥ç¨‹ä¸‹æ·»åŠ ä¾èµ–</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xuecheng<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xuecheng-plus-content-service<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--cloudçš„åŸºç¡€ç¯å¢ƒåŒ…--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Spring Boot çš„ Spring Web MVC é›†æˆ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- æ’é™¤ Spring Boot ä¾èµ–çš„æ—¥å¿—åŒ…å†²çª --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-validation<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Spring Boot é›†æˆ log4j2 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-log4j2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Spring Boot é›†æˆ swagger --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.spring4all<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>swagger-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><ol><li>å®šä¹‰ Controller æ–¹æ³•</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.content.api;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.xuecheng.base.model.PageParams;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.base.model.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.model.dto.QueryCourseParamsDto;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.model.po.CourseBase;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> TODO</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/20 11:58</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CourseBaseInfoController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/course/list&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> PageResult&lt;CourseBase&gt; <span class="title function_">list</span><span class="params">(PageParams pageParams, <span class="meta">@RequestBody(required = false)</span> QueryCourseParamsDto queryCourseParamsDto)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¯´æ˜ï¼špageParamsåˆ†é¡µå‚æ•°é€šè¿‡urlçš„key/valueä¼ å…¥ï¼Œ</p><ul><li>queryCourseParamsé€šè¿‡jsonæ•°æ®ä¼ å…¥ï¼Œä½¿ç”¨@RequestBodyæ³¨è§£å°†jsonè½¬æˆQueryCourseParamsDtoå¯¹è±¡ã€‚</li></ul><p>æ³¨æ„ï¼šå°†@RequestBody å…¶å†… required è®¾ä¸º falseï¼Œä»£è¡¨æ­¤å‚æ•°ä¸ºéå¿…è¦å‚æ•°ï¼Œå¯ä¼ å¯ä¸ä¼ </p><ul><li>é»˜è®¤ä¸º trueï¼Œè¡¨ç¤ºå¿…è¦å‚æ•°ï¼Œå¿…é¡»è¦ä¼ ï¼Œå¦åˆ™æŠ¥é”™</li></ul></blockquote><ol><li>å®šä¹‰å¯åŠ¨ç±»<ul><li>åœ¨ api å·¥ç¨‹çš„ com.xuecheng åŒ…ä¸‹æ–°å»º ContentApplication ç±»</li></ul></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å†…å®¹ç®¡ç†æœåŠ¡å¯åŠ¨ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/20 12:03</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ContentApplication</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(ContentApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>æ·»åŠ é…ç½®æ–‡ä»¶<ul><li>åˆ›å»º log4j2-dev.xmlã€bootstrap.ymlæ–‡ä»¶ã€‚</li><li>log4j2-dev.xml: ä»è¯¾ç¨‹èµ„æ–™/é¡¹ç›®å·¥ç¨‹ è·å–.</li></ul></li></ol><ul><li>bootstrap.yml</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">servlet:</span></span><br><span class="line">    <span class="attr">context-path:</span> <span class="string">/content</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">63040</span></span><br><span class="line"><span class="comment">#å¾®æœåŠ¡é…ç½®</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">content-api</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://192.168.101.65:3306/xuechen_content?serverTimezone=UTC&amp;userUnicode=true&amp;useSSL=false&amp;</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">mysql</span></span><br><span class="line"><span class="comment"># æ—¥å¿—æ–‡ä»¶é…ç½®è·¯å¾„</span></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">config:</span> <span class="string">classpath:log4j2-dev.xml</span></span><br></pre></td></tr></table></figure><ul><li>log4j2-dev.xml</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Configuration</span> <span class="attr">monitorInterval</span>=<span class="string">&quot;180&quot;</span> <span class="attr">packages</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;logdir&quot;</span>&gt;</span>logs<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;PATTERN&quot;</span>&gt;</span>%date&#123;YYYY-MM-dd HH:mm:ss,SSS&#125; %level [%thread][%file:%line] - %msg%n%throwable<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Appenders</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Console</span> <span class="attr">name</span>=<span class="string">&quot;Console&quot;</span> <span class="attr">target</span>=<span class="string">&quot;SYSTEM_OUT&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;$&#123;PATTERN&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Console</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">RollingFile</span> <span class="attr">name</span>=<span class="string">&quot;ErrorAppender&quot;</span> <span class="attr">fileName</span>=<span class="string">&quot;$&#123;logdir&#125;/error.log&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">filePattern</span>=<span class="string">&quot;$&#123;logdir&#125;/$$&#123;date:yyyy-MM-dd&#125;/error.%d&#123;yyyy-MM-dd-HH&#125;.log&quot;</span> <span class="attr">append</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;$&#123;PATTERN&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ThresholdFilter</span> <span class="attr">level</span>=<span class="string">&quot;ERROR&quot;</span> <span class="attr">onMatch</span>=<span class="string">&quot;ACCEPT&quot;</span> <span class="attr">onMismatch</span>=<span class="string">&quot;DENY&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Policies</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">TimeBasedTriggeringPolicy</span> <span class="attr">interval</span>=<span class="string">&quot;1&quot;</span> <span class="attr">modulate</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">Policies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">RollingFile</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">RollingFile</span> <span class="attr">name</span>=<span class="string">&quot;DebugAppender&quot;</span> <span class="attr">fileName</span>=<span class="string">&quot;$&#123;logdir&#125;/info.log&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">filePattern</span>=<span class="string">&quot;$&#123;logdir&#125;/$$&#123;date:yyyy-MM-dd&#125;/info.%d&#123;yyyy-MM-dd-HH&#125;.log&quot;</span> <span class="attr">append</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;$&#123;PATTERN&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ThresholdFilter</span> <span class="attr">level</span>=<span class="string">&quot;DEBUG&quot;</span> <span class="attr">onMatch</span>=<span class="string">&quot;ACCEPT&quot;</span> <span class="attr">onMismatch</span>=<span class="string">&quot;DENY&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Policies</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">TimeBasedTriggeringPolicy</span> <span class="attr">interval</span>=<span class="string">&quot;1&quot;</span> <span class="attr">modulate</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">Policies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">RollingFile</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!--å¼‚æ­¥appender--&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">Async</span> <span class="attr">name</span>=<span class="string">&quot;AsyncAppender&quot;</span> <span class="attr">includeLocation</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;ErrorAppender&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;DebugAppender&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Async</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Appenders</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">Loggers</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!--è¿‡æ»¤æ‰springå’Œmybatisçš„ä¸€äº›æ— ç”¨çš„debugä¿¡æ¯</span></span><br><span class="line"><span class="comment">        &lt;logger name=&quot;org.springframework&quot; level=&quot;INFO&quot;&gt;</span></span><br><span class="line"><span class="comment">        &lt;/logger&gt;</span></span><br><span class="line"><span class="comment">        &lt;logger name=&quot;org.mybatis&quot; level=&quot;INFO&quot;&gt;</span></span><br><span class="line"><span class="comment">        &lt;/logger&gt;--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;cn.itcast.wanxinp2p.consumer.mapper&quot;</span> <span class="attr">level</span>=<span class="string">&quot;DEBUG&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;springfox&quot;</span> <span class="attr">level</span>=<span class="string">&quot;INFO&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;org.apache.http&quot;</span> <span class="attr">level</span>=<span class="string">&quot;INFO&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;com.netflix.discovery&quot;</span> <span class="attr">level</span>=<span class="string">&quot;INFO&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;RocketmqCommon&quot;</span>  <span class="attr">level</span>=<span class="string">&quot;INFO&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;RocketmqRemoting&quot;</span> <span class="attr">level</span>=<span class="string">&quot;INFO&quot;</span>  &gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;RocketmqClient&quot;</span> <span class="attr">level</span>=<span class="string">&quot;WARN&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;org.dromara.hmily&quot;</span> <span class="attr">level</span>=<span class="string">&quot;WARN&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;org.dromara.hmily.lottery&quot;</span> <span class="attr">level</span>=<span class="string">&quot;WARN&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;org.dromara.hmily.bonuspoint&quot;</span> <span class="attr">level</span>=<span class="string">&quot;WARN&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--OFF   0--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--FATAL   100--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--ERROR   200--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--WARN   300--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--INFO   400--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--DEBUG   500--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--TRACE   600--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--ALL   Integer.MAX_VALUE--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Root</span> <span class="attr">level</span>=<span class="string">&quot;DEBUG&quot;</span> <span class="attr">includeLocation</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;AsyncAppender&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;Console&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;DebugAppender&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Root</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Loggers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><ol><li>å¯åŠ¨æœåŠ¡ï¼Œæµ‹è¯•æ¥å£æ˜¯å¦æ­£å¸¸è¿è¡Œ<ul><li>åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ <code>http://localhost:63040/content/course/list</code></li><li>æµ‹è¯•æ˜¯å¦æŠ¥é”™</li></ul></li></ol><h3 id="3-3-4-æ¨¡å‹ç±»çš„ä½œç”¨"><a href="#3-3-4-æ¨¡å‹ç±»çš„ä½œç”¨" class="headerlink" title="3.3.4 æ¨¡å‹ç±»çš„ä½œç”¨"></a>3.3.4 æ¨¡å‹ç±»çš„ä½œç”¨</h3><p>ç°åœ¨é¡¹ç›®ä¸­æœ‰ä¸¤ç±»æ¨¡å‹ç±»ï¼šDTOæ•°æ®ä¼ è¾“å¯¹è±¡ã€POæŒä¹…åŒ–å¯¹è±¡ï¼Œ</p><ul><li>DTOç”¨äºæ¥å£å±‚å‘ä¸šåŠ¡å±‚ä¹‹é—´ä¼ è¾“æ•°æ®ï¼Œ</li><li>POç”¨äºä¸šåŠ¡å±‚ä¸æŒä¹…å±‚ä¹‹é—´ä¼ è¾“æ•°æ®ï¼Œ</li><li>æœ‰äº›é¡¹ç›®è¿˜ä¼šè®¾ç½®VOå¯¹è±¡ï¼ŒVOå¯¹è±¡ç”¨åœ¨å‰ç«¯ä¸æ¥å£å±‚ä¹‹é—´ä¼ è¾“æ•°æ®ï¼Œå¦‚ä¸‹å›¾ï¼š</li></ul><p><img src="https://picbed1.taoyaopc.live/xczx/wps1-1684559296764-1.jpg" alt="img"> </p><p>1ï¸âƒ£å½“å‰ç«¯æœ‰å¤šä¸ªå¹³å°ä¸”æ¥å£å­˜åœ¨å·®å¼‚æ—¶å°±éœ€è¦è®¾ç½®VOå¯¹è±¡ç”¨äºå‰ç«¯å’Œæ¥å£å±‚ä¼ è¾“æ•°æ®ã€‚</p><ul><li>æ¯”å¦‚ï¼šè¯¾ç¨‹åˆ—è¡¨æŸ¥è¯¢æ¥å£ï¼Œæ ¹æ®éœ€æ±‚ç”¨æˆ·åœ¨æ‰‹æœºç«¯ä¹Ÿè¦æŸ¥è¯¢è¯¾ç¨‹ä¿¡æ¯ï¼Œæ­¤æ—¶è¯¾ç¨‹æŸ¥è¯¢æ¥å£æ˜¯å¦éœ€è¦ç¼–å†™æ‰‹æœºç«¯å’ŒPCç«¯ä¸¤ä¸ªæ¥å£å‘¢ï¼Ÿ</li><li><p>å¦‚æœç”¨æˆ·è¦æ±‚é€šè¿‡æ‰‹æœºå’ŒPCçš„æŸ¥è¯¢æ¡ä»¶æˆ–æŸ¥è¯¢ç»“æœä¸ä¸€æ ·ï¼Œæ­¤æ—¶å°±éœ€è¦å®šä¹‰ä¸¤ä¸ªControllerè¯¾ç¨‹æŸ¥è¯¢æ¥å£ï¼Œæ¯ä¸ªæ¥å£å®šä¹‰VOå¯¹è±¡ä¸å‰ç«¯ä¼ è¾“æ•°æ®ã€‚</p><ul><li>æ‰‹æœºæŸ¥è¯¢ï¼šæ ¹æ®è¯¾ç¨‹çŠ¶æ€æŸ¥è¯¢ï¼ŒæŸ¥è¯¢ç»“æœåªæœ‰è¯¾ç¨‹åç§°å’Œè¯¾ç¨‹çŠ¶æ€ã€‚</li><li>PCæŸ¥è¯¢ï¼šå¯ä»¥æ ¹æ®è¯¾ç¨‹åç§°ã€è¯¾ç¨‹çŠ¶æ€ã€è¯¾ç¨‹å®¡æ ¸çŠ¶æ€ç­‰æ¡ä»¶æŸ¥è¯¢ï¼ŒæŸ¥è¯¢ç»“æœä¹Ÿæ¯”æ‰‹æœºæŸ¥è¯¢ç»“æœå†…å®¹å¤šã€‚</li></ul></li><li><p>æ­¤æ—¶ï¼ŒServiceä¸šåŠ¡å±‚å°½é‡æä¾›ä¸€ä¸ªä¸šåŠ¡æ¥å£ï¼Œå³ä½¿ä¸¤ä¸ªå‰ç«¯æ¥å£éœ€è¦çš„æ•°æ®ä¸ä¸€æ ·ï¼ŒServiceå¯ä»¥æä¾›ä¸€ä¸ªæœ€å…¨æŸ¥è¯¢ç»“æœï¼Œç”±Controllerè¿›è¡Œæ•°æ®æ•´åˆã€‚å¦‚ä¸‹å›¾ï¼š</p></li></ul><p><img src="https://picbed1.taoyaopc.live/xczx/wps2-1684559296765-2.jpg" alt="img"> </p><p>2ï¸âƒ£å¦‚æœå‰ç«¯çš„æ¥å£æ²¡æœ‰å¤šæ ·æ€§ä¸”æ¯”è¾ƒå›ºå®šï¼Œæ­¤æ—¶å¯ä»¥å–æ¶ˆVOï¼Œåªç”¨DTOå³å¯ã€‚å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://picbed1.taoyaopc.live/xczx/wps3-1684559296769-3.jpg" alt="img"></p><h3 id="3-3-5-é¢è¯•ï¼šSpringBoot-æ¥å£å¼€å‘çš„æ³¨è§£"><a href="#3-3-5-é¢è¯•ï¼šSpringBoot-æ¥å£å¼€å‘çš„æ³¨è§£" class="headerlink" title="3.3.5 é¢è¯•ï¼šSpringBoot æ¥å£å¼€å‘çš„æ³¨è§£"></a>3.3.5 é¢è¯•ï¼šSpringBoot æ¥å£å¼€å‘çš„æ³¨è§£</h3><div class="table-container"><table><thead><tr><th style="text-align:center">æ³¨è§£</th><th></th></tr></thead><tbody><tr><td style="text-align:center">@Controller</td><td>æ ‡è®°æ­¤ç±»æ˜¯ä¸€ä¸ªæ§åˆ¶å™¨ï¼Œå¯ä»¥è¿”å›è§†å›¾è§£æå™¨æŒ‡å®šçš„ html é¡µé¢ï¼Œé€šè¿‡ @RespongsBody å¯ä»¥å°†ç»“æœè¿”å› jsonã€xmlæ•°æ®ã€‚</td></tr><tr><td style="text-align:center">@Restcontroller</td><td>ç›¸å½“äº @RespongseBody + @Controllerï¼Œå®ç° Rest æ¥å£å¼€å‘ï¼Œè¿”å› json æ•°æ®ï¼Œä¸èƒ½è¿”å› html é¡µé¢</td></tr><tr><td style="text-align:center">@RequestMapping</td><td>å®šä¹‰æ¥å£åœ°å€ï¼Œå¯ä»¥æ ‡è®°åœ¨ç±»ä¸Šä¹Ÿå¯ä»¥æ ‡è®°åœ¨æ–¹æ³•ä¸Šï¼Œæ”¯æŒ http çš„ postã€putã€get ç­‰æ–¹æ³•</td></tr><tr><td style="text-align:center">@GetMapping</td><td>å®šä¹‰ post æ¥å£ï¼Œåªèƒ½æ ‡è®°åœ¨æ–¹æ³•ä¸Šï¼Œç”¨äºæ·»åŠ è®°å½•ã€å¤æ‚æ¡ä»¶çš„æŸ¥è¯¢æ¥å£</td></tr><tr><td style="text-align:center">@PostMapping</td><td>å®šä¹‰ post æ¥å£ï¼Œåªèƒ½æ ‡è®°åœ¨æ–¹æ³•ä¸Šï¼Œç”¨äºæŸ¥è¯¢æ¥å£çš„å®šä¹‰</td></tr><tr><td style="text-align:center">@PutMapping</td><td>å®šä¹‰ put æ¥å£ï¼Œåªèƒ½æ ‡è®°åœ¨æ–¹æ³•ä¸Šï¼Œç”¨äºä¿®æ”¹æ¥å£çš„å®šä¹‰</td></tr><tr><td style="text-align:center">@DeleteMapping</td><td>å®šä¹‰ delete æ¥å£ï¼Œåªèƒ½æ ‡è®°åœ¨æ–¹æ³•ä¸Šï¼Œç”¨äºåˆ é™¤æ¥å£çš„å®šä¹‰</td></tr><tr><td style="text-align:center">@RequestBody</td><td>å®šä¹‰åœ¨æ–¹æ³•ä¸Šï¼Œç”¨äºå°† json ä¸²è½¬æˆ java å¯¹è±¡</td></tr><tr><td style="text-align:center">@PathVarible</td><td>æ¥æ”¶è¯·æ±‚è·¯å¾„ä¸­å ä½ç¬¦çš„å€¼</td></tr><tr><td style="text-align:center">@ApiOperation</td><td>swagger æ³¨è§£ï¼Œå¯¹æ¥å£æ–¹æ³•è¿›è¡Œè¯´æ˜</td></tr><tr><td style="text-align:center">@Api</td><td>swagger æ³¨è§£ï¼Œå¯¹æ¥å£ç±»è¿›è¡Œè¯´æ˜</td></tr><tr><td style="text-align:center">@Autowired</td><td>åŸºäºç±»å‹æ³¨å…¥</td></tr><tr><td style="text-align:center">@Resource</td><td>åŸºäºåç§°æ³¨å…¥ï¼Œå¦‚æœåç§°æ³¨å…¥å¤±è´¥è½¬ä¸ºåŸºäºç±»å‹æ³¨å…¥ã€‚</td></tr></tbody></table></div><h3 id="3-3-6-é¢è¯•ï¼šé¡¹ç›®çš„å¼€å‘æµç¨‹"><a href="#3-3-6-é¢è¯•ï¼šé¡¹ç›®çš„å¼€å‘æµç¨‹" class="headerlink" title="3.3.6 é¢è¯•ï¼šé¡¹ç›®çš„å¼€å‘æµç¨‹"></a>3.3.6 é¢è¯•ï¼šé¡¹ç›®çš„å¼€å‘æµç¨‹</h3><ol><li>äº§å“äººå‘˜è®¾è®¡äº§å“åŸå‹</li><li>è®¨è®ºéœ€æ±‚</li><li>åˆ†æ¨¡å—è®¾è®¡æ¥å£</li><li>ç»™å‡ºæ¥å£æ–‡æ¡£</li><li>å°†æ¥å£æ–‡æ¡£ç»™åˆ°å‰ç«¯äººå‘˜ï¼Œå‰åç«¯åˆ†ç¦»å¼€å‘</li><li>å¼€å‘å®Œæ¯•è¿›è¡Œæµ‹è¯•</li><li>æµ‹è¯•å®Œæ¯•å‘å¸ƒé¡¹ç›®ï¼Œç”±è¿ç»´äººå‘˜è¿›è¡Œéƒ¨ç½²å¼€å‘</li></ol><h2 id="3-4-ç”Ÿæˆæ¥å£æ–‡æ¡£"><a href="#3-4-ç”Ÿæˆæ¥å£æ–‡æ¡£" class="headerlink" title="3.4 ç”Ÿæˆæ¥å£æ–‡æ¡£"></a>3.4 ç”Ÿæˆæ¥å£æ–‡æ¡£</h2><p>åœ¨å‰åç«¯åˆ†ç¦»å¼€å‘ä¸­é€šå¸¸</p><ul><li><p>ç”±åç«¯ç¨‹åºå‘˜è®¾è®¡æ¥å£ï¼Œå®Œæˆåéœ€è¦ç¼–å†™æ¥å£æ–‡æ¡£ï¼Œ</p></li><li><p>æœ€åå°†æ–‡æ¡£äº¤ç»™å‰ç«¯å·¥ç¨‹å¸ˆï¼Œå‰ç«¯å·¥ç¨‹å¸ˆå‚è€ƒæ–‡æ¡£è¿›è¡Œå¼€å‘ã€‚</p></li></ul><blockquote><p>å¯ä»¥é€šè¿‡ä¸€äº›å·¥å…·å¿«é€Ÿç”Ÿæˆæ¥å£æ–‡æ¡£ ï¼Œæœ¬é¡¹ç›®é€šè¿‡Swaggerç”Ÿæˆæ¥å£åœ¨çº¿æ–‡æ¡£ ã€‚</p><p>ä»€ä¹ˆæ˜¯Swaggerï¼Ÿ</p><p>â€‹    OpenAPIè§„èŒƒï¼ˆOpenAPI Specification ç®€ç§°OASï¼‰æ˜¯LinuxåŸºé‡‘ä¼šçš„ä¸€ä¸ªé¡¹ç›®ï¼Œè¯•å›¾é€šè¿‡å®šä¹‰ä¸€ç§ç”¨æ¥æè¿°APIæ ¼å¼æˆ–APIå®šä¹‰çš„è¯­è¨€ï¼Œæ¥è§„èŒƒRESTfulæœåŠ¡å¼€å‘è¿‡ç¨‹ï¼Œç›®å‰ç‰ˆæœ¬æ˜¯V3.0ï¼Œå¹¶ä¸”å·²ç»å‘å¸ƒå¹¶å¼€æºåœ¨githubä¸Šã€‚</p><p>ï¼ˆ<a href="https://github.com/OAI/OpenAPI-Specificationï¼‰">https://github.com/OAI/OpenAPI-Specificationï¼‰</a></p><p>â€‹    Swaggeræ˜¯å…¨çƒæœ€å¤§çš„OpenAPIè§„èŒƒï¼ˆOASï¼‰APIå¼€å‘å·¥å…·æ¡†æ¶ï¼ŒSwaggeræ˜¯ä¸€ä¸ªåœ¨çº¿æ¥å£æ–‡æ¡£çš„ç”Ÿæˆå·¥å…·ï¼Œå‰åç«¯å¼€å‘äººå‘˜ä¾æ®æ¥å£æ–‡æ¡£è¿›è¡Œå¼€å‘ã€‚ (<a href="https://swagger.io/">https://swagger.io/</a>)</p></blockquote><h3 id="3-4-1-Swagger-åŸºæœ¬ä½¿ç”¨"><a href="#3-4-1-Swagger-åŸºæœ¬ä½¿ç”¨" class="headerlink" title="3.4.1 Swagger åŸºæœ¬ä½¿ç”¨"></a>3.4.1 Swagger åŸºæœ¬ä½¿ç”¨</h3><p>Spring Boot å¯ä»¥é›†æˆSwaggerï¼ŒSwaageræ ¹æ®Controllerç±»ä¸­çš„æ³¨è§£ç”Ÿæˆæ¥å£æ–‡æ¡£ ï¼Œåªè¦æ·»åŠ Swaggerçš„ä¾èµ–å’Œé…ç½®ä¿¡æ¯å³å¯ä½¿ç”¨å®ƒã€‚</p><ol><li>åœ¨APIå·¥ç¨‹æ·»åŠ swagger-spring-boot-starterä¾èµ–</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Spring Boot é›†æˆ swagger --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.spring4all<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>swagger-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ol><li>åœ¨ bootstrap.ymlä¸­é…ç½®swaggerçš„æ‰«æåŒ…è·¯å¾„åŠå…¶å®ƒä¿¡æ¯ï¼Œbase-packageä¸ºæ‰«æçš„åŒ…è·¯å¾„ï¼Œæ‰«æControllerç±»ã€‚</li></ol><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">swagger:</span></span><br><span class="line">  <span class="attr">title:</span> <span class="string">&quot;å­¦æˆåœ¨çº¿å†…å®¹ç®¡ç†ç³»ç»Ÿ&quot;</span></span><br><span class="line">  <span class="attr">description:</span> <span class="string">&quot;å†…å®¹ç³»ç»Ÿç®¡ç†ç³»ç»Ÿå¯¹è¯¾ç¨‹ç›¸å…³ä¿¡æ¯è¿›è¡Œç®¡ç†&quot;</span></span><br><span class="line">  <span class="attr">base-package:</span> <span class="string">com.xuecheng.content</span></span><br><span class="line">  <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">version:</span> <span class="number">1.0</span><span class="number">.0</span></span><br><span class="line">  </span><br></pre></td></tr></table></figure><ol><li>åœ¨å¯åŠ¨ç±»ä¸­æ·»åŠ @EnableSwagger2Docæ³¨è§£,<ul><li>å†æ¬¡å¯åŠ¨æœåŠ¡ï¼Œå·¥ç¨‹å¯åŠ¨èµ·æ¥ï¼Œè®¿é—®<a href="http://localhost:63040/content/swagger-ui.htmlæŸ¥çœ‹æ¥å£ä¿¡æ¯">http://localhost:63040/content/swagger-ui.htmlæŸ¥çœ‹æ¥å£ä¿¡æ¯</a>, ä¸‹å›¾ä¸ºswaggeræ¥å£æ–‡æ¡£çš„ç•Œé¢ï¼š</li></ul></li></ol><p><img src="https://picbed1.taoyaopc.live/xczx/wps1-1684594752034-1.jpg" alt="img"> </p><h3 id="3-4-2-Swagger-å¸¸ç”¨æ³¨è§£"><a href="#3-4-2-Swagger-å¸¸ç”¨æ³¨è§£" class="headerlink" title="3.4.2 Swagger å¸¸ç”¨æ³¨è§£"></a>3.4.2 Swagger å¸¸ç”¨æ³¨è§£</h3><p>åœ¨Javaç±»ä¸­æ·»åŠ Swaggerçš„æ³¨è§£å³å¯ç”ŸæˆSwaggeræ¥å£ï¼Œå¸¸ç”¨Swaggeræ³¨è§£å¦‚ä¸‹ï¼š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">@Apiï¼šä¿®é¥°æ•´ä¸ªç±»ï¼Œæè¿°Controllerçš„ä½œç”¨</span></span><br><span class="line"> <span class="string">@ApiOperationï¼šæè¿°ä¸€ä¸ªç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œæˆ–è€…è¯´ä¸€ä¸ªæ¥å£</span></span><br><span class="line"> <span class="string">@ApiParamï¼šå•ä¸ªå‚æ•°æè¿°</span></span><br><span class="line"> <span class="string">@ApiModelï¼šç”¨å¯¹è±¡æ¥æ¥æ”¶å‚æ•°</span></span><br><span class="line"> <span class="string">@ApiModelPropertyï¼šç”¨å¯¹è±¡æ¥æ”¶å‚æ•°æ—¶ï¼Œæè¿°å¯¹è±¡çš„ä¸€ä¸ªå­—æ®µ</span></span><br><span class="line"> <span class="string">@ApiResponseï¼šHTTPå“åº”å…¶ä¸­1ä¸ªæè¿°</span></span><br><span class="line"> <span class="string">@ApiResponsesï¼šHTTPå“åº”æ•´ä½“æè¿°</span></span><br><span class="line"> <span class="string">@ApiIgnoreï¼šä½¿ç”¨è¯¥æ³¨è§£å¿½ç•¥è¿™ä¸ªAPI</span></span><br><span class="line"> <span class="string">@ApiError</span> <span class="string">ï¼šå‘ç”Ÿé”™è¯¯è¿”å›çš„ä¿¡æ¯</span></span><br><span class="line"> <span class="string">@ApiImplicitParamï¼šä¸€ä¸ªè¯·æ±‚å‚æ•°</span></span><br><span class="line"> <span class="string">@ApiImplicitParamsï¼šå¤šä¸ªè¯·æ±‚å‚æ•°</span></span><br></pre></td></tr></table></figure><p>1ï¸âƒ£@ApiImplicitParamå±æ€§å¦‚ä¸‹ï¼š</p><div class="table-container"><table><thead><tr><th>å±æ€§</th><th>å–å€¼</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>paramType</td><td></td><td>æŸ¥è¯¢å‚æ•°ç±»å‹</td></tr><tr><td></td><td>path</td><td>ä»¥åœ°å€çš„å½¢å¼æäº¤æ•°æ®</td></tr><tr><td></td><td>query</td><td>ç›´æ¥è·Ÿå‚æ•°å®Œæˆè‡ªåŠ¨æ˜ å°„èµ‹å€¼</td></tr><tr><td></td><td>body</td><td>ä»¥æµçš„å½¢å¼æäº¤ ä»…æ”¯æŒPOST</td></tr><tr><td></td><td>header</td><td>å‚æ•°åœ¨request headers é‡Œè¾¹æäº¤</td></tr><tr><td></td><td>form</td><td>ä»¥formè¡¨å•çš„å½¢å¼æäº¤ ä»…æ”¯æŒPOST</td></tr><tr><td>dataType</td><td></td><td>å‚æ•°çš„æ•°æ®ç±»å‹ åªä½œä¸ºæ ‡å¿—è¯´æ˜ï¼Œå¹¶æ²¡æœ‰å®é™…éªŒè¯</td></tr><tr><td></td><td>Long</td><td></td></tr><tr><td></td><td>String</td><td></td></tr><tr><td>name</td><td></td><td>æ¥æ”¶å‚æ•°å</td></tr><tr><td>value</td><td></td><td>æ¥æ”¶å‚æ•°çš„æ„ä¹‰æè¿°</td></tr><tr><td>required</td><td></td><td>å‚æ•°æ˜¯å¦å¿…å¡«</td></tr><tr><td></td><td>true</td><td>å¿…å¡«</td></tr><tr><td></td><td>false</td><td>éå¿…å¡«</td></tr><tr><td>defaultValue</td><td></td><td>é»˜è®¤å€¼</td></tr></tbody></table></div><h3 id="3-4-3-ä½¿ç”¨Swaggerå¯ä»¥è¿›è¡Œæ¥å£æµ‹è¯•ã€‚"><a href="#3-4-3-ä½¿ç”¨Swaggerå¯ä»¥è¿›è¡Œæ¥å£æµ‹è¯•ã€‚" class="headerlink" title="3.4.3 ä½¿ç”¨Swaggerå¯ä»¥è¿›è¡Œæ¥å£æµ‹è¯•ã€‚"></a>3.4.3 ä½¿ç”¨Swaggerå¯ä»¥è¿›è¡Œæ¥å£æµ‹è¯•ã€‚</h3><ol><li>ä¿®æ”¹æ¥å£å†…å®¹ï¼Œæ·»åŠ ä¸€äº›æµ‹è¯•ä»£ç  </li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Java</span><br><span class="line"><span class="meta">@ApiOperation(&quot;è¯¾ç¨‹æŸ¥è¯¢æ¥å£&quot;)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/course/list&quot;)</span></span><br><span class="line"><span class="keyword">public</span> PageResult&lt;CourseBase&gt; <span class="title function_">list</span><span class="params">(PageParams pageParams, <span class="meta">@RequestBody(required=false)</span> QueryCourseParamsDto queryCourseParams)</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">CourseBase</span> <span class="variable">courseBase</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CourseBase</span>();</span><br><span class="line">    courseBase.setName(<span class="string">&quot;æµ‹è¯•åç§°&quot;</span>);</span><br><span class="line">    courseBase.setCreateDate(LocalDateTime.now());</span><br><span class="line">    List&lt;CourseBase&gt; courseBases = <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line">    courseBases.add(courseBase);</span><br><span class="line">    <span class="type">PageResult</span> <span class="variable">pageResult</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PageResult</span>&lt;CourseBase&gt;(courseBases,<span class="number">10</span>,<span class="number">1</span>,<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">return</span> pageResult;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>debugæ–¹å¼å¯åŠ¨ï¼Œåœ¨ return å¤„æ‰“æ–­ç‚¹ï¼Œå†ç”¨swaggerè¯·æ±‚æ¥å£ã€‚é€šè¿‡ä¸‹å›¾å¯ä»¥çœ‹åˆ°è¯·æ±‚å‚æ•°å·²ç»æ­£å¸¸è¯·æ±‚è‡³controlleræ–¹æ³•</li></ol><p><img src="https://picbed1.taoyaopc.live/xczx/wps5-1684594752035-4.jpg" alt="img"> </p><ol><li>æ”¾è¡Œç»§ç»­è¿è¡Œï¼Œè§‚å¯Ÿswaggerç•Œé¢ï¼Œç»“æœå¯ä»¥æ­£å¸¸è¿”å›</li></ol><p><img src="https://picbed1.taoyaopc.live/xczx/wps6-1684594752036-6.jpg" alt="img"> </p><ul><li>ä¸è¿‡å­˜åœ¨ä¸€ä¸ªé—®é¢˜å°±æ˜¯LocalDateTimeç±»å‹çš„æ•°æ®è½¬jsonåæ•°æ®æ ¼å¼å¹¶ä¸æ˜¯æˆ‘ä»¬è¦çš„å¹´æœˆæ—¥æ—¶åˆ†ç§’</li></ul><blockquote><p>åœ¨baseå·¥ç¨‹com.xuecheng.base.configåŒ…ä¸‹åŠ é…ç½®LocalDateTimeConfig ç±»å®ç°è½¬jsonæ—¶å­—ç¬¦ä¸²ä¸LocalDateTimeç±»å‹çš„è½¬æ¢ï¼ŒLocalDateTimeConfig ç±»å¯ä»è¯¾ç¨‹èµ„æ–™ä¸‹çš„é¡¹ç›®å·¥ç¨‹ç›®å½•ä¸­ç›´æ¥æ‹·è´</p></blockquote><h2 id="3-5-å¼€å‘æŒä¹…å±‚"><a href="#3-5-å¼€å‘æŒä¹…å±‚" class="headerlink" title="3.5 å¼€å‘æŒä¹…å±‚"></a>3.5 å¼€å‘æŒä¹…å±‚</h2><h3 id="3-5-1-ç”Ÿæˆ-mapper"><a href="#3-5-1-ç”Ÿæˆ-mapper" class="headerlink" title="3.5.1 ç”Ÿæˆ mapper"></a>3.5.1 ç”Ÿæˆ mapper</h3><p>æœ¬é¡¹ç›®ä½¿ç”¨MyBatis-Pluså¼€å‘æŒä¹…å±‚ï¼Œ</p><ul><li>éœ€è¦åˆ›å»ºPOç±»ã€Mapperæ¥å£ã€Mapperçš„xmlæ–‡ä»¶ï¼Œ</li><li>æ¯ä¸ªPOç±»å¯¹åº”æ•°æ®åº“çš„æ¯å¼ è¡¨ï¼Œæ¯å¼ è¡¨éœ€è¦åˆ›å»ºä¸€ä¸ªMapperæ¥å£å’ŒMapperçš„xmlæ˜ å°„æ–‡ä»¶ ã€‚</li><li>ä½¿ç”¨ generator å·¥ç¨‹ç”Ÿæˆçš„ mapper æ¥å£å’Œ mapper æ˜ å°„æ–‡ä»¶æ‹·è´åˆ° service å·¥ç¨‹</li><li>serviceå·¥ç¨‹å³ä¸šåŠ¡å±‚ä¸ºapiæ¥å£å·¥ç¨‹æä¾›ä¸šåŠ¡å¤„ç†æ”¯æ’‘ï¼Œæœ¬é¡¹ç›®ä¸šåŠ¡å±‚åŒ…æ‹¬äº†æŒä¹…å±‚çš„ä»£ç ï¼Œ</li><li>ä¸€äº›å¤§å‹å…¬å¸çš„å›¢é˜ŸèŒè´£åˆ’åˆ†æ›´ç»†ï¼Œä¼šå°†æŒä¹…å±‚å’Œä¸šåŠ¡å±‚åˆ†ä¸ºä¸¤ä¸ªå·¥ç¨‹ï¼Œä¸è¿‡è¿™éœ€è¦å¢åŠ æˆæœ¬ã€‚</li></ul><h3 id="3-5-2-æµ‹è¯•-Mapper"><a href="#3-5-2-æµ‹è¯•-Mapper" class="headerlink" title="3.5.2 æµ‹è¯• Mapper"></a>3.5.2 æµ‹è¯• Mapper</h3><p>1ï¸âƒ£ä¸‹è¾¹å¯¹mapperè¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œæµ‹è¯•course_baseè¡¨çš„æŸ¥è¯¢æ¥å£ã€‚</p><ol><li>ä¸‹è¾¹åœ¨serviceå·¥ç¨‹çš„pom.xmlä¸­æ·»åŠ ä¾èµ–</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">XML</span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xuecheng<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xuecheng-plus-content-model<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- MySQL é©±åŠ¨ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- mybatis plusçš„ä¾èµ– --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Spring Boot é›†æˆ Junit --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æ’é™¤ Spring Boot ä¾èµ–çš„æ—¥å¿—åŒ…å†²çª --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Spring Boot é›†æˆ log4j2 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-log4j2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><ol><li>é…ç½®æ‰«æmapperåŠåˆ†é¡µæ’ä»¶</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.content.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.DbType;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.autoconfigure.ConfigurationCustomizer;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.inner.PaginationInnerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.annotation.MapperScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;P&gt;</span></span><br><span class="line"><span class="comment"> *        Mybatis-Plus é…ç½®</span></span><br><span class="line"><span class="comment"> * &lt;/p&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;com.xuecheng.content.mapper&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisPlusConfig</span> &#123;</span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * å®šä¹‰åˆ†é¡µæ‹¦æˆªå™¨</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="meta">@Bean</span></span><br><span class="line">   <span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">mybatisPlusInterceptor</span><span class="params">()</span> &#123;</span><br><span class="line">      <span class="type">MybatisPlusInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line">      interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">PaginationInnerInterceptor</span>(DbType.MYSQL));</span><br><span class="line">      <span class="keyword">return</span> interceptor;</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åˆ†é¡µæ’ä»¶çš„åŸç†ï¼š</p><p>é¦–å…ˆåˆ†é¡µå‚æ•°æ”¾åˆ°ThreadLocalä¸­ï¼Œæ‹¦æˆªæ‰§è¡Œçš„sqlï¼Œæ ¹æ®æ•°æ®åº“ç±»å‹æ·»åŠ å¯¹åº”çš„åˆ†é¡µè¯­å¥é‡å†™sqlï¼Œä¾‹å¦‚ï¼š(select <em> from table where a) è½¬æ¢ä¸º (select count(</em>) from table where a)å’Œ(select * from table where a limit ,)</p><p>è®¡ç®—å‡ºäº†totalæ€»æ¡æ•°ã€pageNumå½“å‰ç¬¬å‡ é¡µã€pageSizeæ¯é¡µå¤§å°å’Œå½“å‰é¡µçš„æ•°æ®ï¼Œæ˜¯å¦ä¸ºé¦–é¡µï¼Œæ˜¯å¦ä¸ºå°¾é¡µï¼Œæ€»é¡µæ•°ç­‰ã€‚</p></blockquote><ol><li>å•å…ƒæµ‹è¯•æ‰€éœ€è¦çš„é…ç½®æ–‡ä»¶<ul><li>åœ¨test/resourcesä¸‹åˆ›å»º log4j2-dev.xmlã€bootstrap.ymlï¼š</li><li>log4j2-dev.xml ä»èµ„æ–™ä¸­è·å–</li></ul></li></ol><p><img src="https://picbed1.taoyaopc.live/xczx/image-20230521104532439.png" alt="image-20230521104532439" style="zoom: 67%;" /></p><p>bootstap.yml</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/xcplus_content?serverTimezone=UTC&amp;userUnicode=true&amp;useSSL=false&amp;</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">mysql</span></span><br><span class="line"><span class="comment"># æ—¥å¿—æ–‡ä»¶é…ç½®è·¯å¾„</span></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">config:</span> <span class="string">classpath:log4j2-dev.xml</span></span><br></pre></td></tr></table></figure><ol><li>ç¼–å†™å¯åŠ¨ç±»</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Java</span><br><span class="line"><span class="keyword">package</span> com.xuecheng;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ContentApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(ContentApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>ç¼–å†™æµ‹è¯•ç±»</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.content;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.Page;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.base.model.PageParams;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.base.model.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.mapper.CourseBaseMapper;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.model.dto.QueryCourseParamsDto;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.model.po.CourseBase;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Assertions;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CourseBaseMapperTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    CourseBaseMapper courseBaseMapper;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testCourseBaseMapper</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">CourseBase</span> <span class="variable">courseBase</span> <span class="operator">=</span> courseBaseMapper.selectById(<span class="number">74L</span>);</span><br><span class="line">        Assertions.assertNotNull(courseBase);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æµ‹è¯•æŸ¥è¯¢æ¥å£</span></span><br><span class="line">        LambdaQueryWrapper&lt;CourseBase&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//æŸ¥è¯¢æ¡ä»¶</span></span><br><span class="line">        <span class="type">QueryCourseParamsDto</span> <span class="variable">queryCourseParamsDto</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryCourseParamsDto</span>();</span><br><span class="line">        queryCourseParamsDto.setCourseName(<span class="string">&quot;java&quot;</span>);</span><br><span class="line">        queryCourseParamsDto.setAuditStatus(<span class="string">&quot;202004&quot;</span>);</span><br><span class="line">        queryCourseParamsDto.setPublishStatus(<span class="string">&quot;203001&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ‹¼æ¥æŸ¥è¯¢æ¡ä»¶</span></span><br><span class="line">        <span class="comment">//æ ¹æ®è¯¾ç¨‹åç§°æ¨¡ç³ŠæŸ¥è¯¢  name like &#x27;%åç§°%&#x27;</span></span><br><span class="line">        queryWrapper.like(StringUtils.isNotEmpty(queryCourseParamsDto.getCourseName()),CourseBase::getName,queryCourseParamsDto.getCourseName());</span><br><span class="line">        <span class="comment">//æ ¹æ®è¯¾ç¨‹å®¡æ ¸çŠ¶æ€</span></span><br><span class="line">        queryWrapper.eq(StringUtils.isNotEmpty(queryCourseParamsDto.getAuditStatus()),CourseBase::getAuditStatus,queryCourseParamsDto.getAuditStatus());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ†é¡µå‚æ•°</span></span><br><span class="line">        <span class="type">PageParams</span> <span class="variable">pageParams</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PageParams</span>();</span><br><span class="line">        pageParams.setPageNo(<span class="number">1L</span>);<span class="comment">//é¡µç </span></span><br><span class="line">        pageParams.setPageSize(<span class="number">3L</span>);<span class="comment">//æ¯é¡µè®°å½•æ•°</span></span><br><span class="line">        Page&lt;CourseBase&gt; page = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(pageParams.getPageNo(), pageParams.getPageSize());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ†é¡µæŸ¥è¯¢E page åˆ†é¡µå‚æ•°, @Param(&quot;ew&quot;) Wrapper&lt;T&gt; queryWrapper æŸ¥è¯¢æ¡ä»¶</span></span><br><span class="line">        Page&lt;CourseBase&gt; pageResult = courseBaseMapper.selectPage(page, queryWrapper);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ•°æ®</span></span><br><span class="line">        List&lt;CourseBase&gt; items = pageResult.getRecords();</span><br><span class="line">        <span class="comment">//æ€»è®°å½•æ•°</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">total</span> <span class="operator">=</span> pageResult.getTotal();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å‡†å¤‡è¿”å›æ•°æ® List&lt;T&gt; items, long counts, long page, long pageSize</span></span><br><span class="line">        PageResult&lt;CourseBase&gt; courseBasePageResult = <span class="keyword">new</span> <span class="title class_">PageResult</span>&lt;&gt;(items, total, pageParams.getPageNo(), pageParams.getPageSize());</span><br><span class="line">        System.out.println(courseBasePageResult);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-5-3-æµ‹è¯•-Sql-è¯­å¥æŠ€å·§"><a href="#3-5-3-æµ‹è¯•-Sql-è¯­å¥æŠ€å·§" class="headerlink" title="3.5.3 æµ‹è¯• Sql è¯­å¥æŠ€å·§"></a>3.5.3 æµ‹è¯• Sql è¯­å¥æŠ€å·§</h3><p>æŠŠ Java æ§åˆ¶å°è¾“å‡ºçš„ Sql è¯­å¥å¤åˆ¶ç²˜è´´åˆ°æ•°æ®åº“ç¼–è¾‘è½¯ä»¶ï¼ˆNavicatã€DataGripï¼‰ï¼Œä¿®æ”¹å¹¶è¿è¡Œè¿›è¡Œæµ‹è¯•ï¼ŒæŸ¥çœ‹è¿è¡Œç»“æœã€‚</p><h2 id="3-6-å¼€å‘ä¸šåŠ¡å±‚"><a href="#3-6-å¼€å‘ä¸šåŠ¡å±‚" class="headerlink" title="3.6 å¼€å‘ä¸šåŠ¡å±‚"></a>3.6 å¼€å‘ä¸šåŠ¡å±‚</h2><h3 id="3-6-1-åˆ›å»ºæ•°æ®å­—å…¸è¡¨"><a href="#3-6-1-åˆ›å»ºæ•°æ®å­—å…¸è¡¨" class="headerlink" title="3.6.1 åˆ›å»ºæ•°æ®å­—å…¸è¡¨"></a>3.6.1 åˆ›å»ºæ•°æ®å­—å…¸è¡¨</h3><p>1ï¸âƒ£è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯æŸ¥è¯¢çš„ä¸»è¦æ•°æ®æ¥æºæ˜¯è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯è¡¨ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªç‚¹éœ€è¦æ³¨æ„ï¼Œå°±æ˜¯è¯¾ç¨‹çš„å®¡æ ¸çŠ¶æ€ã€å‘å¸ƒçŠ¶æ€ã€‚</p><ul><li>å®¡æ ¸çŠ¶æ€åœ¨æŸ¥è¯¢æ¡ä»¶å’ŒæŸ¥è¯¢ç»“æœä¸­éƒ½å­˜åœ¨ï¼Œå®¡æ ¸çŠ¶æ€åŒ…æ‹¬ï¼šæœªå®¡æ ¸ã€å®¡æ ¸é€šè¿‡ã€å®¡æ ¸æœªé€šè¿‡ä¸‰ç§ï¼Œ</li><li><p>ä¸‹è¾¹æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šä¸€ä¸ªè¯¾ç¨‹çš„å®¡æ ¸çŠ¶æ€å¦‚æœæ˜¯â€œå®¡æ ¸æœªé€šè¿‡â€é‚£ä¹ˆåœ¨è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯è¡¨è®°å½•â€œå®¡æ ¸æœªé€šè¿‡â€ä¸‰ä¸ªå­—åˆé€‚å—ï¼Ÿ</p><ul><li>å¦‚æœå°†â€œå®¡æ ¸æœªé€šè¿‡â€äº”ä¸ªå­—è®°å½•åœ¨è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯è¡¨ä¸­ï¼Œæ˜¾ç¤ºå‡ºæ¥çš„å®¡æ ¸çŠ¶æ€å°±æ˜¯â€œå®¡æ ¸æœªé€šè¿‡â€è¿™äº”ä¸ªå­—ï¼Œçœ‹èµ·æ¥æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œ</li><li>å¦‚æœæœ‰ä¸€å¤©å®¢æˆ·æƒ³è¦å°†å®¡æ ¸æœªé€šè¿‡çš„è®°å½•åœ¨æ˜¾ç¤ºæ—¶æ”¹ä¸ºâ€œæœªé€šè¿‡â€ä¸‰ä¸ªå­—ï¼Œæ€ä¹ˆåŠï¼Ÿ</li></ul></li><li><p>è¿™æ—¶ä½ å¯ä»¥éœ€è¦æ‰¹é‡å¤„ç†æ•°æ®åº“ä¸­è®°å½•äº†ï¼Œå†™ä¸€ä¸ª update è¯­å¥ï¼Œå®¡æ ¸çŠ¶æ€ç­‰äºâ€œå®¡æ ¸æœªé€šè¿‡â€çš„å…¨éƒ¨æ›´æ–° ä¸ºâ€œæœªé€šè¿‡â€ã€‚</p></li><li>çœ‹èµ·æ¥è§£å†³äº†é—®é¢˜ï¼Œå¦‚æœæœ‰ä¸€å¤©å®¢æˆ·åˆè®©æ”¹äº†å‘¢ï¼Ÿ</li></ul><p>å’Œå®¡æ ¸çŠ¶æ€åŒç±»çš„æœ‰å¥½å¤šè¿™æ ·çš„ä¿¡æ¯ï¼Œ</p><ul><li>æ¯”å¦‚ï¼šè¯¾ç¨‹çŠ¶æ€ã€è¯¾ç¨‹ç±»å‹ã€ç”¨æˆ·ç±»å‹ç­‰ç­‰ï¼Œ</li><li>è¿™ä¸€ç±»æ•°æ®æœ‰ä¸€ä¸ªå…±åŒç‚¹å°±æ˜¯å®ƒæœ‰ä¸€äº›åˆ†ç±»é¡¹ï¼Œä¸”è¿™äº›åˆ†ç±»é¡¹è¾ƒä¸ºå›ºå®šã€‚</li><li>é’ˆå¯¹è¿™äº›æ•°æ®ï¼Œä¸ºäº†æé«˜ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ï¼Œä¸“é—¨å®šä¹‰æ•°æ®å­—å…¸è¡¨å»ç»´æŠ¤ã€‚æ¯ä¸€é¡¹éƒ½ç”±ä»£ç å’Œåç§°ç»„æˆã€‚</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;code&quot;</span><span class="punctuation">:</span><span class="string">&quot;202001&quot;</span><span class="punctuation">,</span><span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span><span class="string">&quot;å®¡æ ¸æœªé€šè¿‡&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;code&quot;</span><span class="punctuation">:</span><span class="string">&quot;202002&quot;</span><span class="punctuation">,</span><span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span><span class="string">&quot;æœªå®¡æ ¸&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span><span class="attr">&quot;code&quot;</span><span class="punctuation">:</span><span class="string">&quot;202003&quot;</span><span class="punctuation">,</span><span class="attr">&quot;desc&quot;</span><span class="punctuation">:</span><span class="string">&quot;å®¡æ ¸é€šè¿‡&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure><p>è¯¥è¯¾ç¨‹çš„å®¡æ ¸çŠ¶æ€ä¸ºå®¡æ ¸æœªé€šè¿‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯è¡¨å­˜å‚¨202001ï¼Œä¹Ÿå°±æ˜¯å®¡æ ¸æœªé€šè¿‡å¯¹åº”çš„ä»£ç ï¼Œè¿™æ ·æŸ¥è¯¢å‡ºçš„æ•°æ®åœ¨å‰ç«¯å±•ç¤ºæ—¶æ ¹æ®ä»£ç å–å‡ºå®ƒå¯¹åº”çš„å†…å®¹æ˜¾ç¤ºç»™ç”¨æˆ·ã€‚å¦‚æœç”¨æˆ·è¦ä¿®æ”¹â€œå®¡æ ¸æœªé€šè¿‡â€çš„æ˜¾ç¤ºå†…å®¹åªéœ€è¦åœ¨æ•°æ®å­—å…¸è¡¨ä¿®æ”¹ï¼Œæ— æ³•ä¿®æ”¹è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯è¡¨ã€‚</p><p>2ï¸âƒ£æ•°æ®å­—å…¸è¡¨åœ¨ç³»ç»Ÿç®¡ç†æ•°æ®åº“ä¸­å­˜å‚¨ï¼Œé¦–å…ˆå¯¼å…¥ç³»ç»Ÿç®¡ç†æ•°æ®åº“ï¼Œåˆ›å»ºç³»ç»Ÿç®¡ç†æœåŠ¡çš„æ•°æ®åº“ <code>xuecheng_system</code></p><ul><li>åˆ›å»ºæˆ–å¯¼å…¥ directory è¡¨</li></ul><p><img src="https://picbed1.taoyaopc.live/xczx/image-20230521110402727.png" alt="image-20230521110402727" style="zoom:67%;" /></p><h3 id="3-6-2-ç¼–å†™-service"><a href="#3-6-2-ç¼–å†™-service" class="headerlink" title="3.6.2 ç¼–å†™ service"></a>3.6.2 ç¼–å†™ service</h3><ol><li>åˆ›å»º Service æ¥å£</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.content.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.xuecheng.base.model.PageParams;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.base.model.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.model.dto.QueryCourseParamsDto;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.model.po.CourseBase;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è¯¾ç¨‹ä¿¡æ¯ç®¡ç†æ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/21 11:05</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">CourseBaseInfoService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯¾ç¨‹åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> pageParams åˆ†é¡µæŸ¥è¯¢å‚æ•°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> courseParamsDto åˆ†é¡µæ¡ä»¶</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> åˆ†é¡µç»“æœ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    PageResult&lt;CourseBase&gt; <span class="title function_">queryCourseBaseList</span><span class="params">(PageParams pageParams, QueryCourseParamsDto courseParamsDto)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol><li>ç¼–å†™ Service æ¥å£å®ç°ç±»</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.content.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.Page;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.base.model.PageParams;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.base.model.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.mapper.CourseBaseMapper;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.model.dto.QueryCourseParamsDto;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.model.po.CourseBase;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.service.CourseBaseInfoService;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> TODO</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/21 11:08</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CourseBaseInfoServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">CourseBaseInfoService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">public</span> CourseBaseMapper courseBaseMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> PageResult&lt;CourseBase&gt; <span class="title function_">queryCourseBaseList</span><span class="params">(PageParams pageParams, QueryCourseParamsDto courseParamsDto)</span> &#123;</span><br><span class="line">        <span class="comment">// æ‹¼è£…æŸ¥è¯¢æ¡ä»¶</span></span><br><span class="line">        LambdaQueryWrapper&lt;CourseBase&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">// æ ¹æ®åç§°æ¨¡ç³ŠæŸ¥è¯¢</span></span><br><span class="line">        queryWrapper.like(StringUtils.isNotEmpty(courseParamsDto.getCourseName()), CourseBase::getName, courseParamsDto.getCourseName());</span><br><span class="line">        <span class="comment">// æ ¹æ®è¯¾ç¨‹å®¡æ ¸çŠ¶æ€æŸ¥è¯¢</span></span><br><span class="line">        queryWrapper.eq(StringUtils.isNotEmpty(courseParamsDto.getAuditStatus()), CourseBase::getAuditStatus, courseParamsDto.getAuditStatus());</span><br><span class="line">        <span class="comment">// æ ¹æ®è¯¾ç¨‹å‘å¸ƒçŠ¶æ€æŸ¥è¯¢</span></span><br><span class="line">        queryWrapper.eq(StringUtils.isNotEmpty(courseParamsDto.getPublishStatus()), CourseBase::getStatus, courseParamsDto.getPublishStatus());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ›å»ºpageåˆ†é¡µå‚æ•°å¯¹è±¡ï¼Œå‚æ•°ï¼šå½“å‰é¡µç ï¼Œæ¯é¡µè®°å½•æ•°</span></span><br><span class="line">        Page&lt;CourseBase&gt; page = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(pageParams.getPageNo(), pageParams.getPageSize());</span><br><span class="line">        <span class="comment">// å¼€å§‹åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line">        Page&lt;CourseBase&gt; pageResult = courseBaseMapper.selectPage(page, queryWrapper);</span><br><span class="line">        <span class="comment">// æ•°æ®åˆ—è¡¨</span></span><br><span class="line">        List&lt;CourseBase&gt; items = pageResult.getRecords();</span><br><span class="line">        <span class="comment">// æ€»è®°å½•æ•°</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">total</span> <span class="operator">=</span> pageResult.getTotal();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// List&lt;T&gt; items, long counts, long page, long pageSize</span></span><br><span class="line">        PageResult&lt;CourseBase&gt; courseBasePageResult = <span class="keyword">new</span> <span class="title class_">PageResult</span>&lt;&gt;(items, total, pageParams.getPageNo(), pageParams.getPageSize());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> courseBasePageResult;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-6-3-æµ‹è¯•-Service"><a href="#3-6-3-æµ‹è¯•-Service" class="headerlink" title="3.6.3 æµ‹è¯• Service"></a>3.6.3 æµ‹è¯• Service</h3><ol><li>ç¼–å†™å•å…ƒæµ‹è¯•ç±»</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.content;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.Page;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.base.model.PageParams;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.base.model.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.mapper.CourseBaseMapper;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.model.dto.QueryCourseParamsDto;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.model.po.CourseBase;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.service.CourseBaseInfoService;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Assertions;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> TODO</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/21 10:15</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CourseBaseInfoServiceTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    CourseBaseInfoService courseBaseInfoService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testCourseBaseMapper</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">QueryCourseParamsDto</span> <span class="variable">courseParamsDto</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">QueryCourseParamsDto</span>();</span><br><span class="line">        courseParamsDto.setCourseName(<span class="string">&quot;java&quot;</span>);</span><br><span class="line">        <span class="comment">//courseParamsDto.setAuditStatus(&quot;202004&quot;);</span></span><br><span class="line">        courseParamsDto.setPublishStatus(<span class="string">&quot;203002&quot;</span>); <span class="comment">// è¯¾ç¨‹å·²å‘å¸ƒ</span></span><br><span class="line"></span><br><span class="line">        <span class="type">PageParams</span> <span class="variable">pageParams</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PageParams</span>();</span><br><span class="line">        pageParams.setPageNo(<span class="number">1L</span>);</span><br><span class="line">        pageParams.setPageSize(<span class="number">2L</span>);</span><br><span class="line"></span><br><span class="line">        PageResult&lt;CourseBase&gt; courseBasePageResult = courseBaseInfoService.queryCourseBaseList(pageParams, courseParamsDto);</span><br><span class="line">        System.out.println(courseBasePageResult);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-6-æ¥å£æµ‹è¯•"><a href="#3-6-æ¥å£æµ‹è¯•" class="headerlink" title="3.6 æ¥å£æµ‹è¯•"></a>3.6 æ¥å£æµ‹è¯•</h2><h3 id="3-7-1-æ¥å£å®Œå–„"><a href="#3-7-1-æ¥å£å®Œå–„" class="headerlink" title="3.7.1 æ¥å£å®Œå–„"></a>3.7.1 æ¥å£å®Œå–„</h3><p>æ§åˆ¶å±‚ã€ä¸šåŠ¡å±‚ä»¥åŠæŒä¹…å±‚ä¸‰å±‚é€šå¸¸å¯ä»¥é¢å‘æ¥å£å¹¶è¡Œå¼€å‘ï¼Œ</p><ul><li>æ¯”å¦‚ï¼šä¸šåŠ¡å±‚å¼€å‘çš„åŒäº‹å¯ä»¥å…ˆåªç¼–å†™ä¸€ä¸ªServiceæ¥å£ï¼Œæ¥å£å±‚çš„åŒäº‹å³å¯é¢å‘Serviceæ¥å£å»å¼€å‘ï¼Œ</li><li>å¾…æ¥å£å±‚å’Œä¸šåŠ¡å±‚å®Œæˆåè¿›è¡Œè¿è°ƒã€‚</li></ul><p>ä¸‹è¾¹è¯¾ç¨‹æŸ¥è¯¢æ¥å£çš„å®ç°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Api(value = &quot;è¯¾ç¨‹ä¿¡æ¯ç®¡ç†æ¥å£&quot;, tags = &quot;è¯¾ç¨‹ä¿¡æ¯ç®¡ç†æ¥å£&quot;)</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CourseBaseInfoController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    CourseBaseInfoService courseBaseInfoService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;è¯¾ç¨‹æŸ¥è¯¢æ¥å£&quot;)</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/course/list&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> PageResult&lt;CourseBase&gt; <span class="title function_">list</span><span class="params">(PageParams pageParams, <span class="meta">@RequestBody(required = false)</span> QueryCourseParamsDto queryCourseParamsDto)</span> &#123;</span><br><span class="line"></span><br><span class="line">        PageResult&lt;CourseBase&gt; courseBasePageResult = courseBaseInfoService.queryCourseBaseList(pageParams, queryCourseParamsDto);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> courseBasePageResult;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ­¤æ—¶è¿›å…¥ swagger  æ§åˆ¶å°<code>http://localhost:63040/content/swagger-ui.html</code>ï¼Œè¾“å…¥æµ‹è¯•æ•°æ®ï¼Œå³å¯å¿«é€Ÿæµ‹è¯•æ¥å£</li></ul><p><img src="https://picbed1.taoyaopc.live/xczx/image-20230522160501098.png" alt="image-20230522160501098"></p><h3 id="3-7-2-Httpclient-æµ‹è¯•"><a href="#3-7-2-Httpclient-æµ‹è¯•" class="headerlink" title="3.7.2 Httpclient æµ‹è¯•"></a>3.7.2 Httpclient æµ‹è¯•</h3><p>é«˜ç‰ˆæœ¬çš„ Idea è‡ªå¸¦çš„æµ‹è¯•å·¥å…·</p><p><img src="https://picbed1.taoyaopc.live/xczx/image-20230522160741852.png" alt="image-20230522160741852"></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">### æŸ¥è¯¢è¯¾ç¨‹ä¿¡æ¯</span><br><span class="line">POST http://localhost:63040/content/course/list?pageNo=1&amp;pageSize=2</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;auditStatus&quot;: &quot;202004&quot;,</span><br><span class="line">  &quot;courseName&quot;: &quot;java&quot;,</span><br><span class="line">  &quot;publishStatus&quot;: &quot;&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>.httpæ–‡ä»¶å³æµ‹è¯•ç”¨ä¾‹æ–‡æ¡£ ï¼Œå®ƒå¯ä»¥éšç€é¡¹ç›®å·¥ç¨‹ä¸€èµ·ä¿å­˜ï¼Œè¿™æ ·æµ‹è¯•çš„æ•°æ®å°±å¯ä»¥ä¿å­˜ä¸‹æ¥ï¼Œæ–¹ä¾¿è¿›è¡Œæµ‹è¯•ã€‚</p><ul><li>ä¸ºäº†æ–¹ä¾¿ä¿å­˜.httpæ–‡ä»¶ ï¼Œæˆ‘ä»¬å•ç‹¬åœ¨é¡¹ç›®å·¥ç¨‹çš„æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ªç›®å½•å•ç‹¬å­˜æ”¾å®ƒä»¬ã€‚</li><li>ä¸ºäº†æ–¹ä¾¿å°†æ¥å’Œç½‘å…³é›†æˆæµ‹è¯•ï¼Œè¿™é‡Œæˆ‘ä»¬æŠŠæµ‹è¯•ä¸»æœºåœ°å€åœ¨é…ç½®æ–‡ä»¶http-client.env.json ä¸­é…ç½®</li></ul><p><img src="https://picbed1.taoyaopc.live/xczx/image-20230522161032994.png" alt="image-20230522161032994" style="zoom: 67%;" /></p><blockquote><p>æ³¨æ„ï¼šæ–‡ä»¶åç§°http-client.env.jsonä¿æŒä¸€è‡´ï¼Œå¦åˆ™æ— æ³•è¯»å–devç¯å¢ƒå˜é‡çš„å†…å®¹ã€‚</p></blockquote><p><strong>http-client.env.json</strong></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;dev&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;access_token&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;gateway_host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;localhost:63010&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;content_host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;localhost:63040&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;system_host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;localhost:63110&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;media_host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;localhost:63050&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;search_host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;localhost:63080&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;auth_host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;localhost:63070&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;checkcode_host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;localhost:63075&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;learning_host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;localhost:63020&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><strong>xc-content-api.http</strong></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">### æŸ¥è¯¢è¯¾ç¨‹ä¿¡æ¯</span><br><span class="line">POST &#123;&#123;content_host&#125;&#125;/content/course/list?pageNo=1&amp;pageSize=2</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;auditStatus&quot;: &quot;202004&quot;,</span><br><span class="line">  &quot;courseName&quot;: &quot;java&quot;,</span><br><span class="line">  &quot;publishStatus&quot;: &quot;&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-8-å‰åç«¯è”è°ƒ"><a href="#3-8-å‰åç«¯è”è°ƒ" class="headerlink" title="3.8 å‰åç«¯è”è°ƒ"></a>3.8 å‰åç«¯è”è°ƒ</h2><h3 id="3-8-1-å‡†å¤‡ç¯å¢ƒ"><a href="#3-8-1-å‡†å¤‡ç¯å¢ƒ" class="headerlink" title="3.8.1 å‡†å¤‡ç¯å¢ƒ"></a>3.8.1 å‡†å¤‡ç¯å¢ƒ</h3><blockquote><p>ä»€ä¹ˆæ˜¯å‰åç«¯è”è°ƒï¼Ÿ</p><p>é€šå¸¸ç”±åç«¯å·¥ç¨‹å¸ˆå°†æ¥å£è®¾è®¡å¥½å¹¶ç¼–å†™æ¥å£æ–‡æ¡£ï¼Œå°†æ¥å£æ–‡æ¡£äº¤ç»™å‰ç«¯å·¥ç¨‹å¸ˆï¼Œå‰åç«¯çš„å·¥ç¨‹å¸ˆå°±å¼€å§‹å¹¶è¡Œå¼€å‘ï¼Œå‰ç«¯å¼€å‘äººå‘˜ä¼šä½¿ç”¨mockæ•°æ®ï¼ˆå‡æ•°æ®ï¼‰è¿›è¡Œå¼€å‘ï¼Œå½“å‰åç«¯ä»£ç å®Œæˆåå¼€å§‹è¿›è¡Œæ¥å£è”è°ƒï¼Œå‰ç«¯å·¥ç¨‹å¸ˆå°†mockæ•°æ®æ”¹ä¸ºè¯·æ±‚åç«¯æ¥å£è·å–ï¼Œå‰ç«¯ä»£ç è¯·æ±‚åç«¯æœåŠ¡æµ‹è¯•æ¥å£æ˜¯å¦æ­£å¸¸ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯å‰åç«¯è”è°ƒã€‚</p><p>å½“å‰åç«¯è”è°ƒå‡ºç°é—®é¢˜éœ€è¦æ ¹æ®æµ‹è¯•ç¯å¢ƒä¸‹æ¥å£çš„è¯·æ±‚åŠå“åº”æ•°æ®å†…å®¹å»åˆ¤æ–­æ˜¯å¦ç¬¦åˆæ¥å£æ–‡æ¡£çš„è¦æ±‚ã€‚æŸ¥å‡ºæ˜¯å‰ç«¯æˆ–åç«¯çš„é—®é¢˜ç”±å…·ä½“çš„å·¥ç¨‹å¸ˆè´Ÿè´£ä¿®æ”¹ç¼ºé™·ï¼Œä¿®æ”¹åå†æ¬¡å›å½’æµ‹è¯•ã€‚</p></blockquote><p>é¦–å…ˆéœ€è¦å®‰è£… node.jsï¼Œæ¯”è¾ƒç®€å•ï¼Œç‚¹å‡»å®‰è£…åŒ…å‚»ç“œå¼å®‰è£…</p><ul><li>æœ€åå¯åœ¨å‘½ä»¤è¡Œçª—å£ä¸­è¾“å…¥ node -v æŸ¥çœ‹ç‰ˆæœ¬å·</li><li>è‹¥å‡ºç°åˆ™å®‰è£…æˆåŠŸ</li><li>æœ€ååœ¨ idea ä¸­é…ç½® node.js çš„è·¯å¾„</li></ul><blockquote><p>æ³¨æ„ï¼šæ­¤å¤„é€‰æ‹© node.js ç‰ˆæœ¬ä¸º18æ—¶è¿è¡Œé”™è¯¯ï¼Œå°è¯•æ”¹åˆ°16</p></blockquote><p>ä¸‹è¾¹å¯åŠ¨å‰ç«¯å·¥ç¨‹ï¼Œä»å‰ç«¯å·¥ç¨‹æ‹·è´project-xczx2-portal-vue-ts.zipåˆ°ä»£ç ç›®å½•å¹¶è§£å‹ï¼Œå¹¶ä½¿ç”¨IDEAæˆ–VS Codeæ‰“å¼€project-xczx2-portal-vue-tsç›®å½•ï¼Œè¿è¡Œé¡¹ç›®</p><ul><li>å¦‚æœå­˜åœ¨é—®é¢˜é€šè¿‡ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ï¼š<ol><li>cmdè¿›å…¥å·¥ç¨‹æ ¹ç›®å½• </li><li>è¿è¡Œä»¥ä¸‹å‘½ä»¤</li></ol></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br><span class="line"></span><br><span class="line">cnpm i</span><br><span class="line"></span><br><span class="line">npm run serve</span><br></pre></td></tr></table></figure><h3 id="3-8-2-å®‰è£…ç³»ç»Ÿç®¡ç†æœåŠ¡"><a href="#3-8-2-å®‰è£…ç³»ç»Ÿç®¡ç†æœåŠ¡" class="headerlink" title="3.8.2 å®‰è£…ç³»ç»Ÿç®¡ç†æœåŠ¡"></a>3.8.2 å®‰è£…ç³»ç»Ÿç®¡ç†æœåŠ¡</h3><p><a href="http://localhost:8601/api/system/dictionary/all">http://localhost:8601/system/dictionary/all</a> æŒ‡å‘çš„æ˜¯ç³»ç»Ÿç®¡ç†æœåŠ¡ã€‚</p><ul><li>åœ¨å‰ç«¯è®²è§£å†…å®¹ç®¡ç†æ¨¡å—çš„éœ€æ±‚æ—¶æˆ‘ä»¬æåˆ°ä¸€ä¸ªæ•°æ®å­—å…¸è¡¨ï¼Œæ­¤é“¾æ¥æ­£æ˜¯åœ¨å‰ç«¯è¯·æ±‚åç«¯è·å–æ•°æ®å­—å…¸æ•°æ®çš„æ¥å£åœ°å€ã€‚</li></ul><p>æ•°æ®å­—å…¸è¡¨ä¸­é…ç½®äº†é¡¹ç›®ç”¨çš„å­—å…¸ä¿¡æ¯ï¼Œæ­¤æ¥å£æ˜¯æŸ¥è¯¢å­—å…¸ä¸­çš„å…¨éƒ¨æ•°æ® ï¼Œåœ¨æ­¤æˆ‘ä»¬ä¸å†å¼€å‘ï¼ŒæŒ‰ç…§ä¸‹è¾¹çš„æ­¥éª¤å®‰è£…ç³»ç»Ÿç®¡ç†æœåŠ¡å³å¯ã€‚</p><ul><li><p>ä»è¯¾ç¨‹èµ„æ–™/é¡¹ç›®å·¥ç¨‹ç›®å½•è·å–xuecheng-plus-system.zipï¼Œå¹¶è§£å‹</p></li><li><p>å°†xuecheng-plus-systemç›®å½•æ‹·è´åˆ°é¡¹ç›®å·¥ç¨‹æ ¹ç›®å½•ï¼Œåˆ·æ–°mavenï¼Œæˆ–è¿›å…¥pom.xmlå³é”®è½¬ä¸ºpomå·¥ç¨‹ã€‚</p></li></ul><h3 id="3-8-3-è§£å†³è·¨åŸŸè¯·æ±‚"><a href="#3-8-3-è§£å†³è·¨åŸŸè¯·æ±‚" class="headerlink" title="3.8.3 è§£å†³è·¨åŸŸè¯·æ±‚"></a>3.8.3 è§£å†³è·¨åŸŸè¯·æ±‚</h3><p>1ï¸âƒ£åœ¨æµè§ˆå™¨é€šè¿‡<a href="http://localhost:8601/åœ°å€è®¿é—®å‰ç«¯å·¥ç¨‹ã€‚">http://localhost:8601/åœ°å€è®¿é—®å‰ç«¯å·¥ç¨‹ã€‚</a></p><ul><li>chromeæµè§ˆå™¨æŠ¥é”™å¦‚ä¸‹ï¼š</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Java Access to XMLHttpRequest at <span class="string">&#x27;http://localhost:63110/system/dictionary/all&#x27;</span> from origin <span class="string">&#x27;http://localhost:8601&#x27;</span> has been blocked by CORS policy: No <span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span> header is present on the requested resource.</span><br></pre></td></tr></table></figure><ul><li>firefoxæµè§ˆå™¨æŠ¥é”™å¦‚ä¸‹ï¼š</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å·²æ‹¦æˆªè·¨æºè¯·æ±‚ï¼šåŒæºç­–ç•¥ç¦æ­¢è¯»å–ä½äº http://localhost:63110/system/dictionary/all çš„è¿œç¨‹èµ„æºã€‚ï¼ˆåŸå› ï¼šCORS å¤´ç¼ºå°‘ <span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>ï¼‰ã€‚çŠ¶æ€ç ï¼š200ã€‚</span><br></pre></td></tr></table></figure><p><strong>æç¤º</strong>ï¼šä»<code>http://localhost:8601</code> è®¿é—® <code>http://localhost:63110/system/dictionary/all</code> è¢«CORS policyé˜»æ­¢ï¼Œå› ä¸ºæ²¡æœ‰<code>Access-Control-Allow-Origin</code> å¤´ä¿¡æ¯ã€‚CORSå…¨ç§°æ˜¯ <code>cross origin resource share</code> è¡¨ç¤ºè·¨åŸŸèµ„æºå…±äº«ã€‚</p><p>å‡ºè¿™ä¸ªæç¤ºçš„åŸå› æ˜¯åŸºäºæµè§ˆå™¨çš„åŒæºç­–ç•¥ï¼Œå»åˆ¤æ–­æ˜¯å¦è·¨åŸŸè¯·æ±‚ï¼Œ</p><ul><li>åŒæºç­–ç•¥æ˜¯æµè§ˆå™¨çš„ä¸€ç§å®‰å…¨æœºåˆ¶ï¼Œä»ä¸€ä¸ªåœ°å€è¯·æ±‚å¦ä¸€ä¸ªåœ°å€ï¼Œ</li><li>å¦‚æœåè®®ã€ä¸»æœºã€ç«¯å£ä¸‰è€…å…¨éƒ¨ä¸€è‡´åˆ™ä¸å±äºè·¨åŸŸï¼Œå¦åˆ™æœ‰ä¸€ä¸ªä¸ä¸€è‡´å°±æ˜¯è·¨åŸŸè¯·æ±‚ã€‚</li></ul><p><strong>æ¯”å¦‚</strong>ï¼š</p><ul><li><p>ä»<code>http://localhost:8601</code>åˆ° <code>http://localhost:8602</code>ç”±äºç«¯å£ä¸åŒï¼Œæ˜¯è·¨åŸŸã€‚</p></li><li><p>ä»<code>http://192.168.101.10:8601</code>åˆ°  <code>http://192.168.101.11:8601</code> ç”±äºä¸»æœºä¸åŒï¼Œæ˜¯è·¨åŸŸã€‚</p></li><li><p>ä»<code>http://192.168.101.10:8601</code> åˆ° <code>https://192.168.101.10:8601</code>ç”±äºåè®®ä¸åŒï¼Œæ˜¯è·¨åŸŸã€‚</p></li></ul><blockquote><p>æ³¨æ„ï¼šæœåŠ¡å™¨ä¹‹é—´ä¸å­˜åœ¨è·¨åŸŸè¯·æ±‚ã€‚</p></blockquote><p>æµè§ˆå™¨åˆ¤æ–­æ˜¯è·¨åŸŸè¯·æ±‚ä¼šåœ¨è¯·æ±‚å¤´ä¸Šæ·»åŠ  originï¼Œè¡¨ç¤ºè¿™ä¸ªè¯·æ±‚æ¥æºå“ªé‡Œã€‚</p><p>æ¯”å¦‚ï¼š</p><ul><li><p>Plaintext GET / HTTP/1.1 Origin: <a href="http://localhost:8601">http://localhost:8601</a></p><ul><li><p>æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åˆ¤æ–­è¿™ä¸ªOriginæ˜¯å¦å…è®¸è·¨åŸŸï¼Œå¦‚æœå…è®¸åˆ™åœ¨å“åº”å¤´ä¸­è¯´æ˜å…è®¸è¯¥æ¥æºçš„è·¨åŸŸè¯·æ±‚ï¼Œå¦‚ä¸‹ï¼š</p></li><li><p>Plaintext Access-Control-Allow-Originï¼š<a href="http://localhost:8601">http://localhost:8601</a></p><ul><li><p>å¦‚æœå…è®¸ä»»ä½•åŸŸåæ¥æºçš„è·¨åŸŸè¯·æ±‚ï¼Œåˆ™å“åº”å¦‚ä¸‹ï¼š</p></li><li><p>Plaintext Access-Control-Allow-Originï¼š*</p></li></ul></li></ul></li></ul><p>2ï¸âƒ£<strong>è§£å†³è·¨åŸŸçš„æ–¹æ³•</strong>ï¼š</p><ol><li><strong>JSONP</strong></li></ol><p>é€šè¿‡scriptæ ‡ç­¾çš„srcå±æ€§è¿›è¡Œè·¨åŸŸè¯·æ±‚ï¼Œå¦‚æœæœåŠ¡ç«¯è¦å“åº”å†…å®¹åˆ™é¦–å…ˆè¯»å–è¯·æ±‚å‚æ•°callbackçš„å€¼ï¼Œcallbackæ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°çš„åç§°ï¼ŒæœåŠ¡ç«¯è¯»å–callbackçš„å€¼åå°†å“åº”å†…å®¹é€šè¿‡è°ƒç”¨callbackå‡½æ•°çš„æ–¹å¼å‘Šè¯‰è¯·æ±‚æ–¹ã€‚å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://picbed1.taoyaopc.live/xczx/wps1-1684746553256-2.jpg" alt="img"> </p><ol><li><strong>æ·»åŠ å“åº”å¤´</strong></li></ol><p>æœåŠ¡ç«¯åœ¨å“åº”å¤´æ·»åŠ  Access-Control-Allow-Originï¼š*</p><ol><li><strong>é€šè¿‡ nginx ä»£ç†è·¨åŸŸ</strong></li></ol><p>ç”±äºæœåŠ¡ç«¯ä¹‹é—´æ²¡æœ‰è·¨åŸŸï¼Œæµè§ˆå™¨é€šè¿‡nginxå»è®¿é—®è·¨åŸŸåœ°å€ã€‚</p><p><img src="https://picbed1.taoyaopc.live/xczx/wps2-1684746553255-1.jpg" alt="img" style="zoom: 80%;" /> </p><ul><li>æµè§ˆå™¨å…ˆè®¿é—®<a href="http://192.168.101.10:8601">http://192.168.101.10:8601</a> nginxæä¾›çš„åœ°å€ï¼Œè¿›å…¥é¡µé¢</li><li>æ­¤é¡µé¢è¦è·¨åŸŸè®¿é—®<a href="http://192.168.101.11:8601">http://192.168.101.11:8601</a> ï¼Œä¸èƒ½ç›´æ¥è·¨åŸŸè®¿é—®<a href="http://www.baidu.com:8601">http://www.baidu.com:8601</a> ï¼Œ</li><li>è€Œæ˜¯è®¿é—®nginxçš„ä¸€ä¸ªåŒæºåœ°å€ï¼Œæ¯”å¦‚ï¼š<a href="http://192.168.101.11:8601/api">http://192.168.101.11:8601/api</a> ï¼Œ<ul><li>é€šè¿‡<a href="http://192.168.101.11:8601/api">http://192.168.101.11:8601/api</a> çš„ä»£ç†å»è®¿é—®<a href="http://www.baidu.com:8601ã€‚">http://www.baidu.com:8601ã€‚</a></li></ul></li></ul><p>è¿™æ ·å°±å®ç°äº†è·¨åŸŸè®¿é—®ã€‚</p><ul><li><p>æµè§ˆå™¨åˆ°<a href="http://192.168.101.11:8601/api">http://192.168.101.11:8601/api</a> æ²¡æœ‰è·¨åŸŸ</p></li><li><p>nginxåˆ°<a href="http://www.baidu.com:8601é€šè¿‡æœåŠ¡ç«¯é€šä¿¡ï¼Œæ²¡æœ‰è·¨åŸŸã€‚">http://www.baidu.com:8601é€šè¿‡æœåŠ¡ç«¯é€šä¿¡ï¼Œæ²¡æœ‰è·¨åŸŸã€‚</a></p></li></ul><p>3ï¸âƒ£æˆ‘ä»¬å‡†å¤‡ä½¿ç”¨æ–¹æ¡ˆ2è§£å†³è·¨åŸŸé—®é¢˜ã€‚</p><ul><li>åœ¨å†…å®¹ç®¡ç†çš„apiå·¥ç¨‹configåŒ…ä¸‹ç¼–å†™GlobalCorsConfig.javaï¼Œ</li><li>æ­¤é…ç½®ç±»å®ç°äº†è·¨åŸŸè¿‡è™‘å™¨ï¼Œåœ¨å“åº”å¤´æ·»åŠ Access-Control-Allow-Originã€‚</li><li>é‡å¯ç³»ç»Ÿç®¡ç†æœåŠ¡ï¼Œå‰ç«¯å·¥ç¨‹å¯ä»¥æ­£å¸¸è¿›å…¥<a href="http://localhost:8601ï¼Œè§‚å¯Ÿæµè§ˆå™¨è®°å½•ï¼ŒæˆåŠŸè§£å†³è·¨åŸŸã€‚">http://localhost:8601ï¼Œè§‚å¯Ÿæµè§ˆå™¨è®°å½•ï¼ŒæˆåŠŸè§£å†³è·¨åŸŸã€‚</a></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.system.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.cors.CorsConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.cors.UrlBasedCorsConfigurationSource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.filter.CorsFilter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> TODO</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/22 17:16</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalCorsConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> CorsFilter <span class="title function_">corsFilter</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">CorsConfiguration</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CorsConfiguration</span>();</span><br><span class="line">        <span class="comment">//å…è®¸ç™½åå•åŸŸåè¿›è¡Œè·¨åŸŸè°ƒç”¨</span></span><br><span class="line">        config.addAllowedOrigin(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">        <span class="comment">//å…è®¸è·¨è¶Šå‘é€cookie</span></span><br><span class="line">        config.setAllowCredentials(<span class="literal">true</span>);</span><br><span class="line">        <span class="comment">//æ”¾è¡Œå…¨éƒ¨åŸå§‹å¤´ä¿¡æ¯</span></span><br><span class="line">        config.addAllowedHeader(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">        <span class="comment">//å…è®¸æ‰€æœ‰è¯·æ±‚æ–¹æ³•è·¨åŸŸè°ƒç”¨</span></span><br><span class="line">        config.addAllowedMethod(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">        <span class="type">UrlBasedCorsConfigurationSource</span> <span class="variable">source</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UrlBasedCorsConfigurationSource</span>();</span><br><span class="line">        source.registerCorsConfiguration(<span class="string">&quot;/**&quot;</span>, config);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">CorsFilter</span>(source);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-8-4-å‰åç«¯è”è°ƒ"><a href="#3-8-4-å‰åç«¯è”è°ƒ" class="headerlink" title="3.8.4 å‰åç«¯è”è°ƒ"></a>3.8.4 å‰åç«¯è”è°ƒ</h3><p>è¿™é‡Œè¿›è¡Œå‰åè”è°ƒçš„ç›®çš„æ˜¯ä½“ä¼šå‰åç«¯è”è°ƒçš„æµç¨‹ï¼Œæµ‹è¯•çš„åŠŸèƒ½ä¸ºè¯¾ç¨‹æŸ¥è¯¢åŠŸèƒ½ã€‚</p><ol><li><p>å¯åŠ¨å‰ç«¯å·¥ç¨‹ï¼Œå†å¯å†…å®¹ç®¡ç†æœåŠ¡ç«¯ã€‚</p></li><li><p>ä¿®æ”¹æœåŠ¡ç«¯åœ°å€</p></li></ol><p>1ï¸âƒ£å‰ç«¯é»˜è®¤è¿æ¥çš„æ˜¯é¡¹ç›®çš„ç½‘å…³åœ°å€ï¼Œç”±äºç°åœ¨ç½‘å…³å·¥ç¨‹è¿˜æ²¡æœ‰åˆ›å»ºï¼Œè¿™é‡Œéœ€è¦æ›´æ”¹å‰ç«¯å·¥ç¨‹çš„å‚æ•°é…ç½®æ–‡ä»¶ ï¼Œä¿®æ”¹ç½‘å…³åœ°å€ä¸ºå†…å®¹ç®¡ç†æœåŠ¡çš„åœ°å€ã€‚ </p><p><img src="https://picbed1.taoyaopc.live/xczx/image-20230522172921630.png" alt="image-20230522172921630"></p><p>2ï¸âƒ£å¯åŠ¨å‰ç«¯å·¥ç¨‹ï¼Œç”¨å‰ç«¯è®¿é—®åç«¯æ¥å£ï¼Œè§‚å¯Ÿå‰ç«¯ç•Œé¢çš„æ•°æ®æ˜¯å¦æ­£ç¡®ã€‚</p><ul><li><p>è®¿é—®å‰ç«¯é¦–é¡µï¼Œè¿›å…¥è¯¾ç¨‹ç®¡ç†ï¼š<a href="http://localhost:8601/#/organization/course-list">http://localhost:8601/#/organization/course-list</a></p></li><li><p>æ›´æ”¹è¯¾ç¨‹æ¡ä»¶åŠåˆ†é¡µå‚æ•°æµ‹è¯•è¯¾ç¨‹æŸ¥è¯¢åˆ—è¡¨æ˜¯å¦æ­£å¸¸æ˜¾ç¤ºã€‚</p><p>è·Ÿè¸ªå†…å®¹ç®¡ç†æœåŠ¡çš„è¾“å‡ºæ—¥å¿—ï¼ŒæŸ¥çœ‹æ˜¯å¦æ­£å¸¸ã€‚</p><p>åˆ°æ­¤åŸºæœ¬å®Œæˆäº†å‰åç«¯è¿è°ƒã€‚</p></li></ul><p><img src="https://picbed1.taoyaopc.live/xczx/image-20230522173102635.png" alt="image-20230522173102635"></p><h1 id="4-è¯¾ç¨‹åˆ†ç±»æŸ¥è¯¢"><a href="#4-è¯¾ç¨‹åˆ†ç±»æŸ¥è¯¢" class="headerlink" title="4. è¯¾ç¨‹åˆ†ç±»æŸ¥è¯¢"></a>4. è¯¾ç¨‹åˆ†ç±»æŸ¥è¯¢</h1><h2 id="4-1-éœ€æ±‚åˆ†æ"><a href="#4-1-éœ€æ±‚åˆ†æ" class="headerlink" title="4.1 éœ€æ±‚åˆ†æ"></a>4.1 éœ€æ±‚åˆ†æ</h2><p>1ï¸âƒ£ä¸‹è¾¹æ ¹æ®å†…å®¹ç®¡ç†æ¨¡å—çš„ä¸šåŠ¡æµç¨‹ï¼Œä¸‹ä¸€æ­¥è¦å®ç°æ–°å¢è¯¾ç¨‹ï¼Œåœ¨æ–°å¢è¯¾ç¨‹ç•Œé¢ï¼Œæœ‰ä¸‰å¤„ä¿¡æ¯éœ€è¦é€‰æ‹©ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://picbed1.taoyaopc.live/xczx/wps3-1684748164049-5.jpg" alt="img" style="zoom: 67%;" /> </p><p>è¯¾ç¨‹ç­‰çº§ã€è¯¾ç¨‹ç±»å‹æ¥æºäºæ•°æ®å­—å…¸è¡¨ï¼Œæ­¤éƒ¨åˆ†çš„ä¿¡æ¯å‰ç«¯å·²ä»ç³»ç»Ÿç®¡ç†æœåŠ¡è¯»å–ã€‚</p><p>è¯¾ç¨‹åˆ†ç±»ä¿¡æ¯æ²¡æœ‰åœ¨æ•°æ®å­—å…¸è¡¨ä¸­å­˜å‚¨ï¼Œè€Œæ˜¯ç”±å•ç‹¬ä¸€å¼ è¯¾ç¨‹åˆ†ç±»è¡¨ï¼Œå­˜å‚¨åœ¨å†…å®¹ç®¡ç†æ•°æ®åº“ä¸­ã€‚</p><p>2ï¸âƒ£ä¸‹è¾¹çœ‹ä¸‹course_categoryè¯¾ç¨‹åˆ†ç±»è¡¨çš„ç»“æ„</p><ul><li>è¿™å¼ è¡¨æ˜¯ä¸€ä¸ªæ ‘å‹ç»“æ„ï¼Œé€šè¿‡çˆ¶ç»“ç‚¹idå°†å„å…ƒç´ ç»„æˆä¸€ä¸ªæ ‘ã€‚</li><li>ç°åœ¨çš„éœ€æ±‚æ˜¯éœ€è¦åœ¨å†…å®¹ç®¡ç†æœåŠ¡ä¸­ç¼–å†™ä¸€ä¸ªæ¥å£è¯»å–è¯¥è¯¾ç¨‹åˆ†ç±»è¡¨çš„æ•°æ®ï¼Œç»„æˆä¸€ä¸ªæ ‘å‹ç»“æ„è¿”å›ç»™å‰ç«¯ã€‚</li></ul><p><img src="https://picbed1.taoyaopc.live/xczx/image-20230522173847669.png" alt="image-20230522173847669" style="zoom:67%;" /></p><h2 id="4-2-æ¥å£å®šä¹‰"><a href="#4-2-æ¥å£å®šä¹‰" class="headerlink" title="4.2 æ¥å£å®šä¹‰"></a>4.2 æ¥å£å®šä¹‰</h2><p>1ï¸âƒ£æˆ‘ä»¬å¯ä»¥ç‚¹å‡»æ–°å¢è¯¾ç¨‹ï¼Œè§‚å¯Ÿå‰ç«¯çš„è¯·æ±‚è®°å½•ï¼š</p><p><img src="https://picbed1.taoyaopc.live/xczx/wps4-1684750538417-7.jpg" alt="img"> </p><ul><li><p><a href="http://localhost:8601/api/content/course-category/tree-nodes">http://localhost:8601/api/content/course-category/tree-nodes</a> è¯¥åœ°å€æ­£æ˜¯å‰ç«¯è·å–è¯¾ç¨‹åˆ†ç±»çš„æ¥å£åœ°å€ã€‚</p><ul><li><p>é€šè¿‡ä¸Šå›¾ç•Œé¢çš„å†…å®¹å¯ä»¥çœ‹å‡ºè¯¥æ¥å£çš„åè®®ä¸ºï¼šHTTP GET</p></li><li><p>è¯·æ±‚å‚æ•°ä¸ºç©ºã€‚</p></li><li>é€šè¿‡æŸ¥é˜…æ¥å£æ–‡æ¡£ï¼Œæ­¤æ¥å£è¦è¿”å›å…¨éƒ¨è¯¾ç¨‹åˆ†ç±»ï¼Œä»¥æ ‘å‹ç»“æ„è¿”å›ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</li></ul></li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">         <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;childrenTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">               <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;childrenTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-1-1&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isLeaf&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isShow&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;label&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;HTML/CSS&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;HTML/CSS&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-1&quot;</span></span><br><span class="line">               <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;childrenTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-1-2&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isLeaf&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isShow&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;label&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;JavaScript&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;JavaScript&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-1&quot;</span></span><br><span class="line">               <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;childrenTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-1-3&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isLeaf&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isShow&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;label&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;jQuery&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;jQuery&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">3</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-1&quot;</span></span><br><span class="line">               <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;childrenTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-1-4&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isLeaf&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isShow&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;label&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;ExtJS&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;ExtJS&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">4</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-1&quot;</span></span><br><span class="line">               <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;childrenTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-1-5&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isLeaf&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isShow&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;label&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;AngularJS&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;AngularJS&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">5</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-1&quot;</span></span><br><span class="line">               <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;childrenTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-1-6&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isLeaf&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isShow&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;label&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;ReactJS&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;ReactJS&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">6</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-1&quot;</span></span><br><span class="line">               <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;childrenTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-1-7&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isLeaf&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isShow&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;label&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;Bootstrap&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;Bootstrap&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">7</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-1&quot;</span></span><br><span class="line">               <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;childrenTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-1-8&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isLeaf&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isShow&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;label&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;Node.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;Node.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-1&quot;</span></span><br><span class="line">               <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;childrenTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-1-9&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isLeaf&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isShow&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;label&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;Vue&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;Vue&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">9</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-1&quot;</span></span><br><span class="line">               <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;childrenTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-1-10&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isLeaf&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isShow&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;label&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;å…¶å®ƒ&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;å…¶å®ƒ&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-1&quot;</span></span><br><span class="line">               <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-1&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;isLeaf&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;isShow&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;label&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;å‰ç«¯å¼€å‘&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;å‰ç«¯å¼€å‘&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1&quot;</span></span><br><span class="line">         <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">         <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;childrenTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">               <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;childrenTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-2-1&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isLeaf&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isShow&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;label&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;å¾®ä¿¡å¼€å‘&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;å¾®ä¿¡å¼€å‘&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-2&quot;</span></span><br><span class="line">               <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;childrenTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-2-2&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isLeaf&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isShow&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;label&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;iOS&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;iOS&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-2&quot;</span></span><br><span class="line">               <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;childrenTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-2-3&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isLeaf&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isShow&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;label&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;æ‰‹æ¸¸å¼€å‘&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;æ‰‹æ¸¸å¼€å‘&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">3</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-2&quot;</span></span><br><span class="line">               <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;childrenTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-2-4&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isLeaf&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isShow&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;label&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;Swift&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;Swift&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">4</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-2&quot;</span></span><br><span class="line">               <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;childrenTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-2-5&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isLeaf&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isShow&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;label&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;Android&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;Android&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">5</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-2&quot;</span></span><br><span class="line">               <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;childrenTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-2-6&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isLeaf&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isShow&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;label&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;ReactNative&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;ReactNative&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">6</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-2&quot;</span></span><br><span class="line">               <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;childrenTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-2-7&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isLeaf&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isShow&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;label&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;Cordova&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;Cordova&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">7</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-2&quot;</span></span><br><span class="line">               <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">               <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;childrenTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-2-8&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isLeaf&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isShow&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;label&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;å…¶å®ƒ&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;å…¶å®ƒ&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-2&quot;</span></span><br><span class="line">               <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-2&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;isLeaf&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;isShow&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;label&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;ç§»åŠ¨å¼€å‘&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;ç§»åŠ¨å¼€å‘&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1&quot;</span></span><br><span class="line">         <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure><p>ä¸Šè¾¹çš„æ•°æ®æ ¼å¼æ˜¯ä¸€ä¸ªæ•°ç»„ç»“æ„ï¼Œæ•°ç»„çš„å…ƒç´ å³ä¸ºåˆ†ç±»ä¿¡æ¯ï¼Œåˆ†ç±»ä¿¡æ¯è®¾è®¡ä¸¤çº§åˆ†ç±»ï¼Œ</p><ul><li>ç¬¬ä¸€çº§çš„åˆ†ç±»ä¿¡æ¯ç¤ºä¾‹å¦‚ä¸‹ï¼š</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-2&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;isLeaf&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;isShow&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;label&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;ç§»åŠ¨å¼€å‘&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;ç§»åŠ¨å¼€å‘&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1&quot;</span></span><br></pre></td></tr></table></figure><ul><li>ç¬¬äºŒçº§çš„åˆ†ç±»æ˜¯ç¬¬ä¸€çº§åˆ†ç±»ä¸­childrenTreeNodeså±æ€§ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ•°ç»„ç»“æ„ï¼š</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">JSON</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-2&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;isLeaf&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;isShow&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;label&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;ç§»åŠ¨å¼€å‘&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;ç§»åŠ¨å¼€å‘&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;childrenTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">               <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;childrenTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-2-1&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isLeaf&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;isShow&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;label&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;å¾®ä¿¡å¼€å‘&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;name&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;å¾®ä¿¡å¼€å‘&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1-2&quot;</span></span><br><span class="line">               <span class="punctuation">&#125;</span></span><br><span class="line"> <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>2ï¸âƒ£æ‰€ä»¥ï¼Œå®šä¹‰ä¸€ä¸ªDTOç±»è¡¨ç¤ºåˆ†ç±»ä¿¡æ¯çš„æ¨¡å‹ç±»ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.content.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.model.po.CourseCategory;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> TODO</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/22 17:40</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CourseCategoryTreeDto</span> <span class="keyword">extends</span> <span class="title class_">CourseCategory</span> <span class="keyword">implements</span> <span class="title class_">java</span>.io.Serializable&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;CourseCategoryTreeDto&gt; childrenTreeNodes;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3ï¸âƒ£æ¥å£å®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.content.api;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.model.dto.CourseCategoryTreeDto;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è¯¾ç¨‹åˆ†ç±»ç›¸å…³æ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/22 17:45</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CourseCategoryController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/course-category/tree-nodes&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> CourseCategoryTreeDto <span class="title function_">queryTreeNodes</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-3-æ¥å£å¼€å‘"><a href="#4-3-æ¥å£å¼€å‘" class="headerlink" title="4.3 æ¥å£å¼€å‘"></a>4.3 æ¥å£å¼€å‘</h2><h3 id="4-3-1-æ ‘å½¢è¡¨æŸ¥è¯¢"><a href="#4-3-1-æ ‘å½¢è¡¨æŸ¥è¯¢" class="headerlink" title="4.3.1 æ ‘å½¢è¡¨æŸ¥è¯¢"></a>4.3.1 æ ‘å½¢è¡¨æŸ¥è¯¢</h3><p>è¯¾ç¨‹åˆ†ç±»è¡¨æ˜¯ä¸€ä¸ªæ ‘å‹ç»“æ„ï¼Œå…¶ä¸­parentidå­—æ®µä¸ºçˆ¶ç»“ç‚¹IDï¼Œå®ƒæ˜¯æ ‘å‹ç»“æ„çš„æ ‡å¿—å­—æ®µã€‚</p><p>1ï¸âƒ£å¦‚æœæ ‘çš„å±‚çº§å›ºå®šå¯ä»¥ä½¿ç”¨è¡¨çš„è‡ªé“¾æ¥å»æŸ¥è¯¢ï¼Œ</p><ul><li>æ¯”å¦‚ï¼šæˆ‘ä»¬åªæŸ¥è¯¢ä¸¤çº§è¯¾ç¨‹åˆ†ç±»ï¼Œå¯ä»¥ç”¨ä¸‹è¾¹çš„SQL</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">select</span><br><span class="line">       one.id            one_id,</span><br><span class="line">       one.name          one_name,</span><br><span class="line">       one.parentid      one_parentid,</span><br><span class="line">       one.orderby       one_orderby,</span><br><span class="line">       one.label         one_label,</span><br><span class="line">       two.id            two_id,</span><br><span class="line">       two.name          two_name,</span><br><span class="line">       two.parentid      two_parentid,</span><br><span class="line">       two.orderby       two_orderby,</span><br><span class="line">       two.label         two_label</span><br><span class="line">   from course_category one</span><br><span class="line">            inner join course_category two on one.id = two.parentid</span><br><span class="line">   where one.parentid = 1</span><br><span class="line">     and one.is_show = 1</span><br><span class="line">     and two.is_show = 1</span><br><span class="line">   order by one.orderby,</span><br><span class="line">            two.orderby</span><br></pre></td></tr></table></figure><p>2ï¸âƒ£å¦‚æœæ ‘çš„å±‚çº§ä¸ç¡®å®šï¼Œ</p><ul><li>æ­¤æ—¶å¯ä»¥ä½¿ç”¨MySQLé€’å½’å®ç°ï¼Œä½¿ç”¨withè¯­æ³•ï¼Œå¦‚ä¸‹ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">WITH [RECURSIVE]</span><br><span class="line">        cte_name [(col_name [, col_name] ...)] AS (subquery)</span><br><span class="line">        [, cte_name [(col_name [, col_name] ...)] AS (subquery)] ...</span><br></pre></td></tr></table></figure><ul><li><p>cte_name :å…¬å…±è¡¨è¾¾å¼çš„åç§°,å¯ä»¥ç†è§£ä¸ºè¡¨å,ç”¨æ¥è¡¨ç¤ºasåé¢è·Ÿç€çš„å­æŸ¥è¯¢</p></li><li><p>col_name :å…¬å…±è¡¨è¾¾å¼åŒ…å«çš„åˆ—å,å¯ä»¥å†™ä¹Ÿå¯ä»¥ä¸å†™</p></li></ul><p>ä¸‹è¾¹æ˜¯ä¸€ä¸ªé€’å½’çš„ç®€å•ä¾‹å­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Java</span><br><span class="line">with RECURSIVE t1  AS</span><br><span class="line">(</span><br><span class="line">  SELECT 1 as n</span><br><span class="line">  UNION ALL</span><br><span class="line">  SELECT n + 1 FROM t1 WHERE n &lt; 5</span><br><span class="line">)</span><br><span class="line">SELECT * FROM t1;</span><br></pre></td></tr></table></figure><ul><li>è¾“å‡ºï¼š</li></ul><p><img src="https://picbed1.taoyaopc.live/xczx/wps5-1684750825864-9.jpg" alt="img" style="zoom:50%;" /> </p><ul><li>è¯´æ˜ï¼š<ul><li>t1 ç›¸å½“äºä¸€ä¸ªè¡¨å</li><li>select 1 ç›¸å½“äºè¿™ä¸ªè¡¨çš„åˆå§‹å€¼ï¼Œè¿™é‡Œä½¿ç”¨UNION ALL ä¸æ–­å°†æ¯æ¬¡é€’å½’å¾—åˆ°çš„æ•°æ®åŠ å…¥åˆ°è¡¨ä¸­ã€‚</li><li>n<5ä¸ºé€’å½’æ‰§è¡Œçš„æ¡ä»¶ï¼Œå½“n>=5æ—¶ç»“æŸé€’å½’è°ƒç”¨ã€‚</li></ul></li></ul><p>3ï¸âƒ£ä¸‹è¾¹æˆ‘ä»¬ä½¿ç”¨é€’å½’å®ç°è¯¾ç¨‹åˆ†ç±»çš„æŸ¥è¯¢</p><ol><li>è¿™ç§æ–¹æ³•æ˜¯å‘ä¸‹é€’å½’ï¼Œå³æ‰¾åˆ°åˆå§‹èŠ‚ç‚¹çš„æ‰€æœ‰ä¸‹çº§èŠ‚ç‚¹ã€‚</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Java</span><br><span class="line">with recursive t1 as (</span><br><span class="line">select * from  course_category p where  id= &#x27;1&#x27;</span><br><span class="line">union all</span><br><span class="line"> select t.* from course_category t inner join t1 on t1.id = t.parentid</span><br><span class="line">)</span><br><span class="line">select *  from t1 order by t1.id, t1.orderby</span><br></pre></td></tr></table></figure><ul><li>æŸ¥è¯¢ç»“æœå¦‚ä¸‹ï¼š</li></ul><p><img src="https://picbed1.taoyaopc.live/xczx/image-20230522182508678.png" alt="image-20230522182508678" style="zoom:67%;" /> </p><ul><li><p>t1è¡¨ä¸­åˆå§‹çš„æ•°æ®æ˜¯idç­‰äº1çš„è®°å½•ï¼Œå³æ ¹ç»“ç‚¹ã€‚</p></li><li><p>é€šè¿‡inner join t1 t2 on t2.id = t.parentid æ‰¾åˆ°id=â€™1â€™çš„ä¸‹çº§èŠ‚ç‚¹ ã€‚</p></li><li><p>é€šè¿‡è¿™ç§æ–¹æ³•å°±æ‰¾åˆ°äº†id=â€™1â€™çš„æ‰€æœ‰ä¸‹çº§èŠ‚ç‚¹ï¼Œä¸‹çº§èŠ‚ç‚¹åŒ…æ‹¬äº†æ‰€æœ‰å±‚çº§çš„èŠ‚ç‚¹ã€‚</p></li></ul><ol><li>ä¸‹è¾¹çš„sqlå®ç°äº†å‘ä¸Šé€’å½’ï¼š</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Java</span><br><span class="line">with recursive t1 as (</span><br><span class="line">select * from  course_category p where  id= &#x27;1-1-1&#x27;</span><br><span class="line">union all</span><br><span class="line"> select t.* from course_category t inner join t1 on t1.parentid = t.id</span><br><span class="line">)</span><br><span class="line">select *  from t1 order by t1.id, t1.orderby</span><br></pre></td></tr></table></figure><ul><li>åˆå§‹èŠ‚ç‚¹ä¸º1-1-1ï¼Œé€šè¿‡é€’å½’æ‰¾åˆ°å®ƒçš„çˆ¶çº§èŠ‚ç‚¹ï¼Œçˆ¶çº§èŠ‚ç‚¹åŒ…æ‹¬æ‰€æœ‰çº§åˆ«çš„èŠ‚ç‚¹ã€‚</li></ul><p>ä»¥ä¸Šæ˜¯æˆ‘ä»¬ç ”ç©¶äº†æ ‘å‹è¡¨çš„æŸ¥è¯¢æ–¹æ³•ï¼Œé€šè¿‡é€’å½’çš„æ–¹å¼æŸ¥è¯¢è¯¾ç¨‹åˆ†ç±»æ¯”è¾ƒçµæ´»ï¼Œå› ä¸ºå®ƒå¯ä»¥ä¸é™åˆ¶å±‚çº§ã€‚</p><p>4ï¸âƒ£mysqlä¸ºäº†é¿å…æ— é™é€’å½’é»˜è®¤é€’å½’æ¬¡æ•°ä¸º1000ï¼Œ</p><ul><li>å¯ä»¥é€šè¿‡è®¾ç½®<code>cte_max_recursion_depth</code>å‚æ•°å¢åŠ é€’å½’æ·±åº¦ï¼Œ</li><li>è¿˜å¯ä»¥é€šè¿‡<code>max_execution_time</code>é™åˆ¶æ‰§è¡Œæ—¶é—´ï¼Œè¶…è¿‡æ­¤æ—¶é—´ä¹Ÿä¼šç»ˆæ­¢é€’å½’æ“ä½œã€‚</li></ul><p>mysqlé€’å½’ç›¸å½“äºåœ¨å­˜å‚¨è¿‡ç¨‹ä¸­æ‰§è¡Œè‹¥å¹²æ¬¡sqlè¯­å¥ï¼Œjavaç¨‹åºä»…ä¸æ•°æ®åº“å»ºç«‹ä¸€æ¬¡é“¾æ¥æ‰§è¡Œé€’å½’æ“ä½œï¼Œæ‰€ä»¥åªè¦æ§åˆ¶å¥½é€’å½’æ·±åº¦ï¼Œæ§åˆ¶å¥½æ•°æ®é‡æ€§èƒ½å°±æ²¡æœ‰é—®é¢˜ã€‚</p><p>æ€è€ƒï¼šå¦‚æœjavaç¨‹åºåœ¨é€’å½’æ“ä½œä¸­è¿æ¥æ•°æ®åº“å»æŸ¥è¯¢æ•°æ®ç»„è£…æ•°æ®ï¼Œè¿™ä¸ªæ€§èƒ½é«˜å—ï¼Ÿ</p><h3 id="4-3-2-å¼€å‘-mapper"><a href="#4-3-2-å¼€å‘-mapper" class="headerlink" title="4.3.2 å¼€å‘ mapper"></a>4.3.2 å¼€å‘ mapper</h3><p>ä¸‹è¾¹æˆ‘ä»¬å¯è‡ªå®šä¹‰mapperæ–¹æ³•æŸ¥è¯¢è¯¾ç¨‹åˆ†ç±»ï¼Œæœ€ç»ˆå°†æŸ¥è¯¢ç»“æœæ˜ å°„åˆ°<code>List&lt;CourseCategoryTreeDto&gt;</code>ä¸­ã€‚</p><p>ç”Ÿæˆè¯¾ç¨‹åˆ†ç±»è¡¨çš„mapperæ–‡ä»¶å¹¶æ‹·è´è‡³å†…å®¹ç®¡ç†æ¨¡å— çš„serviceå·¥ç¨‹ä¸­ã€‚</p><ol><li>ä¸‹è¾¹ å®šä¹‰ä¸€ä¸ªmapperæ–¹æ³•ï¼Œå¹¶å®šä¹‰sqlè¯­å¥ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">CourseCategoryMapper</span> <span class="keyword">extends</span> <span class="title class_">BaseMapper</span>&lt;CourseCategory&gt; &#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;CourseCategoryTreeDto&gt; <span class="title function_">selectTreeNodes</span><span class="params">(String id)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>æ‰¾åˆ°å¯¹åº” çš„mapper.xmlæ–‡ä»¶ï¼Œç¼–å†™sqlè¯­å¥ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Java</span><br><span class="line">&lt;select id=<span class="string">&quot;selectTreeNodes&quot;</span> resultType=<span class="string">&quot;com.xuecheng.content.model.dto.CourseCategoryTreeDto&quot;</span> parameterType=<span class="string">&quot;string&quot;</span>&gt;</span><br><span class="line">    with recursive t1 <span class="title function_">as</span> <span class="params">(</span></span><br><span class="line"><span class="params">        select * from  course_category p where  id= #&#123;id&#125;</span></span><br><span class="line"><span class="params">        union all</span></span><br><span class="line"><span class="params">        select t.* from course_category t inner join t1 on t1.id = t.parentid</span></span><br><span class="line"><span class="params">    )</span></span><br><span class="line">    select *  from t1 order by t1.id, t1.orderby</span><br><span class="line"></span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure><h3 id="4-3-3-å¼€å‘service"><a href="#4-3-3-å¼€å‘service" class="headerlink" title="4.3.3 å¼€å‘service"></a>4.3.3 å¼€å‘service</h3><ol><li>å®šä¹‰serviceæ¥å£ï¼Œ</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Java</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">CourseCategoryService</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯¾ç¨‹åˆ†ç±»æ ‘å½¢ç»“æ„æŸ¥è¯¢</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;CourseCategoryTreeDto&gt; <span class="title function_">queryTreeNodes</span><span class="params">(String id)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>ç¼–å†™serviceæ¥å£å®ç°<ul><li>è°ƒç”¨mapperæŸ¥è¯¢è¯¾ç¨‹åˆ†ç±»ï¼Œéå†æ•°æ®æŒ‰ç…§æ¥å£è¦æ±‚å¯¹æ•°æ®è¿›è¡Œå°è£…</li></ul></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CourseCategoryServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">CourseCategoryService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    CourseCategoryMapper courseCategoryMapper;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;CourseCategoryTreeDto&gt; <span class="title function_">queryTreeNodes</span><span class="params">(String id)</span> &#123;</span><br><span class="line">       List&lt;CourseCategoryTreeDto&gt; courseCategoryTreeDtos = courseCategoryMapper.selectTreeNodes(id);</span><br><span class="line">    <span class="comment">//å°†listè½¬map,ä»¥å¤‡ä½¿ç”¨,æ’é™¤æ ¹èŠ‚ç‚¹</span></span><br><span class="line">    Map&lt;String, CourseCategoryTreeDto&gt; mapTemp = courseCategoryTreeDtos.stream().filter(item-&gt;!id.equals(item.getId())).collect(Collectors.toMap(key -&gt; key.getId(), value -&gt; value, (key1, key2) -&gt; key2));</span><br><span class="line">    <span class="comment">//æœ€ç»ˆè¿”å›çš„list</span></span><br><span class="line">    List&lt;CourseCategoryTreeDto&gt; categoryTreeDtos = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">//ä¾æ¬¡éå†æ¯ä¸ªå…ƒç´ ,æ’é™¤æ ¹èŠ‚ç‚¹</span></span><br><span class="line">    courseCategoryTreeDtos.stream().filter(item-&gt;!id.equals(item.getId())).forEach(item-&gt;&#123;</span><br><span class="line">        <span class="keyword">if</span>(item.getParentid().equals(id))&#123;</span><br><span class="line">            categoryTreeDtos.add(item);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//æ‰¾åˆ°å½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹</span></span><br><span class="line">        <span class="type">CourseCategoryTreeDto</span> <span class="variable">courseCategoryTreeDto</span> <span class="operator">=</span> mapTemp.get(item.getParentid());</span><br><span class="line">        <span class="keyword">if</span>(courseCategoryTreeDto!=<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(courseCategoryTreeDto.getChildrenTreeNodes() ==<span class="literal">null</span>)&#123;</span><br><span class="line">                courseCategoryTreeDto.setChildrenTreeNodes(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;CourseCategoryTreeDto&gt;());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//ä¸‹è¾¹å¼€å§‹å¾€ChildrenTreeNodeså±æ€§ä¸­æ”¾å­èŠ‚ç‚¹</span></span><br><span class="line">            courseCategoryTreeDto.getChildrenTreeNodes().add(item);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> categoryTreeDtos;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-3-4-å•å…ƒæµ‹è¯•"><a href="#4-3-4-å•å…ƒæµ‹è¯•" class="headerlink" title="4.3.4 å•å…ƒæµ‹è¯•"></a>4.3.4 å•å…ƒæµ‹è¯•</h3><p>å®šä¹‰å•å…ƒæµ‹è¯•ç±»å¯¹serviceæ¥å£è¿›è¡Œæµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CourseCategoryServiceTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    CourseCategoryService courseCategoryService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testqueryTreeNodes</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;CourseCategoryTreeDto&gt; categoryTreeDtos = courseCategoryService.queryTreeNodes(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">        System.out.println(categoryTreeDtos);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-4-æ¥å£åŠŸèƒ½å®Œå–„"><a href="#4-4-æ¥å£åŠŸèƒ½å®Œå–„" class="headerlink" title="4.4 æ¥å£åŠŸèƒ½å®Œå–„"></a>4.4 æ¥å£åŠŸèƒ½å®Œå–„</h2><h3 id="4-4-1-æ¥å£å±‚ä»£ç å®Œå–„"><a href="#4-4-1-æ¥å£å±‚ä»£ç å®Œå–„" class="headerlink" title="4.4.1 æ¥å£å±‚ä»£ç å®Œå–„"></a>4.4.1 æ¥å£å±‚ä»£ç å®Œå–„</h3><p>å®Œå–„controlleræ–¹æ³•ï¼Œæ³¨å…¥serviceè°ƒç”¨ä¸šåŠ¡å±‚æ–¹æ³•æŸ¥è¯¢è¯¾ç¨‹åˆ†ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.content.api;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.model.dto.CourseCategoryTreeDto;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.service.CourseCategoryService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è¯¾ç¨‹åˆ†ç±»ç›¸å…³æ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/22 17:45</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CourseCategoryController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> CourseCategoryService courseCategoryService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/course-category/tree-nodes&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;CourseCategoryTreeDto&gt; <span class="title function_">queryTreeNodes</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> courseCategoryService.queryTreeNodes(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="4-4-2-æµ‹è¯•æ¥å£"><a href="#4-4-2-æµ‹è¯•æ¥å£" class="headerlink" title="4.4.2 æµ‹è¯•æ¥å£"></a>4.4.2 æµ‹è¯•æ¥å£</h3><p>1ï¸âƒ£å…ˆä½¿ç”¨ideaçš„httpæ’ä»¶è¿›è¡Œæµ‹è¯•</p><ul><li>æ£€æŸ¥æ•°æ®è¿”å›æ˜¯å¦æ­£å¸¸</li></ul><p>2ï¸âƒ£å†è¿›å…¥å‰ç«¯é¡µé¢è¿›è¡Œæµ‹è¯•</p><ul><li>å®Œæˆå‰åç«¯è”è°ƒ</li></ul><h1 id="5-æ–°å¢è¯¾ç¨‹"><a href="#5-æ–°å¢è¯¾ç¨‹" class="headerlink" title="5. æ–°å¢è¯¾ç¨‹"></a>5. æ–°å¢è¯¾ç¨‹</h1><h2 id="5-0-é¢è¯•"><a href="#5-0-é¢è¯•" class="headerlink" title="5.0 é¢è¯•"></a>5.0 é¢è¯•</h2><h3 id="5-0-1-mybatisæ•°æ®åº“æ–¹é¢"><a href="#5-0-1-mybatisæ•°æ®åº“æ–¹é¢" class="headerlink" title="5.0.1 mybatisæ•°æ®åº“æ–¹é¢"></a>5.0.1 mybatisæ•°æ®åº“æ–¹é¢</h3><p>1ï¸âƒ£æ ‘å½¢è¡¨çš„æ ‡è®°å­—æ®µæ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•æŸ¥è¯¢ MySql æ ‘å½¢è¡¨ï¼Ÿ</p><ul><li>æ ‘å½¢è¡¨å®šç‚¹æ ‡è®°å­—æ®µæ˜¯ <code>parentId</code> å³çˆ¶èŠ‚ç‚¹çš„id</li><li>æŸ¥è¯¢æ ‘å½¢è¡¨çš„æ–¹æ³•ï¼š<ol><li>å½“å±‚çº§å›ºå®šæ—¶å¯ä»¥ç”¨è¡¨çš„è‡ªè¿æ¥è¿›è¡ŒæŸ¥è¯¢</li><li>å¦‚æœæƒ³çµæ´»æŸ¥è¯¢æ¯ä¸ªå±‚çº§å¯ä»¥ä½¿ç”¨ mysql é€’å½’æ–¹æ³•ï¼Œä½¿ç”¨ <code>with recursive</code> å®ç°</li></ol></li></ul><p>2ï¸âƒ£MyBatisçš„ResultTypeå’ŒResultMapçš„åŒºåˆ«ï¼Ÿ</p><ul><li>ResultTypeï¼šæŒ‡å®šæ˜ å°„ç±»å‹ï¼Œåªè¦æŸ¥è¯¢çš„å­—æ®µåå’Œç±»å‹çš„å±æ€§ååŒ¹é…å¯ä»¥è‡ªåŠ¨æ˜ å°„</li><li>ResultMapï¼šè‡ªå®šä¹‰æ˜ å°„è§„åˆ™ï¼Œå½“æŸ¥è¯¢çš„å­—æ®µåå’Œæ˜ å°„ç±»å‹çš„å±æ€§ä¸åŒ¹é…æ—¶å¯ä»¥é€šè¿‡ResultMapè‡ªå®šä¹‰æ˜ å°„è§„åˆ™ï¼Œä¹Ÿå¯ä»¥å®ç°ä¸€å¯¹å¤šã€ä¸€å¯¹ä¸€æ˜ å°„ã€‚</li></ul><p>3ï¸âƒ£<code>#&#123;&#125;</code> å’Œ <code>$&#123;&#125;</code> æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><ul><li><code>#&#123;&#125;</code>ï¼šæ˜¯æ ‡è®°ä¸€ä¸ªå ä½ç¬¦ï¼Œå¯ä»¥é˜²æ­¢sqlæ³¨å…¥</li><li><code>$&#123;&#125;</code>ï¼šç”¨äºåœ¨åŠ¨æ€sqlä¸­æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œå¯èƒ½å¯¼è‡´sqlæ³¨å…¥</li></ul><blockquote><p>æ³¨ï¼šSqlæ³¨å…¥ç®€ä»‹</p><ul><li>Sqlæ³¨å…¥æ”»å‡»æ˜¯é€šè¿‡å°†æ¶æ„çš„ Sql æŸ¥è¯¢æˆ–æ·»åŠ è¯­å¥æ’å…¥åˆ°åº”ç”¨çš„è¾“å…¥å‚æ•°ä¸­ï¼Œ</li><li>å†åœ¨åå° Sql æœåŠ¡å™¨ä¸Šè§£ææ‰§è¡Œè¿›è¡Œçš„æ”»å‡»</li></ul></blockquote><h3 id="5-0-2-å¼‚å¸¸å¤„ç†æ–¹é¢"><a href="#5-0-2-å¼‚å¸¸å¤„ç†æ–¹é¢" class="headerlink" title="5.0.2 å¼‚å¸¸å¤„ç†æ–¹é¢"></a>5.0.2 å¼‚å¸¸å¤„ç†æ–¹é¢</h3><p>1ï¸âƒ£ç³»ç»Ÿå¦‚ä½•å¤„ç†å¼‚å¸¸</p><ul><li>æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†å™¨å»æ•è·å¹¶å¤„ç†å¼‚å¸¸</li><li>ä½¿ç”¨æ§åˆ¶å™¨å¢å¼ºæ³¨è§£ @ControllerAdvice å’Œå¼‚å¸¸å¤„ç†æ³¨è§£ @ExceptionHandleræ¥å®ç°</li></ul><ol><li>å¤„ç†è‡ªå®šä¹‰å¼‚å¸¸<ul><li>ç¨‹åºåœ¨ç¼–å†™ä»£ç æ—¶æ ¹æ®æ ¡éªŒç»“æœä¸»åŠ¨æŠ›å‡ºè‡ªå®šä¹‰å¼‚å¸¸ç±»å¯¹è±¡ï¼ŒæŠ›å‡ºå¼‚å¸¸æ—¶æŒ‡å®šè¯¦ç»†çš„å¼‚å¸¸ä¿¡æ¯ï¼Œå¼‚å¸¸å¤„ç†å™¨æ•è·å¼‚å¸¸ä¿¡æ¯è®°å½•å¼‚å¸¸æ—¥å¿—å¹¶å“åº”ç»™ç”¨æˆ·ã€‚</li></ul></li><li>å¤„ç†æœªçŸ¥å¼‚å¸¸<ul><li>æ¥å£æ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä¸€äº›è¿è¡Œæ—¶å¼‚å¸¸ä¹Ÿä¼šç”±å¼‚å¸¸å¤„ç†å™¨ç»Ÿä¸€æ•è·ï¼Œè®°å½•å¼‚å¸¸æ—¥å¿—ï¼Œç»Ÿä¸€å“åº”ç»™ç”¨æˆ·500é”™è¯¯ã€‚</li></ul></li></ol><ol><li>åœ¨å¼‚å¸¸å¤„ç†å™¨ä¸­è¿˜å¯ä»¥æ­£å¯¹æŸä¸ªå¼‚å¸¸ç±»å‹è¿›è¡Œå•ç‹¬å¤„ç†</li></ol><h3 id="5-0-3-ç³»ç»Ÿå‚æ•°åˆæ³•æ€§æ ¡éªŒæ–¹é¢"><a href="#5-0-3-ç³»ç»Ÿå‚æ•°åˆæ³•æ€§æ ¡éªŒæ–¹é¢" class="headerlink" title="5.0.3 ç³»ç»Ÿå‚æ•°åˆæ³•æ€§æ ¡éªŒæ–¹é¢"></a>5.0.3 ç³»ç»Ÿå‚æ•°åˆæ³•æ€§æ ¡éªŒæ–¹é¢</h3><p>1ï¸âƒ£è¯·æ±‚å‚æ•°çš„åˆæ³•æ€§æ ¡éªŒå¦‚ä½•åš</p><ul><li>ä½¿ç”¨åŸºäº <code>JSR303</code> çš„æ ¡éªŒæ¡†æ¶å®ç°ï¼Œspringboot æä¾›äº† JSR-303 çš„æ”¯æŒï¼Œå®ƒå°±æ˜¯ spring-boot-starter-validationï¼Œ</li><li>å®ƒåŒ…æ‹¬äº†å¾ˆå¤šæ ¡éªŒè§„åˆ™ï¼Œåªéœ€è¦åœ¨æ¨¡å‹ç±»ä¸­é€šè¿‡æ³¨è§£æŒ‡å®šæ ¡éªŒè§„åˆ™ï¼Œåœ¨controlleræ–¹æ³•ä¸Šå¼€å¯æ ¡éªŒ</li></ul><h2 id="5-1-éœ€æ±‚åˆ†æ"><a href="#5-1-éœ€æ±‚åˆ†æ" class="headerlink" title="5.1 éœ€æ±‚åˆ†æ"></a>5.1 éœ€æ±‚åˆ†æ</h2><h3 id="5-1-1-ä¸šåŠ¡æµç¨‹"><a href="#5-1-1-ä¸šåŠ¡æµç¨‹" class="headerlink" title="5.1.1 ä¸šåŠ¡æµç¨‹"></a>5.1.1 ä¸šåŠ¡æµç¨‹</h3><p>æ ¹æ®å‰è¾¹å¯¹å†…å®¹ç®¡ç†æ¨¡å—çš„æ•°æ®æ¨¡å‹åˆ†æï¼Œ</p><ul><li>è¯¾ç¨‹ç›¸å…³çš„ä¿¡æ¯æœ‰ï¼šè¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ã€è¯¾ç¨‹è¥é”€ä¿¡æ¯ã€è¯¾ç¨‹å›¾ç‰‡ä¿¡æ¯ã€è¯¾ç¨‹è®¡åˆ’ã€è¯¾ç¨‹å¸ˆèµ„ä¿¡æ¯ï¼Œ</li><li>æ‰€ä»¥æ–°å¢ä¸€é—¨è¯¾ç¨‹éœ€è¦å®Œæˆè¿™å‡ éƒ¨åˆ†ä¿¡æ¯çš„å¡«å†™ã€‚</li></ul><p><strong>ä»¥ä¸‹æ˜¯ä¸šåŠ¡æµç¨‹</strong>ï¼š</p><ol><li>è¿›å…¥è¯¾ç¨‹æŸ¥è¯¢åˆ—è¡¨</li></ol><p><img src="https://picbed1.taoyaopc.live/xczx/wps1-1684822261290-1.jpg" alt="img"> </p><ol><li>ç‚¹å‡»æ·»åŠ è¯¾ç¨‹ï¼Œé€‰æ‹©è¯¾ç¨‹å½¢å¼ä¸ºå½•æ’­ã€‚</li></ol><p><img src="https://picbed1.taoyaopc.live/xczx/wps2-1684822261291-2.jpg" alt="img" style="zoom:50%;" /> </p><ol><li>é€‰æ‹©å®Œæ¯•ï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œè¿›å…¥è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯æ·»åŠ ç•Œé¢ã€‚<ul><li>æœ¬ç•Œé¢åˆ†ä¸¤éƒ¨åˆ†ä¿¡æ¯ï¼Œä¸€éƒ¨åˆ†æ˜¯è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ä¸Šï¼Œä¸€éƒ¨åˆ†æ˜¯è¯¾ç¨‹è¥é”€ä¿¡æ¯ã€‚</li></ul></li></ol><p>è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ï¼š</p><p><img src="https://picbed1.taoyaopc.live/xczx/wps3-1684822261292-3.jpg" alt="img" style="zoom:67%;" /> </p><p>è¯¾ç¨‹è¥é”€ä¿¡æ¯ï¼š</p><p><img src="https://picbed1.taoyaopc.live/xczx/wps4-1684822261292-5.jpg" alt="img" style="zoom:67%;" /> </p><p>åœ¨è¿™ä¸ªç•Œé¢ä¸­å¡«å†™è¯¾ç¨‹çš„åŸºæœ¬ä¿¡æ¯ã€è¯¾ç¨‹è¥é”€ä¿¡æ¯ä¸Šã€‚</p><p>å¡«å†™å®Œæ¯•ï¼Œä¿å­˜å¹¶è¿›è¡Œä¸‹ä¸€æ­¥ã€‚</p><ol><li>åœ¨æ­¤ç•Œé¢å¡«å†™è¯¾ç¨‹è®¡åˆ’ä¿¡æ¯</li></ol><p><img src="https://picbed1.taoyaopc.live/xczx/wps5-1684822261292-4.jpg" alt="img"> </p><ul><li>è¯¾ç¨‹è®¡åˆ’å³è¯¾ç¨‹çš„å¤§çº²ç›®å½•ã€‚</li><li>è¯¾ç¨‹è®¡åˆ’åˆ†ä¸ºä¸¤çº§ï¼Œç« èŠ‚å’Œå°èŠ‚ã€‚</li><li>æ¯ä¸ªå°èŠ‚éœ€è¦ä¸Šä¼ è¯¾ç¨‹è§†é¢‘ï¼Œç”¨æˆ·ç‚¹å‡» å°èŠ‚çš„æ ‡é¢˜å³å¼€å§‹æ’­æ”¾è§†é¢‘ã€‚</li><li>å¦‚æœæ˜¯ç›´æ’­è¯¾ç¨‹åˆ™ä¼šè¿›å…¥ç›´æ’­é—´ã€‚</li></ul><ol><li>è¯¾ç¨‹ è®¡åˆ’å¡«å†™å®Œæ¯•è¿›å…¥è¯¾ç¨‹å¸ˆèµ„çš„ç®¡ç†ã€‚</li></ol><p><img src="https://picbed1.taoyaopc.live/xczx/wps6-1684822261292-6.jpg" alt="img"> </p><p>åœ¨è¯¾ç¨‹å¸ˆèµ„ç•Œé¢ç»´æŠ¤è¯¥è¯¾ç¨‹çš„æˆè¯¾è€å¸ˆã€‚</p><p><img src="https://picbed1.taoyaopc.live/xczx/wps7-1684822261293-7.jpg" alt="img" style="zoom:67%;" /> </p><p>è‡³æ­¤ï¼Œä¸€é—¨è¯¾ç¨‹æ–°å¢å®Œæˆã€‚</p><h3 id="5-1-2-æ•°æ®æ¨¡å‹"><a href="#5-1-2-æ•°æ®æ¨¡å‹" class="headerlink" title="5.1.2 æ•°æ®æ¨¡å‹"></a>5.1.2 æ•°æ®æ¨¡å‹</h3><p>é€šè¿‡ä¸šåŠ¡æµç¨‹å¯çŸ¥ï¼Œä¸€é—¨è¯¾ç¨‹ä¿¡æ¯æ¶‰åŠï¼šè¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ã€è¯¾ç¨‹è¥é”€ä¿¡æ¯ã€è¯¾ç¨‹è®¡åˆ’ä¿¡æ¯ã€è¯¾ç¨‹å¸ˆèµ„ä¿¡æ¯ã€‚</p><ul><li><p>æœ¬èŠ‚å¼€å‘æ–°å¢è¯¾ç¨‹æŒ‰é’®åŠŸèƒ½ï¼Œ åªå‘è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ã€è¯¾ç¨‹è¥é”€ä¿¡æ¯æ·»åŠ è®°å½•ã€‚</p></li><li><p>è¿™ä¸¤éƒ¨åˆ†ä¿¡æ¯åˆ†åˆ«åœ¨course_baseã€course_marketä¸¤å¼ è¡¨å­˜å‚¨ã€‚</p></li><li>å½“ç‚¹å‡»ä¿å­˜æŒ‰é’®æ—¶å‘è¿™ä¸¤å¼ è¡¨æ’å…¥æ•°æ®ã€‚</li><li>è¿™ä¸¤å¼ è¡¨æ˜¯ä¸€å¯¹ä¸€å…³è”å…³ç³»ã€‚</li></ul><p><strong>course_base</strong></p><p><img src="https://picbed1.taoyaopc.live/xczx/image-20230523141606991.png" alt="image-20230523141606991"></p><p><strong>course_market</strong></p><p><img src="https://picbed1.taoyaopc.live/xczx/image-20230523141709184.png" alt="image-20230523141709184"></p><p>æ–°å»ºè¯¾ç¨‹çš„åˆå§‹å®¡æ ¸çŠ¶æ€ä¸ºâ€œæœªæäº¤â€ã€åˆå§‹å‘å¸ƒçŠ¶æ€ä¸ºâ€œæœªå‘å¸ƒâ€ã€‚</p><p>ç”Ÿæˆè¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ã€è¯¾ç¨‹è¥é”€ä¿¡æ¯çš„POã€Mapperæ–‡ä»¶ </p><h2 id="5-2-æ¥å£å®šä¹‰"><a href="#5-2-æ¥å£å®šä¹‰" class="headerlink" title="5.2 æ¥å£å®šä¹‰"></a>5.2 æ¥å£å®šä¹‰</h2><p>æ ¹æ®ä¸šåŠ¡æµç¨‹ï¼Œè¿™é‡Œå…ˆå®šä¹‰æäº¤è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯çš„æ¥å£ã€‚</p><ol><li><p>æ¥å£åè®® ï¼šHTTP POSTï¼ŒContent-Typeä¸ºapplication/json</p></li><li><p>è¯·æ±‚åŠå“åº”ç»“æœå¦‚ä¸‹</p></li></ol><p><img src="https://picbed1.taoyaopc.live/xczx/wps8-1684822939718-15.jpg" alt="img"> </p><ol><li>æ¥å£è¯·æ±‚ç¤ºä¾‹å¦‚ä¸‹</li></ol><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">Java</span><br><span class="line">### åˆ›å»ºè¯¾ç¨‹</span><br><span class="line">POST <span class="punctuation">&#123;</span><span class="punctuation">&#123;</span>content_host<span class="punctuation">&#125;</span><span class="punctuation">&#125;</span>/content/course</span><br><span class="line">Content-Type<span class="punctuation">:</span> application/json</span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">&quot;mt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;st&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;pic&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;teachmode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;200002&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;users&quot;</span><span class="punctuation">:</span> <span class="string">&quot;åˆçº§äººå‘˜&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;tags&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;grade&quot;</span><span class="punctuation">:</span> <span class="string">&quot;204001&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;charge&quot;</span><span class="punctuation">:</span> <span class="string">&quot;201000&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;price&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;originalPrice&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;qq&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;wechat&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;phone&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;validDays&quot;</span><span class="punctuation">:</span> <span class="number">365</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">###å“åº”ç»“æœå¦‚ä¸‹</span><br><span class="line">#æˆåŠŸå“åº”ç»“æœå¦‚ä¸‹</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">109</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;companyId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;companyName&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æµ‹è¯•è¯¾ç¨‹103&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;users&quot;</span><span class="punctuation">:</span> <span class="string">&quot;åˆçº§äººå‘˜&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;tags&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;mt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1-1&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;mtName&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;st&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1-1-1&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;stName&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;grade&quot;</span><span class="punctuation">:</span> <span class="string">&quot;204001&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;teachmode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;200002&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;pic&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;createDate&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2022-09-08 07:35:16&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;changeDate&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;createPeople&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;changePeople&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;auditStatus&quot;</span><span class="punctuation">:</span> <span class="string">&quot;202002&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;coursePubId&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;coursePubDate&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;charge&quot;</span><span class="punctuation">:</span> <span class="string">&quot;201000&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;price&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;originalPrice&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;qq&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;wechat&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;phone&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;validDays&quot;</span><span class="punctuation">:</span> <span class="number">365</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><ol><li>å®šä¹‰è¯·æ±‚å‚æ•°ç±»å‹å’Œå“åº”ç»“æ„ç±»å‹<ul><li>æ ¹æ®æ¥å£å®šä¹‰å†…å®¹ï¼Œè¯·æ±‚å‚æ•°ç›¸æ¯” CourseBaseæ¨¡å‹ç±»ä¸ä¸€è‡´ï¼Œéœ€è¦åœ¨dtoåŒ…ä¸‹è‡ªå®šä¹‰ï¼Œ</li><li>æ¨¡å‹ç±»ä»è¯¾ç¨‹èµ„æ–™/å·¥ç¨‹ç›®å½•è·å–ã€‚</li><li>AddCourseDto + CourseBaseInfoDto</li></ul></li></ol><p>AddCourseDto</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.content.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModel;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.NotEmpty;</span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.Size;</span><br><span class="line"><span class="keyword">import</span> java.math.BigDecimal;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ·»åŠ è¯¾ç¨‹ Dto</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/20 11:58</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ApiModel(value = &quot;AddCourseDto&quot;, description = &quot;æ–°å¢è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AddCourseDto</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotEmpty(message = &quot;è¯¾ç¨‹åç§°ä¸èƒ½ä¸ºç©º&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è¯¾ç¨‹åç§°&quot;, required = true)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotEmpty(message = &quot;é€‚ç”¨äººç¾¤ä¸èƒ½ä¸ºç©º&quot;)</span></span><br><span class="line">    <span class="meta">@Size(message = &quot;é€‚ç”¨äººç¾¤å†…å®¹è¿‡å°‘&quot;, min = 10)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;é€‚ç”¨äººç¾¤&quot;, required = true)</span></span><br><span class="line">    <span class="keyword">private</span> String users;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è¯¾ç¨‹æ ‡ç­¾&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String tags;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotEmpty(message = &quot;è¯¾ç¨‹åˆ†ç±»ä¸èƒ½ä¸ºç©º&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;å¤§åˆ†ç±»&quot;, required = true)</span></span><br><span class="line">    <span class="keyword">private</span> String mt;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotEmpty(message = &quot;è¯¾ç¨‹åˆ†ç±»ä¸èƒ½ä¸ºç©º&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;å°åˆ†ç±»&quot;, required = true)</span></span><br><span class="line">    <span class="keyword">private</span> String st;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotEmpty(message = &quot;è¯¾ç¨‹ç­‰çº§ä¸èƒ½ä¸ºç©º&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è¯¾ç¨‹ç­‰çº§&quot;, required = true)</span></span><br><span class="line">    <span class="keyword">private</span> String grade;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;æ•™å­¦æ¨¡å¼ï¼ˆæ™®é€šï¼Œå½•æ’­ï¼Œç›´æ’­ç­‰ï¼‰&quot;, required = true)</span></span><br><span class="line">    <span class="keyword">private</span> String teachmode;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è¯¾ç¨‹ä»‹ç»&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String description;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è¯¾ç¨‹å›¾ç‰‡&quot;, required = true)</span></span><br><span class="line">    <span class="keyword">private</span> String pic;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotEmpty(message = &quot;æ”¶è´¹è§„åˆ™ä¸èƒ½ä¸ºç©º&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;æ”¶è´¹è§„åˆ™ï¼Œå¯¹åº”æ•°æ®å­—å…¸&quot;, required = true)</span></span><br><span class="line">    <span class="keyword">private</span> String charge;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;ä»·æ ¼&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Float price;</span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;åŸä»·&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Float originalPrice;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;qq&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String qq;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;å¾®ä¿¡&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String wechat;</span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;ç”µè¯&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String phone;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;æœ‰æ•ˆæœŸ&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer validDays;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>CourseBaseInfoDto</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.content.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.model.po.CourseBase;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModel;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.math.BigDecimal;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ Dto</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/20 11:58</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ApiModel(value = &quot;CourseBaseInfoDto&quot;, description = &quot;è¿”å›è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CourseBaseInfoDto</span> <span class="keyword">extends</span> <span class="title class_">CourseBase</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ”¶è´¹è§„åˆ™ï¼Œå¯¹åº”æ•°æ®å­—å…¸</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String charge;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»·æ ¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Float price;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŸä»·</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Float originalPrice;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å’¨è¯¢qq</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String qq;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¾®ä¿¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String wechat;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”µè¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String phone;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœ‰æ•ˆæœŸå¤©æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer validDays;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¤§åˆ†ç±»åç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String mtName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°åˆ†ç±»åç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String stName;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol><li>å®šä¹‰æ¥å£å¦‚ä¸‹</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;æ–°å¢è¯¾ç¨‹&quot;)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/content/course&quot;)</span></span><br><span class="line"><span class="keyword">public</span> CourseBaseInfoDto <span class="title function_">createCourseBase</span><span class="params">(<span class="meta">@RequestBody</span> AddCourseDto addCourseDto)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5-3-æ¥å£å¼€å‘"><a href="#5-3-æ¥å£å¼€å‘" class="headerlink" title="5.3 æ¥å£å¼€å‘"></a>5.3 æ¥å£å¼€å‘</h2><h3 id="5-3-1-ä¿å­˜è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯"><a href="#5-3-1-ä¿å­˜è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯" class="headerlink" title="5.3.1 ä¿å­˜è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯"></a>5.3.1 ä¿å­˜è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯</h3><p>æ ¹æ®éœ€æ±‚åˆ†æï¼Œæ–°å¢è¯¾ç¨‹è¡¨å•ä¸­åŒ…æ‹¬äº†è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ã€è¯¾ç¨‹è¥é”€ä¿¡æ¯ï¼Œ</p><ul><li>éœ€è¦åˆ†åˆ«å‘è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯è¡¨ã€è¯¾ç¨‹è¥é”€è¡¨ä¿è¯æ•°æ®ã€‚</li></ul><ol><li>å®šä¹‰ Service æ¥å£</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * æ–°å¢è¯¾ç¨‹</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> companyId æœºæ„ ID</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> addCourseDto æ–°å¢è¯¾ç¨‹ä¿¡æ¯</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@return</span> è¿”å›è¯¾ç¨‹ä¿¡æ¯</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">CourseBaseInfoDto <span class="title function_">createCourseBase</span><span class="params">(Long companyId, AddCourseDto addCourseDto)</span>;</span><br></pre></td></tr></table></figure><ol><li>ç¼–å†™serviceæ¥å£å®ç°ç±»ï¼Œå®ç°å‘è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯è¡¨ä¿å­˜æ•°æ®ï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> CourseBaseInfoDto <span class="title function_">createCourseBase</span><span class="params">(Long companyId, AddCourseDto dto)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‚æ•°åˆæ³•æ€§æ ¡éªŒ</span></span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isBlank(dto.getName())) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;è¯¾ç¨‹åç§°ä¸ºç©º&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isBlank(dto.getMt())) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;è¯¾ç¨‹åˆ†ç±»ä¸ºç©º&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isBlank(dto.getSt())) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;è¯¾ç¨‹åˆ†ç±»ä¸ºç©º&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isBlank(dto.getGrade())) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;è¯¾ç¨‹ç­‰çº§ä¸ºç©º&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isBlank(dto.getTeachmode())) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;æ•™è‚²æ¨¡å¼ä¸ºç©º&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isBlank(dto.getUsers())) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;é€‚åº”äººç¾¤ä¸ºç©º&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isBlank(dto.getCharge())) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;æ”¶è´¹è§„åˆ™ä¸ºç©º&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‘è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯è¡¨course_baseå†™å…¥æ•°æ®</span></span><br><span class="line">    <span class="type">CourseBase</span> <span class="variable">courseBaseNew</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CourseBase</span>();</span><br><span class="line">    <span class="comment">// å°†ä¼ å…¥çš„é¡µé¢çš„å‚æ•°æ”¾åˆ°courseBaseNewå¯¹è±¡</span></span><br><span class="line">    <span class="comment">// courseBaseNew.setName(dto.getName());</span></span><br><span class="line">    <span class="comment">// courseBaseNew.setDescription(dto.getDescription());</span></span><br><span class="line">    BeanUtils.copyProperties(dto, courseBaseNew); <span class="comment">// åªè¦å±æ€§åç§°ä¸€è‡´å°±å¯ä»¥æ‹·è´</span></span><br><span class="line">    courseBaseNew.setCompanyId(companyId);</span><br><span class="line">    courseBaseNew.setCreateDate(LocalDateTime.now());</span><br><span class="line">    <span class="comment">// å®¡æ ¸çŠ¶æ€é»˜è®¤ä¸ºæœªæäº¤</span></span><br><span class="line">    courseBaseNew.setAuditStatus(<span class="string">&quot;202002&quot;</span>);</span><br><span class="line">    <span class="comment">// å‘å¸ƒçŠ¶æ€ä¸ºæœªå‘å¸ƒ</span></span><br><span class="line">    courseBaseNew.setStatus(<span class="string">&quot;202001&quot;</span>);</span><br><span class="line">    <span class="comment">// æ’å…¥æ•°æ®åº“</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">insert</span> <span class="operator">=</span> courseBaseMapper.insert(courseBaseNew);</span><br><span class="line">    <span class="keyword">if</span>(insert &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;æ·»åŠ è¯¾ç¨‹å¤±è´¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// todo:å‘è¯¾ç¨‹è¥é”€è¡¨ä¿å­˜è¯¾ç¨‹è¥é”€ä¿¡æ¯</span></span><br><span class="line"><span class="comment">// todo:æŸ¥è¯¢è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯åŠè¥é”€ä¿¡æ¯å¹¶è¿”å›</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å‘è¯¾ç¨‹è¥é”€ç³»course_marketå†™å…¥æ•°æ®</span></span><br><span class="line">    <span class="type">CourseMarket</span> <span class="variable">courseMarketNew</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CourseMarket</span>();</span><br><span class="line">    <span class="comment">// å°†é¡µé¢è¾“å…¥çš„æ•°æ®æ‹·è´åˆ°courseMarketNew</span></span><br><span class="line">    BeanUtils.copyProperties(dto, courseMarketNew);</span><br><span class="line">    <span class="comment">// è®¾ç½®ä¸»é”®ï¼Œè¯¾ç¨‹çš„ id</span></span><br><span class="line">    <span class="type">Long</span> <span class="variable">courseId</span> <span class="operator">=</span> courseBaseNew.getId();</span><br><span class="line">    courseMarketNew.setId(courseId);</span><br><span class="line">    <span class="comment">// ä¿å­˜è¥é”€ä¿¡æ¯</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">success</span> <span class="operator">=</span> saveCourseMarket(courseMarketNew);</span><br><span class="line">    <span class="keyword">if</span>(success &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;ä¿å­˜è¯¾ç¨‹è¥é”€ä¿¡æ¯å¤±è´¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ä»æ•°æ®åº“æŸ¥è¯¢è¯¾ç¨‹çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼Œå¹¶è¿”å›</span></span><br><span class="line">    <span class="keyword">return</span> getCourseBaseInfo(courseId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-3-2-ä¿å­˜è¥é”€ä¿¡æ¯"><a href="#5-3-2-ä¿å­˜è¥é”€ä¿¡æ¯" class="headerlink" title="5.3.2 ä¿å­˜è¥é”€ä¿¡æ¯"></a>5.3.2 ä¿å­˜è¥é”€ä¿¡æ¯</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å•ç‹¬å†™ä¸€ä¸ªæ–¹æ³•ä¿å­˜è¥é”€ä¿¡æ¯ï¼Œé€»è¾‘ï¼šå­˜åœ¨åˆ™æ›´æ–°ï¼Œä¸å­˜åœ¨åˆ™æ·»åŠ </span></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="title function_">saveCourseMarket</span><span class="params">(CourseMarket courseMarketNew)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‚æ•°çš„åˆæ³•æ€§æ ¡éªŒ</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">charge</span> <span class="operator">=</span> courseMarketNew.getCharge();</span><br><span class="line">    <span class="keyword">if</span>(StringUtils.isEmpty(charge)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;æ”¶è´¹è§„åˆ™ä¸ºç©º&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¦‚æœè¯¾ç¨‹æ”¶è´¹ï¼Œä»·æ ¼æ²¡æœ‰å¡«å†™ä¹Ÿéœ€è¦æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">    <span class="keyword">if</span>(charge.equals(<span class="string">&quot;201001&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span>(courseMarketNew.getPrice() == <span class="literal">null</span> || courseMarketNew.getPrice().floatValue() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;è¯¾ç¨‹çš„ä»·æ ¼ä¸èƒ½ä¸ºç©ºå¹¶ä¸”å¿…é¡»å¤§äº0&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä»æ•°æ®åº“æŸ¥è¯¢è¥é”€ä¿¡æ¯ï¼Œå­˜åœ¨åˆ™æ›´æ–°ï¼Œä¸å­˜åœ¨åˆ™æ·»åŠ </span></span><br><span class="line">    <span class="type">Long</span> <span class="variable">courseId</span> <span class="operator">=</span> courseMarketNew.getId();</span><br><span class="line">    <span class="type">CourseMarket</span> <span class="variable">courseMarket</span> <span class="operator">=</span> courseMarketMapper.selectById(courseId);</span><br><span class="line">    <span class="keyword">if</span>(courseMarket == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// æ’å…¥æ•°æ®åº“</span></span><br><span class="line">        <span class="keyword">return</span> courseMarketMapper.insert(courseMarketNew);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// å°†courseMarketNew æ‹·è´åˆ° courseMarket</span></span><br><span class="line">        BeanUtils.copyProperties(courseMarketNew, courseMarket);</span><br><span class="line">        courseMarket.setId(courseId);</span><br><span class="line">        <span class="comment">// æ›´æ–°</span></span><br><span class="line">        <span class="keyword">return</span> courseMarketMapper.updateById(courseMarket);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-3-3-æŸ¥è¯¢è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯åŠè¥é”€ä¿¡æ¯å¹¶è¿”å›"><a href="#5-3-3-æŸ¥è¯¢è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯åŠè¥é”€ä¿¡æ¯å¹¶è¿”å›" class="headerlink" title="5.3.3 æŸ¥è¯¢è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯åŠè¥é”€ä¿¡æ¯å¹¶è¿”å›"></a>5.3.3 æŸ¥è¯¢è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯åŠè¥é”€ä¿¡æ¯å¹¶è¿”å›</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æŸ¥è¯¢è¯¾ç¨‹ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">private</span> CourseBaseInfoDto <span class="title function_">getCourseBaseInfo</span><span class="params">(<span class="type">long</span> courseId)</span> &#123;</span><br><span class="line">    <span class="comment">// ä»è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯è¡¨æŸ¥è¯¢</span></span><br><span class="line">    <span class="type">CourseBase</span> <span class="variable">courseBase</span> <span class="operator">=</span> courseBaseMapper.selectById(courseId);</span><br><span class="line">    <span class="keyword">if</span>(courseBase == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ä»è¯¾ç¨‹è¥é”€è¡¨æŸ¥è¯¢</span></span><br><span class="line">    <span class="type">CourseMarket</span> <span class="variable">courseMarket</span> <span class="operator">=</span> courseMarketMapper.selectById(courseId);</span><br><span class="line">    <span class="comment">// ç»„è£…åœ¨ä¸€èµ·</span></span><br><span class="line">    <span class="type">CourseBaseInfoDto</span> <span class="variable">courseBaseInfoDto</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CourseBaseInfoDto</span>();</span><br><span class="line">    BeanUtils.copyProperties(courseBase, courseBaseInfoDto);</span><br><span class="line">    BeanUtils.copyProperties(courseMarket, courseBaseInfoDto);</span><br><span class="line">    <span class="comment">// é€šè¿‡ courseCategoryMapper æŸ¥è¯¢åˆ†ç±»ä¿¡æ¯ï¼Œå°†åˆ†ç±»åç§°æ”¾åœ¨ courseBaseInfoDtoå¯¹è±¡</span></span><br><span class="line">    <span class="comment">// åŒ…æ‹¬å¤§åˆ†ç±»çš„åç§°ï¼Œå’Œå°åˆ†ç±»çš„åç§°</span></span><br><span class="line">    <span class="type">CourseCategory</span> <span class="variable">courseCategoryMt</span> <span class="operator">=</span> courseCategoryMapper.selectById(courseBase.getMt());</span><br><span class="line">    <span class="type">CourseCategory</span> <span class="variable">courseCategorySt</span> <span class="operator">=</span> courseCategoryMapper.selectById(courseBase.getSt());</span><br><span class="line">    courseBaseInfoDto.setMtName(courseCategoryMt.getName());</span><br><span class="line">    courseBaseInfoDto.setMtName(courseCategorySt.getName());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> courseBaseInfoDto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5-4-æ¥å£æµ‹è¯•"><a href="#5-4-æ¥å£æµ‹è¯•" class="headerlink" title="5.4 æ¥å£æµ‹è¯•"></a>5.4 æ¥å£æµ‹è¯•</h2><ol><li>é¦–å…ˆå»å®Œå–„controlleræ–¹æ³•ï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;æ–°å¢è¯¾ç¨‹&quot;)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/course&quot;)</span></span><br><span class="line"><span class="keyword">public</span> CourseBaseInfoDto <span class="title function_">createCourseBase</span><span class="params">(<span class="meta">@RequestBody</span> AddCourseDto addCourseDto)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–åˆ°ç”¨æˆ·æ‰€å±ç»“æ„çš„ id</span></span><br><span class="line">    <span class="type">Long</span> <span class="variable">companyId</span> <span class="operator">=</span> <span class="number">1232141425L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> courseBaseInfoService.createCourseBase(companyId, addCourseDto);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>ä½¿ç”¨httpclientæµ‹è¯•</li></ol><p>åœ¨xc-content-api.httpä¸­å®šä¹‰ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">### åˆ›å»ºè¯¾ç¨‹</span><br><span class="line">POST &#123;&#123;content_host&#125;&#125;/content/course</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;charge&quot;: &quot;201000&quot;,</span><br><span class="line">  &quot;price&quot;: 0,</span><br><span class="line">  &quot;originalPrice&quot;:0,</span><br><span class="line">  &quot;qq&quot;: &quot;22333&quot;,</span><br><span class="line">  &quot;wechat&quot;: &quot;223344&quot;,</span><br><span class="line">  &quot;phone&quot;: &quot;13333333&quot;,</span><br><span class="line">  &quot;validDays&quot;: 365,</span><br><span class="line">  &quot;mt&quot;: &quot;1-1&quot;,</span><br><span class="line">  &quot;st&quot;: &quot;1-1-1&quot;,</span><br><span class="line">  &quot;name&quot;: &quot;æµ‹è¯•è¯¾ç¨‹103&quot;,</span><br><span class="line">  &quot;pic&quot;: &quot;&quot;,</span><br><span class="line">  &quot;teachmode&quot;: &quot;200002&quot;,</span><br><span class="line">  &quot;users&quot;: &quot;åˆçº§äººå‘˜&quot;,</span><br><span class="line">  &quot;tags&quot;: &quot;&quot;,</span><br><span class="line">  &quot;grade&quot;: &quot;204001&quot;,</span><br><span class="line">  &quot;description&quot;: &quot;&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>å‰åç«¯è”è°ƒ</li></ol><p>æ‰“å¼€æ–°å¢è¯¾ç¨‹é¡µé¢ï¼Œé™¤äº†è¯¾ç¨‹å›¾ç‰‡å…¶å®ƒä¿¡æ¯å…¨éƒ¨è¾“å…¥ã€‚</p><p>ç‚¹å‡»ä¿å­˜ï¼Œè§‚å¯Ÿæµè§ˆå™¨è¯·æ±‚æ¥å£å‚æ•°åŠå“åº”ç»“æœæ˜¯å¦æ­£å¸¸ã€‚</p><h2 id="5-5-å¼‚å¸¸å¤„ç†"><a href="#5-5-å¼‚å¸¸å¤„ç†" class="headerlink" title="5.5 å¼‚å¸¸å¤„ç†"></a>5.5 å¼‚å¸¸å¤„ç†</h2><h3 id="5-5-1-å¼‚å¸¸é—®é¢˜åˆ†æ"><a href="#5-5-1-å¼‚å¸¸é—®é¢˜åˆ†æ" class="headerlink" title="5.5.1 å¼‚å¸¸é—®é¢˜åˆ†æ"></a>5.5.1 å¼‚å¸¸é—®é¢˜åˆ†æ</h3><p>åœ¨serviceæ–¹æ³•ä¸­æœ‰å¾ˆå¤šçš„å‚æ•°åˆæ³•æ€§æ ¡éªŒï¼Œå½“å‚æ•°ä¸åˆæ³•åˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œä¸‹è¾¹æˆ‘ä»¬æµ‹è¯•ä¸‹å¼‚å¸¸å¤„ç†ã€‚</p><ul><li><p>è¯·æ±‚åˆ›å»ºè¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ï¼Œæ•…æ„å°†å¿…å¡«é¡¹è®¾ç½®ä¸ºç©ºã€‚</p></li><li><p>æµ‹è¯•å‘ç°æŠ¥500å¼‚å¸¸</p></li></ul><p>1ï¸âƒ£<strong>é—®é¢˜</strong>ï¼šå¹¶æ²¡æœ‰è¾“å‡ºæˆ‘ä»¬æŠ›å‡ºå¼‚å¸¸æ—¶æŒ‡å®šçš„å¼‚å¸¸ä¿¡æ¯ã€‚</p><ul><li>æ‰€ä»¥ï¼Œç°åœ¨æˆ‘ä»¬çš„éœ€æ±‚æ˜¯å½“æ­£å¸¸æ“ä½œæ—¶æŒ‰æ¥å£è¦æ±‚è¿”å›æ•°æ®ï¼Œ</li><li>å½“éæ­£å¸¸æµç¨‹æ—¶è¦è·å–å¼‚å¸¸ä¿¡æ¯è¿›è¡Œè®°å½•ï¼Œå¹¶æç¤ºç»™ç”¨æˆ·ã€‚</li></ul><p>2ï¸âƒ£å¼‚å¸¸å¤„ç†é™¤äº†è¾“å‡ºåœ¨æ—¥å¿—ä¸­ï¼Œè¿˜éœ€è¦æç¤ºç»™ç”¨æˆ·ï¼Œå‰ç«¯å’Œåç«¯éœ€è¦ä½œä¸€äº›çº¦å®šï¼š</p><ol><li><p>é”™è¯¯æç¤ºä¿¡æ¯ç»Ÿä¸€ä»¥ json æ ¼å¼è¿”å›ç»™å‰ç«¯ã€‚</p></li><li><p>ä»¥HTTPçŠ¶æ€ç å†³å®šå½“å‰æ˜¯å¦å‡ºé”™ï¼Œé200ä¸ºæ“ä½œå¼‚å¸¸ã€‚</p></li></ol><p>3ï¸âƒ£å¦‚ä½•è§„èŒƒå¼‚å¸¸ä¿¡æ¯ï¼Ÿ</p><ul><li><p>ä»£ç ä¸­ç»Ÿä¸€æŠ›å‡ºé¡¹ç›®çš„è‡ªå®šä¹‰å¼‚å¸¸ç±»å‹ï¼Œè¿™æ ·å¯ä»¥ç»Ÿä¸€å»æ•è·è¿™ä¸€ç±»æˆ–å‡ ç±»çš„å¼‚å¸¸ã€‚</p></li><li><p>è§„èŒƒäº†å¼‚å¸¸ç±»å‹å°±å¯ä»¥å»è·å–å¼‚å¸¸ä¿¡æ¯ã€‚</p></li><li><p>å¦‚æœæ•è·äº†éé¡¹ç›®è‡ªå®šä¹‰çš„å¼‚å¸¸ç±»å‹ç»Ÿä¸€å‘ç”¨æˆ·æç¤ºâ€œæ‰§è¡Œè¿‡ç¨‹å¼‚å¸¸ï¼Œè¯·é‡è¯•â€çš„é”™è¯¯ä¿¡æ¯ã€‚</p></li></ul><p>4ï¸âƒ£å¦‚ä½•æ•è·å¼‚å¸¸ï¼Ÿ</p><ul><li>ä»£ç ç»Ÿä¸€ç”¨try/catchæ–¹å¼å»æ•è·ä»£ç æ¯”è¾ƒè‡ƒè‚¿ï¼Œå¯ä»¥é€šè¿‡SpringMVCæä¾›çš„æ§åˆ¶å™¨å¢å¼ºç±»ç»Ÿä¸€ç”±ä¸€ä¸ªç±»å»å®Œæˆå¼‚å¸¸çš„æ•è·ã€‚</li></ul><p>å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://picbed1.taoyaopc.live/xczx/wps9-1684832152956-17.jpg" alt="img"></p><h3 id="5-5-2-ç»Ÿä¸€å¼‚å¸¸å¤„ç†å®ç°"><a href="#5-5-2-ç»Ÿä¸€å¼‚å¸¸å¤„ç†å®ç°" class="headerlink" title="5.5.2 ç»Ÿä¸€å¼‚å¸¸å¤„ç†å®ç°"></a>5.5.2 ç»Ÿä¸€å¼‚å¸¸å¤„ç†å®ç°</h3><p>æ ¹æ®ä¸Šè¾¹åˆ†æçš„æ–¹æ¡ˆï¼Œç»Ÿä¸€åœ¨baseåŸºç¡€å·¥ç¨‹å®ç°ç»Ÿä¸€å¼‚å¸¸å¤„ç†ï¼Œå„æ¨¡å—ä¾èµ–äº†baseåŸºç¡€å·¥ç¨‹éƒ½ å¯ä»¥ä½¿ç”¨ã€‚</p><p>1ï¸âƒ£é¦–å…ˆåœ¨baseåŸºç¡€å·¥ç¨‹æ·»åŠ éœ€è¦ä¾èµ–çš„åŒ…ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-log4j2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2ï¸âƒ£å®šä¹‰ä¸€äº›é€šç”¨çš„å¼‚å¸¸ä¿¡æ¯</p><ul><li>ä»è¯¾ç¨‹èµ„æ–™/å·¥ç¨‹ç›®å½• æ‹·è´CommonError ç±»åˆ°baseå·¥ç¨‹com.xuecheng.base.execptionä¸‹ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.base.Exception;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é€šç”¨å¼‚å¸¸ä¿¡æ¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/21 11:08</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">CommonError</span> &#123;</span><br><span class="line"></span><br><span class="line">UNKOWN_ERROR(<span class="string">&quot;æ‰§è¡Œè¿‡ç¨‹å¼‚å¸¸ï¼Œè¯·é‡è¯•ã€‚&quot;</span>),</span><br><span class="line">PARAMS_ERROR(<span class="string">&quot;éæ³•å‚æ•°&quot;</span>),</span><br><span class="line">OBJECT_NULL(<span class="string">&quot;å¯¹è±¡ä¸ºç©º&quot;</span>),</span><br><span class="line">QUERY_NULL(<span class="string">&quot;æŸ¥è¯¢ç»“æœä¸ºç©º&quot;</span>),</span><br><span class="line">REQUEST_NULL(<span class="string">&quot;è¯·æ±‚å‚æ•°ä¸ºç©º&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> String errMessage;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getErrMessage</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> errMessage;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="title function_">CommonError</span><span class="params">( String errMessage)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.errMessage = errMessage;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3ï¸âƒ£è‡ªå®šä¹‰å¼‚å¸¸ç±»å‹</p><ul><li>åœ¨baseå·¥ç¨‹com.xuecheng.base.execptionä¸‹è‡ªå®šä¹‰å¼‚å¸¸ç±»ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.base.Exception;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æœ¬é¡¹ç›®è‡ªå®šä¹‰å¼‚å¸¸ç±»å‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/23 16:18</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">XueChengPlusException</span> <span class="keyword">extends</span> <span class="title class_">RuntimeException</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String errMessage;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">XueChengPlusException</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">XueChengPlusException</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(message);</span><br><span class="line">        <span class="built_in">this</span>.errMessage = message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getErrMessage</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> errMessage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setErrMessage</span><span class="params">(String errMessage)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.errMessage = errMessage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">cast</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">XueChengPlusException</span>(message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">cast</span><span class="params">(CommonError error)</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">XueChengPlusException</span>(error.getErrMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4ï¸âƒ£å“åº”ç”¨æˆ·çš„ç»Ÿä¸€ç±»å‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.base.Exception;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å’Œå‰ç«¯çº¦å®šè¿”å›çš„å¼‚å¸¸ä¿¡æ¯æ¨¡å‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/21 11:08</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RestErrorResponse</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String errMessage;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RestErrorResponse</span><span class="params">(String errMessage)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.errMessage = errMessage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getErrMessage</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> errMessage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setErrMessage</span><span class="params">(String errMessage)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.errMessage = errMessage;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>5ï¸âƒ£å…¨å±€å¼‚å¸¸å¤„ç†å™¨</p><p>ä» Spring 3.0 - Spring 3.2 ç‰ˆæœ¬ä¹‹é—´ï¼Œå¯¹ Spring æ¶æ„å’Œ SpringMVC çš„Controller çš„å¼‚å¸¸æ•è·æä¾›äº†ç›¸åº”çš„å¼‚å¸¸å¤„ç†ã€‚</p><ul><li><p>@ExceptionHandler</p><ul><li>Spring3.0æä¾›çš„æ ‡è¯†åœ¨æ–¹æ³•ä¸Šæˆ–ç±»ä¸Šçš„æ³¨è§£ï¼Œç”¨æ¥è¡¨æ˜æ–¹æ³•çš„å¤„ç†å¼‚å¸¸ç±»å‹ã€‚</li></ul></li><li><p>@ControllerAdvice</p><ul><li>Spring3.2æä¾›çš„æ–°æ³¨è§£ï¼Œä»åå­—ä¸Šå¯ä»¥çœ‹å‡ºå¤§ä½“æ„æ€æ˜¯æ§åˆ¶å™¨å¢å¼ºï¼Œåœ¨é¡¹ç›®ä¸­æ¥å¢å¼ºSpringMVCä¸­çš„Controllerã€‚</li><li>é€šå¸¸å’Œ@ExceptionHandler ç»“åˆä½¿ç”¨ï¼Œæ¥å¤„ç†SpringMVCçš„å¼‚å¸¸ä¿¡æ¯ã€‚</li></ul></li><li><p>@ResponseStatus</p><ul><li>Spring3.0æä¾›çš„æ ‡è¯†åœ¨æ–¹æ³•ä¸Šæˆ–ç±»ä¸Šçš„æ³¨è§£ï¼Œç”¨çŠ¶æ€ä»£ç å’Œåº”è¿”å›çš„åŸå› æ ‡è®°æ–¹æ³•æˆ–å¼‚å¸¸ç±»ã€‚</li><li>è°ƒç”¨å¤„ç†ç¨‹åºæ–¹æ³•æ—¶ï¼ŒçŠ¶æ€ä»£ç å°†åº”ç”¨äºHTTPå“åº”ã€‚</li></ul></li></ul><p>é€šè¿‡ä¸Šé¢çš„ä¸¤ä¸ªæ³¨è§£ä¾¿å¯å®ç°å¾®æœåŠ¡ç«¯å…¨å±€å¼‚å¸¸å¤„ç†ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.base.Exception;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.HttpStatus;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å…¨å±€å¼‚å¸¸å¤„ç†å™¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/23 16:25</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="comment">// @RestControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalExceptionHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯¹é¡¹ç›®çš„è‡ªå®šä¹‰å¼‚å¸¸è¿›è¡Œå¤„ç†</span></span><br><span class="line">    <span class="meta">@ResponseBody</span> <span class="comment">// ä¿¡æ¯è¿”å›æ ¼å¼ä¸ºjson</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(XueChengPlusException.class)</span> <span class="comment">// æ•è·å¼‚å¸¸ç±»å‹</span></span><br><span class="line">    <span class="meta">@ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)</span> <span class="comment">// çŠ¶æ€ç </span></span><br><span class="line">    <span class="keyword">public</span> RestErrorResponse <span class="title function_">customException</span><span class="params">(XueChengPlusException e)</span> &#123;</span><br><span class="line">        <span class="comment">// è®°å½•å¼‚å¸¸</span></span><br><span class="line">        log.error(<span class="string">&quot;ç³»ç»Ÿå¼‚å¸¸&#123;&#125;&quot;</span>, e.getErrMessage(), e);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è§£æå‡ºå¼‚å¸¸ä¿¡æ¯</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">errMessage</span> <span class="operator">=</span> e.getErrMessage();</span><br><span class="line">        <span class="type">RestErrorResponse</span> <span class="variable">restErrorResponse</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RestErrorResponse</span>(errMessage);</span><br><span class="line">        <span class="keyword">return</span> restErrorResponse;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(Exception.class)</span></span><br><span class="line">    <span class="meta">@ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)</span></span><br><span class="line">    <span class="keyword">public</span> RestErrorResponse <span class="title function_">exception</span><span class="params">(Exception e)</span> &#123;</span><br><span class="line">        <span class="comment">// è®°å½•å¼‚å¸¸</span></span><br><span class="line">        log.error(<span class="string">&quot;ç³»ç»Ÿå¼‚å¸¸&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è§£æå‡ºå¼‚å¸¸ä¿¡æ¯</span></span><br><span class="line">        <span class="type">RestErrorResponse</span> <span class="variable">restErrorResponse</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RestErrorResponse</span>(CommonError.UNKOWN_ERROR.getErrMessage());</span><br><span class="line">        <span class="keyword">return</span> restErrorResponse;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-5-3-å¼‚å¸¸å¤„ç†æµ‹è¯•"><a href="#5-5-3-å¼‚å¸¸å¤„ç†æµ‹è¯•" class="headerlink" title="5.5.3 å¼‚å¸¸å¤„ç†æµ‹è¯•"></a>5.5.3 å¼‚å¸¸å¤„ç†æµ‹è¯•</h3><p>1ï¸âƒ£ä¿®æ”¹ä¸šåŠ¡ä»£ç </p><ul><li>åœ¨å¼‚å¸¸å¤„ç†æµ‹è¯•ä¹‹å‰é¦–å…ˆåœ¨ä»£ç ä¸­æŠ›å‡ºè‡ªå®šä¹‰ç±»å‹çš„å¼‚å¸¸ï¼Œè¿™é‡Œä»¥æ–°å¢è¯¾ç¨‹çš„serviceæ–¹æ³•ä¸ºä¾‹è¿›è¡Œä»£ç ä¿®æ”¹ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> CourseBaseInfoDto <span class="title function_">createCourseBase</span><span class="params">(Long companyId, AddCourseDto dto)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‚æ•°åˆæ³•æ€§æ ¡éªŒ</span></span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isBlank(dto.getName())) &#123;</span><br><span class="line">        <span class="comment">// throw new RuntimeException(&quot;è¯¾ç¨‹åç§°ä¸ºç©º&quot;);</span></span><br><span class="line">        XueChengPlusException.cast(<span class="string">&quot;è¯¾ç¨‹åç§°ä¸ºç©º&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isBlank(dto.getUsers())) &#123;</span><br><span class="line">        <span class="comment">// throw new RuntimeException(&quot;é€‚åº”äººç¾¤ä¸ºç©º&quot;);</span></span><br><span class="line">        XueChengPlusException.cast(<span class="string">&quot;é€‚åº”äººç¾¤ä¸ºç©º&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isBlank(dto.getCharge())) &#123;</span><br><span class="line">        <span class="comment">// throw new RuntimeException(&quot;æ”¶è´¹è§„åˆ™ä¸ºç©º&quot;);</span></span><br><span class="line">        XueChengPlusException.cast(<span class="string">&quot;æ”¶è´¹è§„åˆ™ä¸ºç©º&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ....</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ï¸âƒ£é¦–å…ˆä½¿ç”¨httpclientæµ‹è¯•</p><ul><li><p>è¯·æ±‚æ–°å¢è¯¾ç¨‹æ¥å£ï¼Œæ•…æ„å°†å¿…å¡«é¡¹è¯¾ç¨‹åç§°è®¾ç½®ä¸ºç©ºã€‚</p></li><li><p>æµ‹è¯•ç»“æœä¸é¢„æœŸä¸€è‡´ï¼Œå¯ä»¥æ•è·å¼‚å¸¸å¹¶å“åº”å¼‚å¸¸ä¿¡æ¯ï¼Œ</p></li></ul><p>3ï¸âƒ£å‰åç«¯è°ƒç”¨æµ‹è¯•</p><ul><li>ä»ç„¶æµ‹è¯•æ–°å¢è¯¾ç¨‹æ¥å£ï¼Œå½“è¯¾ç¨‹æ”¶è´¹çš„æ—¶å€™å¿…é¡»å¡«å†™ä»·æ ¼ï¼Œè¿™é‡Œè®¾ç½®è¯¾ç¨‹ä¸ºæ”¶è´¹ï¼Œä»·æ ¼è®¾ç½®ä¸ºç©ºã€‚</li></ul><p><img src="https://picbed1.taoyaopc.live/xczx/wps10-1684832816002-19.jpg" alt="img" style="zoom:50%;" /> </p><ul><li>é€šè¿‡æµ‹è¯•å‘ç°ï¼Œå‰ç«¯æ­£å¸¸æç¤ºä»£ç  ä¸­æŠ›å‡ºçš„å¼‚å¸¸ä¿¡æ¯ã€‚</li></ul><p><img src="https://picbed1.taoyaopc.live/xczx/wps11-1684832816003-20.jpg" alt="img" style="zoom:50%;" /> </p><ul><li>è‡³æ­¤ï¼Œé¡¹ç›®å¼‚å¸¸å¤„ç†çš„æµ‹è¯•å®Œæ¯•ï¼Œæˆ‘ä»¬åœ¨å¼€å‘ä¸­å¯¹äºä¸šåŠ¡åˆ†æ”¯ä¸­é”™è¯¯çš„æƒ…å†µè¦æŠ›å‡ºé¡¹ç›®è‡ªå®šä¹‰çš„å¼‚å¸¸ç±»å‹ã€‚</li></ul><h2 id="5-7-JSR303æ ¡éªŒ"><a href="#5-7-JSR303æ ¡éªŒ" class="headerlink" title="5.7 JSR303æ ¡éªŒ"></a>5.7 JSR303æ ¡éªŒ</h2><h3 id="5-7-1-ç»Ÿä¸€æ ¡éªŒçš„è¦æ±‚"><a href="#5-7-1-ç»Ÿä¸€æ ¡éªŒçš„è¦æ±‚" class="headerlink" title="5.7.1 ç»Ÿä¸€æ ¡éªŒçš„è¦æ±‚"></a>5.7.1 ç»Ÿä¸€æ ¡éªŒçš„è¦æ±‚</h3><p>å‰ç«¯è¯·æ±‚åç«¯æ¥å£ä¼ è¾“å‚æ•°ï¼Œæ˜¯åœ¨controllerä¸­æ ¡éªŒè¿˜æ˜¯åœ¨Serviceä¸­æ ¡éªŒï¼Ÿ</p><ul><li><p>ç­”æ¡ˆæ˜¯éƒ½éœ€è¦æ ¡éªŒï¼Œåªæ˜¯åˆ†å·¥ä¸åŒã€‚</p></li><li><p>Contollerä¸­æ ¡éªŒè¯·æ±‚å‚æ•°çš„åˆæ³•æ€§ï¼Œ</p><ul><li>åŒ…æ‹¬ï¼šå¿…å¡«é¡¹æ ¡éªŒï¼Œæ•°æ®æ ¼å¼æ ¡éªŒï¼Œæ¯”å¦‚ï¼šæ˜¯å¦æ˜¯ç¬¦åˆä¸€å®šçš„æ—¥æœŸæ ¼å¼ï¼Œç­‰ã€‚</li></ul></li><li><p>Serviceä¸­è¦æ ¡éªŒçš„æ˜¯ä¸šåŠ¡è§„åˆ™ç›¸å…³çš„å†…å®¹ï¼Œ</p><ul><li>æ¯”å¦‚ï¼šè¯¾ç¨‹å·²ç»å®¡æ ¸é€šè¿‡æ‰€ä»¥æäº¤å¤±è´¥ã€‚</li></ul></li><li><p>Serviceä¸­æ ¹æ®ä¸šåŠ¡è§„åˆ™å»æ ¡éªŒä¸æ–¹ä¾¿å†™æˆé€šç”¨ä»£ç ï¼ŒControllerä¸­åˆ™å¯ä»¥å°†æ ¡éªŒçš„ä»£ç å†™æˆé€šç”¨ä»£ç ã€‚</p></li></ul><p>æ—©åœ¨JavaEE6è§„èŒƒä¸­å°±å®šä¹‰äº†å‚æ•°æ ¡éªŒçš„è§„èŒƒï¼Œå®ƒå°±æ˜¯JSR-303ï¼Œå®ƒå®šä¹‰äº†Bean Validationï¼Œå³å¯¹beanå±æ€§è¿›è¡Œæ ¡éªŒã€‚</p><ul><li>SpringBootæä¾›äº†JSR-303çš„æ”¯æŒï¼Œå®ƒå°±æ˜¯spring-boot-starter-validationï¼Œ</li><li>å®ƒçš„åº•å±‚ä½¿ç”¨Hibernate Validatorï¼ŒHibernate Validatoræ˜¯Bean Validation çš„å‚è€ƒå®ç°ã€‚</li></ul><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å‡†å¤‡åœ¨Controllerå±‚ä½¿ç”¨spring-boot-starter-validationå®Œæˆå¯¹è¯·æ±‚å‚æ•°çš„åŸºæœ¬åˆæ³•æ€§è¿›è¡Œæ ¡éªŒã€‚</p><h3 id="5-7-2-ç»Ÿä¸€æ ¡éªŒå®ç°"><a href="#5-7-2-ç»Ÿä¸€æ ¡éªŒå®ç°" class="headerlink" title="5.7.2 ç»Ÿä¸€æ ¡éªŒå®ç°"></a>5.7.2 ç»Ÿä¸€æ ¡éªŒå®ç°</h3><p>1ï¸âƒ£é¦–å…ˆåœ¨Baseå·¥ç¨‹æ·»åŠ spring-boot-starter-validationçš„ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-validation<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2ï¸âƒ£åœ¨javax.validation.constraintsåŒ…ä¸‹æœ‰å¾ˆå¤šè¿™æ ·çš„æ ¡éªŒæ³¨è§£ï¼Œç›´æ¥ä½¿ç”¨æ³¨è§£å®šä¹‰æ ¡éªŒè§„åˆ™å³å¯ã€‚</p><div class="table-container"><table><thead><tr><th style="text-align:left">é™åˆ¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left">@Null</td><td>é™åˆ¶åªèƒ½ä¸º null</td></tr><tr><td style="text-align:left">@NotNull</td><td>é™åˆ¶å¿…é¡»ä¸ä¸º null</td></tr><tr><td style="text-align:left">@AssertFalse</td><td>é™åˆ¶å¿…é¡»ä¸º false</td></tr><tr><td style="text-align:left">@AssertTrue</td><td>é™åˆ¶å¿…é¡»ä¸º true</td></tr><tr><td style="text-align:left">@DecimalMax(value)</td><td>é™åˆ¶å¿…é¡»ä¸ºä¸€ä¸ªä¸å¤§äºæŒ‡å®šå€¼çš„æ•°å­—</td></tr><tr><td style="text-align:left">@DecimalMin(value)</td><td>é™åˆ¶å¿…é¡»ä¸ºä¸€ä¸ªä¸å°äºæŒ‡å®šå€¼çš„æ•°å­—</td></tr><tr><td style="text-align:left">@Digits(integer, fraction)</td><td>é™åˆ¶å¿…é¡»ä¸ºä¸€ä¸ªå°æ•°ï¼Œä¸”æ•´æ•°éƒ¨åˆ†çš„ä½æ•°ä¸èƒ½è¶…è¿‡ integerï¼Œå°æ•°éƒ¨åˆ†çš„ä½æ•°ä¸èƒ½è¶…è¿‡ fraction</td></tr><tr><td style="text-align:left">@Future</td><td>é™åˆ¶å¿…é¡»æ˜¯ä¸€ä¸ªå°†æ¥çš„æ—¥æœŸ</td></tr><tr><td style="text-align:left">@Max(value)</td><td>é™åˆ¶å¿…é¡»ä¸ºä¸€ä¸ªä¸å¤§äºæŒ‡å®šå€¼çš„æ•°å­—</td></tr><tr><td style="text-align:left">@Min(value)</td><td>é™åˆ¶å¿…é¡»ä¸ºä¸€ä¸ªä¸å°äºæŒ‡å®šå€¼çš„æ•°å­—</td></tr><tr><td style="text-align:left">@Past</td><td>é™åˆ¶å¿…é¡»æ˜¯ä¸€ä¸ªè¿‡å»çš„æ—¥æœŸ</td></tr><tr><td style="text-align:left">@Pattern(value)</td><td>é™åˆ¶å¿…é¡»ç¬¦åˆæŒ‡å®šçš„æ­£åˆ™è¡¨è¾¾å¼</td></tr><tr><td style="text-align:left">@Size(max, min)</td><td>é™åˆ¶å­—ç¬¦é•¿åº¦å¿…é¡»åœ¨ min åˆ° max ä¹‹é—´</td></tr><tr><td style="text-align:left">@Past</td><td>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼ï¼ˆæ—¥æœŸç±»å‹ï¼‰æ¯”å½“å‰æ—¶é—´æ—©</td></tr><tr><td style="text-align:left">@NotEmpty</td><td>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼éƒ¨ä½ null ä¸”ä¸ä¸ºç©ºï¼ˆå­—ç¬¦ä¸²é•¿åº¦ä¸ä¸º0ã€é›†åˆå¤§å°ä¸ä¸º0ï¼‰</td></tr><tr><td style="text-align:left">@NotBlank</td><td>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼ä¸ä¸ºç©ºï¼ˆä¸ä¸ºnullã€å»é™¤é¦–ä½ç©ºæ ¼åé•¿åº¦ä¸º0ï¼‰ï¼Œä¸åŒäº @NotEmptyï¼Œ@NotBlank åªåº”ç”¨äºå­—ç¬¦ä¸²ä¸”åœ¨æ¯”è¾ƒæ—¶ä¼šå»é™¤å­—ç¬¦ä¸²çš„ç©ºæ ¼</td></tr><tr><td style="text-align:left">@Email</td><td>éªŒè¯æ³¨è§£çš„å…ƒç´ å€¼æ—¶Emailï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼å’Œ flag æŒ‡å®šè‡ªå®šä¹‰çš„emailæ ¼å¼</td></tr></tbody></table></div><p>3ï¸âƒ£ç°åœ¨å‡†å¤‡å¯¹å†…å®¹ç®¡ç†æ¨¡å—æ·»åŠ è¯¾ç¨‹æ¥å£è¿›è¡Œå‚æ•°æ ¡éªŒï¼Œå¦‚ä¸‹æ¥å£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;æ–°å¢è¯¾ç¨‹åŸºç¡€ä¿¡æ¯&quot;)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/course&quot;)</span></span><br><span class="line"><span class="keyword">public</span> CourseBaseInfoDto <span class="title function_">createCourseBase</span><span class="params">(<span class="meta">@RequestBody</span> AddCourseDto addCourseDto)</span>&#123;</span><br><span class="line">    <span class="comment">//æœºæ„idï¼Œç”±äºè®¤è¯ç³»ç»Ÿæ²¡æœ‰ä¸Šçº¿æš‚æ—¶ç¡¬ç¼–ç </span></span><br><span class="line">    <span class="type">Long</span> <span class="variable">companyId</span> <span class="operator">=</span> <span class="number">1232141425L</span>;</span><br><span class="line">  <span class="keyword">return</span> courseBaseInfoService.createCourseBase(companyId,addCourseDto);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ­¤æ¥å£ä½¿ç”¨AddCourseDtoæ¨¡å‹å¯¹è±¡æ¥æ”¶å‚æ•°ï¼Œæ‰€ä»¥è¿›å…¥AddCourseDtoç±»ï¼Œåœ¨å±æ€§ä¸Šæ·»åŠ æ ¡éªŒè§„åˆ™</li><li>ä¸‹è¾¹ç”¨åˆ°äº†@NotEmptyå’Œ@Sizeä¸¤ä¸ªæ³¨è§£ï¼Œ<ul><li>@NotEmptyè¡¨ç¤ºå±æ€§ä¸èƒ½ä¸ºç©ºï¼Œ</li><li>@Sizeè¡¨ç¤ºé™åˆ¶å±æ€§å†…å®¹çš„é•¿çŸ­ã€‚</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.content.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModel;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.NotEmpty;</span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.Size;</span><br><span class="line"><span class="keyword">import</span> java.math.BigDecimal;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@description</span> æ·»åŠ è¯¾ç¨‹dto</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@date</span> 2023/5/21 17:40</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ApiModel(value=&quot;AddCourseDto&quot;, description=&quot;æ–°å¢è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AddCourseDto</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotEmpty(message = &quot;è¯¾ç¨‹åç§°ä¸èƒ½ä¸ºç©º&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è¯¾ç¨‹åç§°&quot;, required = true)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotEmpty(message = &quot;é€‚ç”¨äººç¾¤ä¸èƒ½ä¸ºç©º&quot;)</span></span><br><span class="line">    <span class="meta">@Size(message = &quot;é€‚ç”¨äººç¾¤å†…å®¹è¿‡å°‘&quot;,min = 10)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;é€‚ç”¨äººç¾¤&quot;, required = true)</span></span><br><span class="line">    <span class="keyword">private</span> String users;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è¯¾ç¨‹æ ‡ç­¾&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String tags;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotEmpty(message = &quot;è¯¾ç¨‹åˆ†ç±»ä¸èƒ½ä¸ºç©º&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;å¤§åˆ†ç±»&quot;, required = true)</span></span><br><span class="line">    <span class="keyword">private</span> String mt;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotEmpty(message = &quot;è¯¾ç¨‹åˆ†ç±»ä¸èƒ½ä¸ºç©º&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;å°åˆ†ç±»&quot;, required = true)</span></span><br><span class="line">    <span class="keyword">private</span> String st;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotEmpty(message = &quot;è¯¾ç¨‹ç­‰çº§ä¸èƒ½ä¸ºç©º&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è¯¾ç¨‹ç­‰çº§&quot;, required = true)</span></span><br><span class="line">    <span class="keyword">private</span> String grade;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;æ•™å­¦æ¨¡å¼ï¼ˆæ™®é€šï¼Œå½•æ’­ï¼Œç›´æ’­ç­‰ï¼‰&quot;, required = true)</span></span><br><span class="line">    <span class="keyword">private</span> String teachmode;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è¯¾ç¨‹ä»‹ç»&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String description;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è¯¾ç¨‹å›¾ç‰‡&quot;, required = true)</span></span><br><span class="line">    <span class="keyword">private</span> String pic;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotEmpty(message = &quot;æ”¶è´¹è§„åˆ™ä¸èƒ½ä¸ºç©º&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;æ”¶è´¹è§„åˆ™ï¼Œå¯¹åº”æ•°æ®å­—å…¸&quot;, required = true)</span></span><br><span class="line">    <span class="keyword">private</span> String charge;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;ä»·æ ¼&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> BigDecimal price;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å®šä¹‰å¥½æ ¡éªŒè§„åˆ™è¿˜éœ€è¦å¼€å¯æ ¡éªŒï¼Œåœ¨controlleræ–¹æ³•ä¸­æ·»åŠ @Validatedæ³¨è§£ï¼Œå¦‚ä¸‹ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;æ–°å¢è¯¾ç¨‹åŸºç¡€ä¿¡æ¯&quot;)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/course&quot;)</span></span><br><span class="line"><span class="keyword">public</span> CourseBaseInfoDto <span class="title function_">createCourseBase</span><span class="params">(<span class="meta">@RequestBody</span> <span class="meta">@Validated</span> AddCourseDto addCourseDto)</span>&#123;</span><br><span class="line">    <span class="comment">//æœºæ„idï¼Œç”±äºè®¤è¯ç³»ç»Ÿæ²¡æœ‰ä¸Šçº¿æš‚æ—¶ç¡¬ç¼–ç </span></span><br><span class="line">    <span class="type">Long</span> <span class="variable">companyId</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">  <span class="keyword">return</span> courseBaseInfoService.createCourseBase(companyId,addCourseDto);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4ï¸âƒ£å¦‚æœæ ¡éªŒå‡ºé”™Springä¼šæŠ›å‡ºMethodArgumentNotValidExceptionå¼‚å¸¸ï¼Œ</p><ul><li>æˆ‘ä»¬éœ€è¦åœ¨ç»Ÿä¸€å¼‚å¸¸å¤„ç†å™¨ä¸­æ•è·å¼‚å¸¸ï¼Œè§£æå‡ºå¼‚å¸¸ä¿¡æ¯ã€‚ä»£ç å¦‚ä¸‹ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="meta">@ExceptionHandler(MethodArgumentNotValidException.class)</span></span><br><span class="line"><span class="meta">@ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)</span></span><br><span class="line"><span class="keyword">public</span> RestErrorResponse <span class="title function_">methodArgumentNotValidException</span><span class="params">(MethodArgumentNotValidException e)</span> &#123;</span><br><span class="line">    <span class="type">BindingResult</span> <span class="variable">bindingResult</span> <span class="operator">=</span> e.getBindingResult();</span><br><span class="line">    List&lt;String&gt; msgList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">//å°†é”™è¯¯ä¿¡æ¯æ”¾åœ¨msgList</span></span><br><span class="line">    bindingResult.getFieldErrors().stream().forEach(item-&gt;msgList.add(item.getDefaultMessage()));</span><br><span class="line">    <span class="comment">//æ‹¼æ¥é”™è¯¯ä¿¡æ¯</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> StringUtils.join(msgList, <span class="string">&quot;,&quot;</span>);</span><br><span class="line">    log.error(<span class="string">&quot;ã€ç³»ç»Ÿå¼‚å¸¸ã€‘&#123;&#125;&quot;</span>,msg);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RestErrorResponse</span>(msg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>5ï¸âƒ£é‡å¯å†…å®¹ç®¡ç†æœåŠ¡ã€‚</p><ul><li><p>ä½¿ç”¨httpclientè¿›è¡Œæµ‹è¯•ï¼Œå°†å¿…å¡«é¡¹è®¾ç½®ä¸ºç©ºï¼Œâ€œé€‚ç”¨äººç¾¤â€ å±æ€§çš„å†…å®¹è®¾ç½®1ä¸ªå­—ã€‚</p></li><li><p>æ‰§è¡Œæµ‹è¯•ï¼Œæ¥å£å“åº”ç»“æœå¦‚ä¸‹ï¼š</p></li></ul><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;errMessage&quot;: &quot;è¯¾ç¨‹åç§°ä¸èƒ½ä¸ºç©º,è¯¾ç¨‹åˆ†ç±»ä¸èƒ½ä¸ºç©º,è¯¾ç¨‹åˆ†ç±»ä¸èƒ½ä¸ºç©º,é€‚ç”¨äººç¾¤å†…å®¹è¿‡å°‘&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-7-3-åˆ†ç»„æ ¡éªŒ"><a href="#5-7-3-åˆ†ç»„æ ¡éªŒ" class="headerlink" title="5.7.3 åˆ†ç»„æ ¡éªŒ"></a>5.7.3 åˆ†ç»„æ ¡éªŒ</h3><p>æœ‰æ—¶å€™åœ¨åŒä¸€ä¸ªå±æ€§ä¸Šè®¾ç½®ä¸€ä¸ªæ ¡éªŒè§„åˆ™ä¸èƒ½æ»¡è¶³è¦æ±‚ï¼Œ</p><ul><li>æ¯”å¦‚ï¼šè®¢å•ç¼–å·ç”±ç³»ç»Ÿç”Ÿæˆï¼Œåœ¨æ·»åŠ è®¢å•æ—¶è¦æ±‚è®¢å•ç¼–å·ä¸ºç©ºï¼Œåœ¨æ›´æ–° è®¢å•æ—¶è¦æ±‚è®¢å•ç¼–å†™ä¸èƒ½ä¸ºç©ºã€‚</li><li>æ­¤æ—¶å°±ç”¨åˆ°äº†åˆ†ç»„æ ¡éªŒï¼ŒåŒä¸€ä¸ªå±æ€§å®šä¹‰å¤šä¸ªæ ¡éªŒè§„åˆ™å±äºä¸åŒçš„åˆ†ç»„ï¼Œ<ul><li>æ¯”å¦‚ï¼šæ·»åŠ è®¢å•å®šä¹‰@NULLè§„åˆ™å±äºinsertåˆ†ç»„ï¼Œæ›´æ–°è®¢å•å®šä¹‰@NotEmptyè§„åˆ™å±äºupdateåˆ†ç»„ï¼Œ</li><li>insertå’Œupdateæ˜¯åˆ†ç»„çš„åç§°ï¼Œæ˜¯å¯ä»¥ä¿®æ”¹çš„ã€‚</li></ul></li></ul><p><strong>ä¸‹è¾¹ä¸¾ä¾‹è¯´æ˜</strong></p><ul><li>æˆ‘ä»¬ç”¨classç±»å‹æ¥è¡¨ç¤ºä¸åŒçš„åˆ†ç»„ï¼Œæ‰€ä»¥æˆ‘ä»¬å®šä¹‰ä¸åŒçš„æ¥å£ç±»å‹ï¼ˆç©ºæ¥å£ï¼‰è¡¨ç¤ºä¸åŒçš„åˆ†ç»„ï¼Œ</li></ul><p>1ï¸âƒ£ç”±äºæ ¡éªŒåˆ†ç»„æ˜¯å…¬ç”¨çš„ï¼Œæ‰€ä»¥å®šä¹‰åœ¨ baseå·¥ç¨‹ä¸­ã€‚å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.base.Exception;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> ç”¨äºåˆ†çº§æ ¡éªŒï¼Œå®šä¹‰ä¸€äº›å¸¸ç”¨çš„ç»„</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/23 18:24</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ValidationGroups</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Inster</span>&#123;&#125;;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Update</span>&#123;&#125;;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Delete</span>&#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ï¸âƒ£ä¸‹è¾¹åœ¨å®šä¹‰æ ¡éªŒè§„åˆ™æ—¶æŒ‡å®šåˆ†ç»„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@NotEmpty(groups = &#123;ValidationGroups.Inster.class&#125;,message = &quot;æ·»åŠ è¯¾ç¨‹åç§°ä¸èƒ½ä¸ºç©º&quot;)</span></span><br><span class="line"><span class="meta">@NotEmpty(groups = &#123;ValidationGroups.Update.class&#125;,message = &quot;ä¿®æ”¹è¯¾ç¨‹åç§°ä¸èƒ½ä¸ºç©º&quot;)</span></span><br><span class="line"><span class="comment">// @NotEmpty(message = &quot;è¯¾ç¨‹åç§°ä¸èƒ½ä¸ºç©º&quot;)</span></span><br><span class="line"><span class="meta">@ApiModelProperty(value = &quot;è¯¾ç¨‹åç§°&quot;, required = true)</span></span><br><span class="line"><span class="keyword">private</span> String name;</span><br></pre></td></tr></table></figure><p>3ï¸âƒ£åœ¨Controlleræ–¹æ³•ä¸­å¯åŠ¨æ ¡éªŒè§„åˆ™æŒ‡å®šè¦ä½¿ç”¨çš„åˆ†ç»„åï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;æ–°å¢è¯¾ç¨‹åŸºç¡€ä¿¡æ¯&quot;)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/course&quot;)</span></span><br><span class="line"><span class="keyword">public</span> CourseBaseInfoDto <span class="title function_">createCourseBase</span><span class="params">(<span class="meta">@RequestBody</span> <span class="meta">@Validated(&#123;ValidationGroups.Inster.class&#125;)</span> AddCourseDto addCourseDto)</span>&#123;</span><br><span class="line">    <span class="comment">//æœºæ„idï¼Œç”±äºè®¤è¯ç³»ç»Ÿæ²¡æœ‰ä¸Šçº¿æš‚æ—¶ç¡¬ç¼–ç </span></span><br><span class="line">    <span class="type">Long</span> <span class="variable">companyId</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">  <span class="keyword">return</span> courseBaseInfoService.createCourseBase(companyId,addCourseDto);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4ï¸âƒ£å†æ¬¡æµ‹è¯•ï¼Œç”±äºè¿™é‡ŒæŒ‡å®šäº†Insertåˆ†ç»„ï¼Œæ‰€ä»¥æŠ›å‡º å¼‚å¸¸ä¿¡æ¯ï¼šæ·»åŠ è¯¾ç¨‹åç§°ä¸èƒ½ä¸ºç©ºã€‚</p><ul><li>å¦‚æœä¿®æ”¹åˆ†ç»„ä¸ºValidationGroups.Update.classï¼Œå¼‚å¸¸ä¿¡æ¯ä¸ºï¼šä¿®æ”¹è¯¾ç¨‹åç§°ä¸èƒ½ä¸ºç©ºã€‚</li></ul><h3 id="5-7-4-æ ¡éªŒè§„åˆ™ä¸æ»¡è¶³ï¼Ÿ"><a href="#5-7-4-æ ¡éªŒè§„åˆ™ä¸æ»¡è¶³ï¼Ÿ" class="headerlink" title="5.7.4 æ ¡éªŒè§„åˆ™ä¸æ»¡è¶³ï¼Ÿ"></a>5.7.4 æ ¡éªŒè§„åˆ™ä¸æ»¡è¶³ï¼Ÿ</h3><p>å¦‚æœjavax.validation.constraintsåŒ…ä¸‹çš„æ ¡éªŒè§„åˆ™æ»¡è¶³ä¸äº†éœ€æ±‚æ€ä¹ˆåŠï¼Ÿ</p><ol><li><p>æ‰‹å†™æ ¡éªŒä»£ç  ã€‚</p></li><li><p>è‡ªå®šä¹‰æ ¡éªŒè§„åˆ™æ³¨è§£ã€‚</p></li></ol><p>å¦‚ä½•è‡ªå®šä¹‰æ ¡éªŒè§„åˆ™æ³¨è§£ï¼Œè¯·è‡ªè¡ŒæŸ¥é˜…èµ„æ–™å®ç°ã€‚</p><h1 id="6-ä¿®æ”¹è¯¾ç¨‹"><a href="#6-ä¿®æ”¹è¯¾ç¨‹" class="headerlink" title="6. ä¿®æ”¹è¯¾ç¨‹"></a>6. ä¿®æ”¹è¯¾ç¨‹</h1><h2 id="6-1-éœ€æ±‚åˆ†æ"><a href="#6-1-éœ€æ±‚åˆ†æ" class="headerlink" title="6.1 éœ€æ±‚åˆ†æ"></a>6.1 éœ€æ±‚åˆ†æ</h2><h3 id="6-1-1-ä¸šåŠ¡æµç¨‹"><a href="#6-1-1-ä¸šåŠ¡æµç¨‹" class="headerlink" title="6.1.1 ä¸šåŠ¡æµç¨‹"></a>6.1.1 ä¸šåŠ¡æµç¨‹</h3><ol><li>è¿›å…¥è¯¾ç¨‹åˆ—è¡¨æŸ¥è¯¢</li></ol><p><img src="https://picbed1.taoyaopc.live/xczx/wps1-1684891642053-1.jpg" alt="img"> </p><ol><li>ç‚¹å‡»ç¼–è¾‘ï¼Œå› ä¸ºè¯¾ç¨‹å®¡æ ¸é€šè¿‡æ–¹å¯å‘å¸ƒï¼Œä»»ä½•æ—¶å€™éƒ½ å¯ä»¥ç¼–è¾‘ï¼Œä¸‹å›¾æ˜¯ç¼–è¾‘è¯¾ç¨‹çš„ç•Œé¢ï¼š</li></ol><p><img src="https://picbed1.taoyaopc.live/xczx/wps2-1684891642054-2.jpg" alt="img"> </p><p>è¿›å…¥ç¼–è¾‘ç•Œé¢æ˜¾ç¤ºå‡ºå½“å‰è¯¾ç¨‹çš„ä¿¡æ¯ã€‚</p><ol><li>ä¿®æ”¹æˆåŠŸè‡ªåŠ¨è¿›å…¥è¯¾ç¨‹è®¡åˆ’ç¼–è¾‘é¡µé¢ã€‚</li></ol><h3 id="6-1-2-æ•°æ®æ¨¡å‹"><a href="#6-1-2-æ•°æ®æ¨¡å‹" class="headerlink" title="6.1.2 æ•°æ®æ¨¡å‹"></a>6.1.2 æ•°æ®æ¨¡å‹</h3><p>é€šè¿‡ä¸šåŠ¡æµç¨‹å¯çŸ¥ï¼Œä¸€é—¨è¯¾ç¨‹ä¿¡æ¯æ¶‰åŠï¼šè¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ã€è¯¾ç¨‹è¥é”€ä¿¡æ¯ã€è¯¾ç¨‹è®¡åˆ’ä¿¡æ¯ã€è¯¾ç¨‹å¸ˆèµ„ä¿¡æ¯ã€‚</p><ul><li>è¿™ä¸¤éƒ¨åˆ†ä¿¡æ¯åˆ†åˆ«åœ¨course_baseã€course_marketä¸¤å¼ è¡¨å­˜å‚¨ã€‚</li><li>å½“ç‚¹å‡»ä¿å­˜æŒ‰é’®æ—¶å‘è¿™ä¸¤å¼ è¡¨æ’å…¥æ•°æ®ã€‚</li><li>è¿™ä¸¤å¼ è¡¨æ˜¯ä¸€å¯¹ä¸€å…³è”å…³ç³»ã€‚</li></ul><p><strong>course_base</strong></p><p><img src="https://picbed1.taoyaopc.live/xczx/image-20230523141606991.png" alt="image-20230523141606991"></p><p><strong>course_market</strong></p><p><img src="https://picbed1.taoyaopc.live/xczx/image-20230523141709184.png" alt="image-20230523141709184"></p><p>æ–°å»ºè¯¾ç¨‹çš„åˆå§‹å®¡æ ¸çŠ¶æ€ä¸ºâ€œæœªæäº¤â€ã€åˆå§‹å‘å¸ƒçŠ¶æ€ä¸ºâ€œæœªå‘å¸ƒâ€ã€‚</p><p>ç”Ÿæˆè¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ã€è¯¾ç¨‹è¥é”€ä¿¡æ¯çš„POã€Mapperæ–‡ä»¶ </p><p>1ï¸âƒ£è¿›å…¥è¯¾ç¨‹ç¼–è¾‘ç•Œé¢</p><ul><li>ç•Œé¢ä¸­æ˜¾ç¤ºäº†è¯¾ç¨‹çš„å½“å‰ä¿¡æ¯ï¼Œéœ€è¦æ ¹æ®è¯¾ç¨‹idæŸ¥è¯¢è¯¾ç¨‹åŸºæœ¬å’Œè¯¾ç¨‹è¥é”€ä¿¡æ¯ï¼Œæ˜¾ç¤ºåœ¨è¡¨å•ä¸Šã€‚</li></ul><p>2ï¸âƒ£ç¼–è¾‘ã€æäº¤</p><ul><li>ä¿®æ”¹è¯¾ç¨‹æäº¤çš„æ•°æ®æ¯”æ–°å¢è¯¾ç¨‹å¤šäº†ä¸€é¡¹è¯¾ç¨‹idï¼Œå› ä¸ºä¿®æ”¹è¯¾ç¨‹éœ€è¦é’ˆå¯¹æŸä¸ªè¯¾ç¨‹è¿›è¡Œä¿®æ”¹ã€‚</li></ul><p>3ï¸âƒ£ä¿å­˜æ•°æ®</p><ul><li><p>ç¼–è¾‘å®Œæˆä¿å­˜è¯¾ç¨‹åŸºç¡€ä¿¡æ¯å’Œè¯¾ç¨‹è¥é”€ä¿¡æ¯ã€‚</p></li><li><p>æ›´æ–°è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯è¡¨ä¸­çš„ä¿®æ”¹äººã€ä¿®æ”¹æ—¶é—´ã€‚</p></li></ul><h2 id="6-2-æ¥å£å®šä¹‰"><a href="#6-2-æ¥å£å®šä¹‰" class="headerlink" title="6.2 æ¥å£å®šä¹‰"></a>6.2 æ¥å£å®šä¹‰</h2><h3 id="6-2-1-æŸ¥è¯¢è¯¾ç¨‹ä¿¡æ¯"><a href="#6-2-1-æŸ¥è¯¢è¯¾ç¨‹ä¿¡æ¯" class="headerlink" title="6.2.1 æŸ¥è¯¢è¯¾ç¨‹ä¿¡æ¯"></a>6.2.1 æŸ¥è¯¢è¯¾ç¨‹ä¿¡æ¯</h3><p>å®šä¹‰æ ¹æ®è¯¾ç¨‹idæŸ¥è¯¢è¯¾ç¨‹ä¿¡æ¯æ¥å£ã€‚</p><p>æ¥å£ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Java</span><br><span class="line">GET /content/course/<span class="number">40</span></span><br><span class="line">Content-Type<span class="punctuation">:</span> application/json</span><br><span class="line">#å“åº”ç»“æœ</span><br><span class="line">#<span class="punctuation">&#123;</span></span><br><span class="line">#  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">40</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;companyId&quot;</span><span class="punctuation">:</span> <span class="number">1232141425</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;companyName&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;SpringBootæ ¸å¿ƒ&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;users&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Spring Bootåˆå­¦è€…&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;tags&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Springé¡¹ç›®çš„å¿«é€Ÿæ„å»º&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;mt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1-3&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;mtName&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;st&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1-3-2&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;stName&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;grade&quot;</span><span class="punctuation">:</span> <span class="string">&quot;200003&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;teachmode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;201001&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;è¯¾ç¨‹ç³»ç»Ÿæ€§åœ°æ·±åº¦æ¢è®¨ Spring Boot æ ¸å¿ƒç‰¹æ€§ï¼Œå¼•å¯¼å°ä¼™ä¼´å¯¹ Java è§„èŒƒçš„é‡è§†ï¼Œå¯å‘å¯¹æŠ€æœ¯åŸç†æ€§çš„æ€è€ƒï¼ŒæŒæ¡æ’æŸ¥é—®é¢˜çš„æŠ€èƒ½ï¼Œä»¥åŠå­¦ä¹ é˜…è¯»æºç çš„æ–¹æ³•å’ŒæŠ€å·§ï¼Œå…¨é¢æå‡ç ”å‘èƒ½åŠ›ï¼Œè¿›å†›æ¶æ„å¸ˆé˜Ÿä¼ã€‚&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;pic&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://cdn.educba.com/academy/wp-content/uploads/2018/08/Spring-BOOT-Interview-questions.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;createDate&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2019-09-10 16:05:39&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;changeDate&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2022-09-09 07:27:48&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;createPeople&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;changePeople&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;auditStatus&quot;</span><span class="punctuation">:</span> <span class="string">&quot;202004&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;203001&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;coursePubId&quot;</span><span class="punctuation">:</span> <span class="number">21</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;coursePubDate&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;charge&quot;</span><span class="punctuation">:</span> <span class="string">&quot;201001&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;price&quot;</span><span class="punctuation">:</span> <span class="number">0.01</span></span><br><span class="line">#<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢ç»“æœä¸ºå•æ¡è¯¾ç¨‹ä¿¡æ¯ï¼Œå†…å®¹å’Œæ–°å¢è¯¾ç¨‹è¿”å›ç»“æœä¸€è‡´ï¼Œæ‰€ä»¥é‡‡ç”¨ä¸æ–°å¢è¯¾ç¨‹ä¸€è‡´çš„æ¨¡å‹ç±»ã€‚</p><p>æ¥å£å®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;æ ¹æ®è¯¾ç¨‹idæŸ¥è¯¢è¯¾ç¨‹åŸºç¡€ä¿¡æ¯&quot;)</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/course/&#123;courseId&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> CourseBaseInfoDto <span class="title function_">getCourseBaseById</span><span class="params">(<span class="meta">@PathVariable</span> Long courseId)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-2-2-ä¿®æ”¹è¯¾ç¨‹ä¿¡æ¯"><a href="#6-2-2-ä¿®æ”¹è¯¾ç¨‹ä¿¡æ¯" class="headerlink" title="6.2.2 ä¿®æ”¹è¯¾ç¨‹ä¿¡æ¯"></a>6.2.2 ä¿®æ”¹è¯¾ç¨‹ä¿¡æ¯</h3><p>1ï¸âƒ£æ ¹æ®å‰è¾¹çš„æ•°æ®æ¨¡å‹åˆ†æï¼Œä¿®æ”¹è¯¾ç¨‹æäº¤çš„æ•°æ®æ¯”æ–°å¢å¤šäº†è¯¾ç¨‹idï¼Œæ¥å£ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">Java</span><br><span class="line">### ä¿®æ”¹è¯¾ç¨‹</span><br><span class="line">PUT /content/course</span><br><span class="line">Content-Type<span class="punctuation">:</span> application/json</span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">40</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;companyName&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;SpringBootæ ¸å¿ƒ&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;users&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Spring Bootåˆå­¦è€…&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;tags&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Springé¡¹ç›®çš„å¿«é€Ÿæ„å»º&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;mt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1-3&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;st&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1-3-2&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;grade&quot;</span><span class="punctuation">:</span> <span class="string">&quot;200003&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;teachmode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;201001&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;è¯¾ç¨‹ç³»ç»Ÿæ€§åœ°æ·±åº¦æ¢è®¨ Spring Boot æ ¸å¿ƒç‰¹æ€§ï¼Œå¼•å¯¼å°ä¼™ä¼´å¯¹ Java è§„èŒƒçš„é‡è§†ï¼Œå¯å‘å¯¹æŠ€æœ¯åŸç†æ€§çš„æ€è€ƒï¼ŒæŒæ¡æ’æŸ¥é—®é¢˜çš„æŠ€èƒ½ï¼Œä»¥åŠå­¦ä¹ é˜…è¯»æºç çš„æ–¹æ³•å’ŒæŠ€å·§ï¼Œå…¨é¢æå‡ç ”å‘èƒ½åŠ›ï¼Œè¿›å†›æ¶æ„å¸ˆé˜Ÿä¼ã€‚&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;pic&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://cdn.educba.com/academy/wp-content/uploads/2018/08/Spring-BOOT-Interview-questions.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;charge&quot;</span><span class="punctuation">:</span> <span class="string">&quot;201001&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;price&quot;</span><span class="punctuation">:</span> <span class="number">0.01</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">###ä¿®æ”¹æˆåŠŸå“åº”ç»“æœå¦‚ä¸‹</span><br><span class="line">#<span class="punctuation">&#123;</span></span><br><span class="line">#  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">40</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;companyId&quot;</span><span class="punctuation">:</span> <span class="number">1232141425</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;companyName&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;SpringBootæ ¸å¿ƒ&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;users&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Spring Bootåˆå­¦è€…&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;tags&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Springé¡¹ç›®çš„å¿«é€Ÿæ„å»º&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;mt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1-3&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;mtName&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;st&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1-3-2&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;stName&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;grade&quot;</span><span class="punctuation">:</span> <span class="string">&quot;200003&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;teachmode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;201001&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;è¯¾ç¨‹ç³»ç»Ÿæ€§åœ°æ·±åº¦æ¢è®¨ Spring Boot æ ¸å¿ƒç‰¹æ€§ï¼Œå¼•å¯¼å°ä¼™ä¼´å¯¹ Java è§„èŒƒçš„é‡è§†ï¼Œå¯å‘å¯¹æŠ€æœ¯åŸç†æ€§çš„æ€è€ƒï¼ŒæŒæ¡æ’æŸ¥é—®é¢˜çš„æŠ€èƒ½ï¼Œä»¥åŠå­¦ä¹ é˜…è¯»æºç çš„æ–¹æ³•å’ŒæŠ€å·§ï¼Œå…¨é¢æå‡ç ”å‘èƒ½åŠ›ï¼Œè¿›å†›æ¶æ„å¸ˆé˜Ÿä¼ã€‚&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;pic&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://cdn.educba.com/academy/wp-content/uploads/2018/08/Spring-BOOT-Interview-questions.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;createDate&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2019-09-10 16:05:39&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;changeDate&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2022-09-09 07:27:48&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;createPeople&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;changePeople&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;auditStatus&quot;</span><span class="punctuation">:</span> <span class="string">&quot;202004&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;203001&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;coursePubId&quot;</span><span class="punctuation">:</span> <span class="number">21</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;coursePubDate&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;charge&quot;</span><span class="punctuation">:</span> <span class="string">&quot;201001&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;price&quot;</span><span class="punctuation">:</span> <span class="number">0.01</span></span><br><span class="line">#<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>2ï¸âƒ£è¿™é‡Œå®šä¹‰ä¿®æ”¹è¯¾ç¨‹æäº¤çš„æ•°æ®æ¨¡å‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.content.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.xuecheng.base.Exception.ValidationGroups;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.NotEmpty;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> v1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> TODO</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/24 10:06</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EditCourseDto</span> <span class="keyword">extends</span> <span class="title class_">AddCourseDto</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// @NotEmpty(message = &quot;è¯¾ç¨‹idä¸èƒ½ä¸ºç©º&quot;, groups = &#123;ValidationGroups.Update.class&#125;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è¯¾ç¨‹id&quot;, required = true)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3ï¸âƒ£ä¿®æ”¹åè¿”å›æœ€æ–°è¯¾ç¨‹ä¿¡æ¯ï¼Œé‡‡ç”¨ä¸æ–°å¢è¯¾ç¨‹æ¥å£è¿”å›ç±»å‹ä¸€è‡´çš„æ•°æ®æ¨¡å‹ã€‚</p><ul><li>æ¥å£å®šä¹‰å¦‚ä¸‹ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;ä¿®æ”¹è¯¾ç¨‹åŸºç¡€ä¿¡æ¯&quot;)</span></span><br><span class="line"><span class="meta">@PutMapping(&quot;/course&quot;)</span></span><br><span class="line"><span class="keyword">public</span> CourseBaseInfoDto <span class="title function_">modifyCourseBase</span><span class="params">(<span class="meta">@RequestBody</span> <span class="meta">@Validated</span> EditCourseDto editCourseDto)</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="6-3-æ¥å£å¼€å‘"><a href="#6-3-æ¥å£å¼€å‘" class="headerlink" title="6.3 æ¥å£å¼€å‘"></a>6.3 æ¥å£å¼€å‘</h2><h3 id="6-3-1-æŸ¥è¯¢è¯¾ç¨‹ä¿¡æ¯"><a href="#6-3-1-æŸ¥è¯¢è¯¾ç¨‹ä¿¡æ¯" class="headerlink" title="6.3.1 æŸ¥è¯¢è¯¾ç¨‹ä¿¡æ¯"></a>6.3.1 æŸ¥è¯¢è¯¾ç¨‹ä¿¡æ¯</h3><p>1ï¸âƒ£æŸ¥è¯¢è¯¾ç¨‹ä¿¡æ¯çš„Serviceæ–¹æ³•åœ¨æ–°å¢è¯¾ç¨‹æ¥å£å¼€å‘ä¸­å·²å®ç°ï¼Œæ— éœ€å®ç°ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ ¹æ®è¯¾ç¨‹idæŸ¥è¯¢è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ï¼ŒåŒ…æ‹¬åŸºæœ¬ä¿¡æ¯å’Œè¥é”€ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">public</span> CourseBaseInfoDto <span class="title function_">getCourseBaseInfo</span><span class="params">(<span class="type">long</span> courseId)</span>&#123;</span><br><span class="line">    <span class="comment">//æŸ¥è¯¢è¯¾ç¨‹ä¿¡æ¯</span></span><br><span class="line">    <span class="type">CourseBase</span> <span class="variable">courseBase</span> <span class="operator">=</span> courseBaseMapper.selectById(courseId);</span><br><span class="line">    <span class="keyword">if</span>(courseBase == <span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æŸ¥è¯¢è¥é”€ä¿¡æ¯</span></span><br><span class="line">    <span class="type">CourseMarket</span> <span class="variable">courseMarket</span> <span class="operator">=</span> courseMarketMapper.selectById(courseId);</span><br><span class="line">    <span class="comment">//è¦è¿”å›çš„å¯¹è±¡</span></span><br><span class="line">    <span class="type">CourseBaseInfoDto</span> <span class="variable">courseBaseInfoDto</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CourseBaseInfoDto</span>();</span><br><span class="line">    BeanUtils.copyProperties(courseBase,courseBaseInfoDto);</span><br><span class="line">    <span class="keyword">if</span>(courseMarket != <span class="literal">null</span>)&#123;</span><br><span class="line">        BeanUtils.copyProperties(courseMarket,courseBaseInfoDto);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æŸ¥è¯¢åˆ†ç±»åç§°</span></span><br><span class="line">    <span class="type">CourseCategory</span> <span class="variable">courseCategoryBySt</span> <span class="operator">=</span> courseCategoryMapper.selectById(courseBase.getSt());</span><br><span class="line">    courseBaseInfoDto.setStName(courseCategoryBySt.getName());</span><br><span class="line">    <span class="type">CourseCategory</span> <span class="variable">courseCategoryByMt</span> <span class="operator">=</span> courseCategoryMapper.selectById(courseBase.getMt());</span><br><span class="line">    courseBaseInfoDto.setMtName(courseCategoryByMt.getName());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> courseBaseInfoDto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ï¸âƒ£éœ€è¦å°†æŸ¥è¯¢è¯¾ç¨‹ä¿¡æ¯çš„æ–¹æ³•æåˆ°æ¥å£ä¸Šï¼Œè¿™æ ·åœ¨controllerä¸­é€šè¿‡æ¥å£è°ƒç”¨æ­¤æ–¹æ³•ã€‚</p><p>3ï¸âƒ£å®Œå–„æ¥å£å±‚ä»£ç  ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;æ ¹æ®è¯¾ç¨‹idæŸ¥è¯¢è¯¾ç¨‹åŸºç¡€ä¿¡æ¯&quot;)</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/course/&#123;courseId&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> CourseBaseInfoDto <span class="title function_">getCourseBaseById</span><span class="params">(<span class="meta">@PathVariable</span> Long courseId)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> courseBaseInfoService.getCourseBaseInfo(courseId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4ï¸âƒ£æµ‹è¯•æŸ¥è¯¢è¯¾ç¨‹</p><ul><li>ç”¨httpclientæµ‹è¯•æŸ¥è¯¢è¯¾ç¨‹æ¥å£ï¼š</li></ul><h3 id="6-3-2-ä¿®æ”¹è¯¾ç¨‹ä¿¡æ¯"><a href="#6-3-2-ä¿®æ”¹è¯¾ç¨‹ä¿¡æ¯" class="headerlink" title="6.3.2 ä¿®æ”¹è¯¾ç¨‹ä¿¡æ¯"></a>6.3.2 ä¿®æ”¹è¯¾ç¨‹ä¿¡æ¯</h3><p>1ï¸âƒ£ä¿®æ”¹Serviceä¿®æ”¹è¯¾ç¨‹çš„æ¥å£å®šä¹‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿®æ”¹è¯¾ç¨‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> companyId æœºæ„id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> editCourseDto ä¿®æ”¹è¯¾ç¨‹ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> è¯¾ç¨‹è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">CourseBaseInfoDto <span class="title function_">updateCourseBase</span><span class="params">(Long companyId, EditCourseDto editCourseDto)</span>;</span><br></pre></td></tr></table></figure><p>2ï¸âƒ£ServiceImplä¸­çš„å®ç°æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> CourseBaseInfoDto <span class="title function_">updateCourseBase</span><span class="params">(Long companyId, EditCourseDto dto)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¯¾ç¨‹id</span></span><br><span class="line">    <span class="type">Long</span> <span class="variable">courseId</span> <span class="operator">=</span> dto.getId();</span><br><span class="line">    <span class="type">CourseBase</span> <span class="variable">courseBase</span> <span class="operator">=</span> courseBaseMapper.selectById(courseId);</span><br><span class="line">    <span class="keyword">if</span>(courseBase==<span class="literal">null</span>)&#123;</span><br><span class="line">        XueChengPlusException.cast(<span class="string">&quot;è¯¾ç¨‹ä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ ¡éªŒæœ¬æœºæ„åªèƒ½ä¿®æ”¹æœ¬æœºæ„çš„è¯¾ç¨‹</span></span><br><span class="line">    <span class="keyword">if</span>(!courseBase.getCompanyId().equals(companyId))&#123;</span><br><span class="line">        XueChengPlusException.cast(<span class="string">&quot;æœ¬æœºæ„åªèƒ½ä¿®æ”¹æœ¬æœºæ„çš„è¯¾ç¨‹&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å°è£…åŸºæœ¬ä¿¡æ¯çš„æ•°æ®</span></span><br><span class="line">    BeanUtils.copyProperties(dto,courseBase);</span><br><span class="line">    courseBase.setChangeDate(LocalDateTime.now());</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ›´æ–°è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> courseBaseMapper.updateById(courseBase);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å°è£…è¥é”€ä¿¡æ¯çš„æ•°æ®</span></span><br><span class="line">    <span class="type">CourseMarket</span> <span class="variable">courseMarket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CourseMarket</span>();</span><br><span class="line">    BeanUtils.copyProperties(dto,courseMarket);</span><br><span class="line">    saveCourseMarket(courseMarket);</span><br><span class="line">    <span class="comment">//æŸ¥è¯¢è¯¾ç¨‹ä¿¡æ¯</span></span><br><span class="line">    <span class="type">CourseBaseInfoDto</span> <span class="variable">courseBaseInfo</span> <span class="operator">=</span> <span class="built_in">this</span>.getCourseBaseInfo(courseId);</span><br><span class="line">    <span class="keyword">return</span> courseBaseInfo;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3ï¸âƒ£æœ€åå®Œå–„æ¥å£å±‚ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;ä¿®æ”¹è¯¾ç¨‹åŸºç¡€ä¿¡æ¯&quot;)</span></span><br><span class="line"><span class="meta">@PutMapping(&quot;/course&quot;)</span></span><br><span class="line"><span class="keyword">public</span> CourseBaseInfoDto <span class="title function_">modifyCourseBase</span><span class="params">(<span class="meta">@RequestBody</span> <span class="meta">@Validated</span> EditCourseDto editCourseDto)</span>&#123;</span><br><span class="line">    <span class="comment">//æœºæ„idï¼Œç”±äºè®¤è¯ç³»ç»Ÿæ²¡æœ‰ä¸Šçº¿æš‚æ—¶ç¡¬ç¼–ç </span></span><br><span class="line">    <span class="type">Long</span> <span class="variable">companyId</span> <span class="operator">=</span> <span class="number">1232141425L</span>;</span><br><span class="line">    <span class="keyword">return</span> courseBaseInfoService.updateCourseBase(companyId,editCourseDto);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="6-4-æ¥å£æµ‹è¯•"><a href="#6-4-æ¥å£æµ‹è¯•" class="headerlink" title="6.4 æ¥å£æµ‹è¯•"></a>6.4 æ¥å£æµ‹è¯•</h2><p>1ï¸âƒ£æ¥å£å¼€å‘å®Œæˆè¿›è¡Œæµ‹è¯•ï¼Œä½¿ç”¨httpclientæµ‹è¯•</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">### æ ¹æ®è¯¾ç¨‹idæŸ¥è¯¢è¯¾ç¨‹ä¿¡æ¯</span><br><span class="line">GET <span class="punctuation">&#123;</span><span class="punctuation">&#123;</span>content_host<span class="punctuation">&#125;</span><span class="punctuation">&#125;</span>/content/course/<span class="number">40</span></span><br><span class="line">Content-Type<span class="punctuation">:</span> application/json</span><br><span class="line">#å“åº”ç»“æœ</span><br><span class="line">#<span class="punctuation">&#123;</span></span><br><span class="line">#  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">40</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;companyId&quot;</span><span class="punctuation">:</span> <span class="number">1232141425</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;companyName&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;SpringBootæ ¸å¿ƒ&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;users&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Spring Bootåˆå­¦è€…&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;tags&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Springé¡¹ç›®çš„å¿«é€Ÿæ„å»º&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;mt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1-3&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;mtName&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;st&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1-3-2&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;stName&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;grade&quot;</span><span class="punctuation">:</span> <span class="string">&quot;200003&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;teachmode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;201001&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;è¯¾ç¨‹ç³»ç»Ÿæ€§åœ°æ·±åº¦æ¢è®¨ Spring Boot æ ¸å¿ƒç‰¹æ€§ï¼Œå¼•å¯¼å°ä¼™ä¼´å¯¹ Java è§„èŒƒçš„é‡è§†ï¼Œå¯å‘å¯¹æŠ€æœ¯åŸç†æ€§çš„æ€è€ƒï¼ŒæŒæ¡æ’æŸ¥é—®é¢˜çš„æŠ€èƒ½ï¼Œä»¥åŠå­¦ä¹ é˜…è¯»æºç çš„æ–¹æ³•å’ŒæŠ€å·§ï¼Œå…¨é¢æå‡ç ”å‘èƒ½åŠ›ï¼Œè¿›å†›æ¶æ„å¸ˆé˜Ÿä¼ã€‚&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;pic&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://cdn.educba.com/academy/wp-content/uploads/2018/08/Spring-BOOT-Interview-questions.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;createDate&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2019-09-10 16:05:39&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;changeDate&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2022-09-09 07:27:48&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;createPeople&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;changePeople&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;auditStatus&quot;</span><span class="punctuation">:</span> <span class="string">&quot;202004&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;203001&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;coursePubId&quot;</span><span class="punctuation">:</span> <span class="number">21</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;coursePubDate&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;charge&quot;</span><span class="punctuation">:</span> <span class="string">&quot;201001&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;price&quot;</span><span class="punctuation">:</span> <span class="number">0.01</span></span><br><span class="line">#<span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">### ä¿®æ”¹è¯¾ç¨‹</span><br><span class="line">PUT <span class="punctuation">&#123;</span><span class="punctuation">&#123;</span>content_host<span class="punctuation">&#125;</span><span class="punctuation">&#125;</span>/content/course</span><br><span class="line">Content-Type<span class="punctuation">:</span> application/json</span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">40</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;SpringBootæ ¸å¿ƒ&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;users&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Spring Bootåˆå­¦è€…&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;tags&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Springé¡¹ç›®çš„å¿«é€Ÿæ„å»º&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;mt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1-3&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;st&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1-3-2&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;grade&quot;</span><span class="punctuation">:</span> <span class="string">&quot;200003&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;teachmode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;201001&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;è¯¾ç¨‹ç³»ç»Ÿæ€§åœ°æ·±åº¦æ¢è®¨ Spring Boot æ ¸å¿ƒç‰¹æ€§ï¼Œå¼•å¯¼å°ä¼™ä¼´å¯¹ Java è§„èŒƒçš„é‡è§†ï¼Œå¯å‘å¯¹æŠ€æœ¯åŸç†æ€§çš„æ€è€ƒï¼ŒæŒæ¡æ’æŸ¥é—®é¢˜çš„æŠ€èƒ½ï¼Œä»¥åŠå­¦ä¹ é˜…è¯»æºç çš„æ–¹æ³•å’ŒæŠ€å·§ï¼Œå…¨é¢æå‡ç ”å‘èƒ½åŠ›ï¼Œè¿›å†›æ¶æ„å¸ˆé˜Ÿä¼ã€‚&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;pic&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://cdn.educba.com/academy/wp-content/uploads/2018/08/Spring-BOOT-Interview-questions.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;charge&quot;</span><span class="punctuation">:</span> <span class="string">&quot;201001&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;price&quot;</span><span class="punctuation">:</span> <span class="number">0.01</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">### ä¿®æ”¹æˆåŠŸå“åº”ç»“æœå¦‚ä¸‹</span><br><span class="line">#<span class="punctuation">&#123;</span></span><br><span class="line">#  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">40</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;companyId&quot;</span><span class="punctuation">:</span> <span class="number">1232141425</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;companyName&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;SpringBootæ ¸å¿ƒ&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;users&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Spring Bootåˆå­¦è€…&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;tags&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Springé¡¹ç›®çš„å¿«é€Ÿæ„å»º&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;mt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1-3&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;mtName&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;st&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1-3-2&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;stName&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;grade&quot;</span><span class="punctuation">:</span> <span class="string">&quot;200003&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;teachmode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;201001&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;è¯¾ç¨‹ç³»ç»Ÿæ€§åœ°æ·±åº¦æ¢è®¨ Spring Boot æ ¸å¿ƒç‰¹æ€§ï¼Œå¼•å¯¼å°ä¼™ä¼´å¯¹ Java è§„èŒƒçš„é‡è§†ï¼Œå¯å‘å¯¹æŠ€æœ¯åŸç†æ€§çš„æ€è€ƒï¼ŒæŒæ¡æ’æŸ¥é—®é¢˜çš„æŠ€èƒ½ï¼Œä»¥åŠå­¦ä¹ é˜…è¯»æºç çš„æ–¹æ³•å’ŒæŠ€å·§ï¼Œå…¨é¢æå‡ç ”å‘èƒ½åŠ›ï¼Œè¿›å†›æ¶æ„å¸ˆé˜Ÿä¼ã€‚&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;pic&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://cdn.educba.com/academy/wp-content/uploads/2018/08/Spring-BOOT-Interview-questions.jpg&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;createDate&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2019-09-10 16:05:39&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;changeDate&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2022-09-09 07:27:48&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;createPeople&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;changePeople&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;auditStatus&quot;</span><span class="punctuation">:</span> <span class="string">&quot;202004&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;203001&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;coursePubId&quot;</span><span class="punctuation">:</span> <span class="number">21</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;coursePubDate&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;charge&quot;</span><span class="punctuation">:</span> <span class="string">&quot;201001&quot;</span><span class="punctuation">,</span></span><br><span class="line">#  <span class="attr">&quot;price&quot;</span><span class="punctuation">:</span> <span class="number">0.01</span></span><br><span class="line">#<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>2ï¸âƒ£å‰ç«¯å¼€å‘å®Œæ¯•è¿›è¡Œå‰åç«¯æ¥å£è”è°ƒã€‚</p><h1 id="7-æŸ¥è¯¢è¯¾ç¨‹è®¡åˆ’"><a href="#7-æŸ¥è¯¢è¯¾ç¨‹è®¡åˆ’" class="headerlink" title="7. æŸ¥è¯¢è¯¾ç¨‹è®¡åˆ’"></a>7. æŸ¥è¯¢è¯¾ç¨‹è®¡åˆ’</h1><h2 id="7-1-éœ€æ±‚åˆ†æ"><a href="#7-1-éœ€æ±‚åˆ†æ" class="headerlink" title="7.1 éœ€æ±‚åˆ†æ"></a>7.1 éœ€æ±‚åˆ†æ</h2><h3 id="7-1-1-ä¸šåŠ¡æµç¨‹"><a href="#7-1-1-ä¸šåŠ¡æµç¨‹" class="headerlink" title="7.1.1 ä¸šåŠ¡æµç¨‹"></a>7.1.1 ä¸šåŠ¡æµç¨‹</h3><p>è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯æ·»åŠ æˆ–ä¿®æ”¹æˆåŠŸå°†è‡ªåŠ¨è¿›å…¥è¯¾ç¨‹è®¡åˆ’ç¼–è¾‘å™¨ç•Œé¢ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://picbed1.taoyaopc.live/xczx/wps3-1684897066337-5.jpg" alt="img"> </p><ul><li><p>è¯¾ç¨‹è®¡åˆ’å³è¯¾ç¨‹çš„å¤§çº²ç›®å½•ã€‚</p></li><li><p>è¯¾ç¨‹è®¡åˆ’åˆ†ä¸ºä¸¤çº§ï¼šå¤§ç« èŠ‚å’Œä¸å°ç« èŠ‚ã€‚</p></li></ul><p>æœ¬å°èŠ‚å®Œæˆè¯¾ç¨‹è®¡åˆ’ä¿¡æ¯çš„æŸ¥è¯¢ã€‚</p><h3 id="7-1-2-æ•°æ®æ¨¡å‹"><a href="#7-1-2-æ•°æ®æ¨¡å‹" class="headerlink" title="7.1.2 æ•°æ®æ¨¡å‹"></a>7.1.2 æ•°æ®æ¨¡å‹</h3><p>1ï¸âƒ£ä»è¯¾ç¨‹è®¡åˆ’æŸ¥è¯¢ç•Œé¢ä¸Šå¯ä»¥çœ‹å‡ºæ•´ä½“ä¸Šæ˜¯ ä¸€ä¸ªæ ‘å‹ç»“æ„ï¼Œè¯¾ç¨‹è®¡åˆ’è¡¨teachplanå¦‚ä¸‹ï¼š</p><ul><li><p>æ¯ä¸ªè¯¾ç¨‹è®¡åˆ’éƒ½æœ‰æ‰€å±è¯¾ç¨‹ã€‚</p></li><li><p>æ¯ä¸ªè¯¾ç¨‹çš„è¯¾ç¨‹è®¡åˆ’æœ‰ä¸¤ä¸ªçº§åˆ«ï¼Œ</p><ul><li>ç¬¬ä¸€çº§ä¸ºå¤§ç« èŠ‚ï¼Œgradeä¸º1ã€</li><li>ç¬¬äºŒçº§ä¸ºå°ç« èŠ‚ï¼Œgradeä¸º2ã€3ã€‚</li><li>ç¬¬äºŒçº§çš„parentidä¸ºç¬¬ä¸€çº§çš„idã€‚</li></ul></li><li><p>è¯¾ç¨‹è®¡åˆ’çš„æ˜¾ç¤ºé¡ºåºæ ¹æ®æ’åºå­—æ®µå»æ˜¾ç¤ºã€‚</p></li></ul><p><img src="https://picbed1.taoyaopc.live/xczx/image-20230525154059680.png" alt="image-20230525154059680"></p><p>2ï¸âƒ£æ ¹æ®ä¸šåŠ¡æµç¨‹ä¸­çš„ç•Œé¢åŸå‹ï¼Œè¯¾ç¨‹è®¡åˆ’åˆ—è¡¨å±•ç¤ºæ—¶è¿˜æœ‰è¯¾ç¨‹è®¡åˆ’å…³è”çš„è§†é¢‘ä¿¡æ¯ã€‚</p><ul><li>è¯¾ç¨‹è®¡åˆ’å…³è”çš„è§†é¢‘ä¿¡æ¯åœ¨teachplan_mediaè¡¨ï¼Œç»“æ„å¦‚ä¸‹ï¼š</li></ul><p><img src="https://picbed1.taoyaopc.live/xczx/image-20230525154500968.png" alt="image-20230525154500968"></p><p>3ï¸âƒ£ä¸¤å¼ è¡¨æ˜¯ä¸€å¯¹ä¸€å…³ç³»ï¼Œæ¯ä¸ªè¯¾ç¨‹è®¡åˆ’åªèƒ½åœ¨teachplan_mediaè¡¨ä¸­å­˜åœ¨ä¸€ä¸ªè§†é¢‘ã€‚</p><h2 id="7-2-æ¥å£å®šä¹‰"><a href="#7-2-æ¥å£å®šä¹‰" class="headerlink" title="7.2 æ¥å£å®šä¹‰"></a>7.2 æ¥å£å®šä¹‰</h2><p>1ï¸âƒ£æ¥å£ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line">GET /teachplan/<span class="number">22</span>/tree-nodes</span><br><span class="line"><span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;changeDate&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;courseId&quot;</span> <span class="punctuation">:</span> <span class="number">74</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;cousePubId&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;createDate&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;endTime&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;grade&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;2&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;isPreview&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;0&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;mediaType&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="number">112</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;pname&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;ç¬¬1ç« åŸºç¡€çŸ¥è¯†&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;startTime&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;status&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="number">113</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;teachPlanTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;changeDate&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;courseId&quot;</span> <span class="punctuation">:</span> <span class="number">74</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;cousePubId&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;createDate&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;endTime&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;grade&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;3&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;isPreview&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;mediaType&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;001002&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="number">113</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;pname&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;ç¬¬1èŠ‚é¡¹ç›®æ¦‚è¿°&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;startTime&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;status&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="number">115</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;teachPlanTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;teachplanMedia&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;courseId&quot;</span> <span class="punctuation">:</span> <span class="number">74</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;coursePubId&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;mediaFilename&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;2.avi&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;mediaId&quot;</span> <span class="punctuation">:</span> <span class="number">41</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;teachplanId&quot;</span> <span class="punctuation">:</span> <span class="number">115</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;teachplanMedia&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;changeDate&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;courseId&quot;</span> <span class="punctuation">:</span> <span class="number">74</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;cousePubId&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;createDate&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;endTime&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;grade&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;2&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;isPreview&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;0&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;mediaType&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="number">112</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;pname&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;ç¬¬2ç« å¿«é€Ÿå…¥é—¨&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;startTime&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;status&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="number">242</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;teachPlanTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;changeDate&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;courseId&quot;</span> <span class="punctuation">:</span> <span class="number">74</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;cousePubId&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;createDate&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;endTime&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;grade&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;3&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;isPreview&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;mediaType&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;001002&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="number">242</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;pname&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;ç¬¬1èŠ‚æ­å»ºç¯å¢ƒ&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;startTime&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;status&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="number">244</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;teachPlanTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;teachplanMedia&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;courseId&quot;</span> <span class="punctuation">:</span> <span class="number">74</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;coursePubId&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;mediaFilename&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;3.avi&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;mediaId&quot;</span> <span class="punctuation">:</span> <span class="number">42</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;teachplanId&quot;</span> <span class="punctuation">:</span> <span class="number">244</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;changeDate&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;courseId&quot;</span> <span class="punctuation">:</span> <span class="number">74</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;cousePubId&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;createDate&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;endTime&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;grade&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;3&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;isPreview&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;0&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;mediaType&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;001002&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;orderby&quot;</span> <span class="punctuation">:</span> <span class="number">3</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;parentid&quot;</span> <span class="punctuation">:</span> <span class="number">242</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;pname&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;ç¬¬2èŠ‚é¡¹ç›®æ¦‚è¿°&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;startTime&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;status&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="number">245</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;teachPlanTreeNodes&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;teachplanMedia&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;courseId&quot;</span> <span class="punctuation">:</span> <span class="number">74</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;coursePubId&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;mediaFilename&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;1a.avi&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;mediaId&quot;</span> <span class="punctuation">:</span> <span class="number">39</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;teachplanId&quot;</span> <span class="punctuation">:</span> <span class="number">245</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;id&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;teachplanMedia&quot;</span> <span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure><p>2ï¸âƒ£æŸ¥è¯¢è¯¾ç¨‹è®¡åˆ’çš„è¯·æ±‚å‚æ•°ï¼šè¯¾ç¨‹id</p><ul><li>å“åº”ç»“æœéœ€è¦è‡ªå®šä¹‰æ¨¡å‹ç±»ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.content.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.model.po.Teachplan;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.model.po.TeachplanMedia;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.ToString;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> v1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è¯¾ç¨‹è®¡åˆ’ä¿¡æ¯æ¨¡å‹ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/25 15:51</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TeachplanDto</span> <span class="keyword">extends</span> <span class="title class_">Teachplan</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸åª’èµ„å…³è”çš„ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> TeachplanMedia teachplanMedia;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°ç« èŠ‚list</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;TeachplanDto&gt; teachPlanTreeNodes;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3ï¸âƒ£å®šä¹‰æ¥å£å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.content.api;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.model.dto.TeachplanDto;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiImplicitParam;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PathVariable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> v1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è¯¾ç¨‹è®¡åˆ’ç®¡ç†ç›¸å…³çš„æ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/25 15:55</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Api(value = &quot;è¯¾ç¨‹è®¡åˆ’ç¼–è¾‘æ¥å£&quot;,tags = &quot;è¯¾ç¨‹è®¡åˆ’ç¼–è¾‘æ¥å£&quot;)</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TeachplanController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;æŸ¥è¯¢è¯¾ç¨‹è®¡åˆ’æ ‘å½¢ç»“æ„&quot;)</span></span><br><span class="line">    <span class="meta">@ApiImplicitParam(value = &quot;courseId&quot;,name = &quot;è¯¾ç¨‹Id&quot;,required = true,dataType = &quot;Long&quot;,paramType = &quot;path&quot;)</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/teachplan/&#123;courseId&#125;/tree-nodes&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;TeachplanDto&gt; <span class="title function_">getTreeNodes</span><span class="params">(<span class="meta">@PathVariable</span> Long courseId)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="7-3-æ¥å£å¼€å‘"><a href="#7-3-æ¥å£å¼€å‘" class="headerlink" title="7.3 æ¥å£å¼€å‘"></a>7.3 æ¥å£å¼€å‘</h2><h3 id="7-3-1-DAO-å¼€å‘"><a href="#7-3-1-DAO-å¼€å‘" class="headerlink" title="7.3.1 DAO å¼€å‘"></a>7.3.1 DAO å¼€å‘</h3><p>1ï¸âƒ£Mapperæ¥å£ä½¿ç”¨sqlæŸ¥è¯¢è¯¾ç¨‹è®¡åˆ’ï¼Œç»„æˆä¸€ä¸ªæ ‘å‹ç»“æ„ã€‚</p><ul><li>åœ¨TeachplanMapperè‡ªå®šä¹‰æ–¹æ³•ï¼š</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.content.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.mapper.BaseMapper;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.model.dto.TeachplanDto;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.model.po.Teachplan;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * è¯¾ç¨‹è®¡åˆ’ Mapper æ¥å£</span></span><br><span class="line"><span class="comment"> * &lt;/p&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> itcast</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">TeachplanMapper</span> <span class="keyword">extends</span> <span class="title class_">BaseMapper</span>&lt;Teachplan&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯¾ç¨‹è®¡åˆ’æŸ¥è¯¢</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> courseId è¯¾ç¨‹id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> è¿”å›listé›†åˆ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;TeachplanDto&gt; <span class="title function_">selectTreeNodes</span><span class="params">(Long courseId)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ï¸âƒ£å®šä¹‰mapper.xmlä¸­çš„sqlè¯­å¥ï¼Œåˆ†æå¦‚ä¸‹ï¼š</p><ol><li><p>ä¸€çº§åˆ†ç±»å’ŒäºŒçº§åˆ†ç±»é€šè¿‡teachplanè¡¨çš„è‡ªé“¾æ¥è¿›è¡Œï¼Œ</p><ul><li>å¦‚æœåªæœ‰ä¸€çº§åˆ†ç±»å…¶ä¸‹è¾¹æ²¡æœ‰äºŒçº§åˆ†ç±»ï¼Œæ­¤æ—¶ä¹Ÿéœ€è¦æ˜¾ç¤ºä¸€çº§åˆ†ç±»ï¼Œ</li><li>è¿™é‡Œä½¿ç”¨å·¦è¿æ¥ï¼Œå·¦è¾¹æ˜¯ä¸€çº§åˆ†ç±»ï¼Œå³è¾¹æ˜¯äºŒçº§åˆ†ç±»ã€‚</li></ul></li><li><p>ç”±äºå½“è¿˜æ²¡æœ‰å…³è”è§†é¢‘æ—¶teachplan_mediaå¯¹åº”çš„è®°å½•ä¸ºç©ºï¼Œæ‰€ä»¥éœ€è¦teachplanå’Œteachplan_mediaå·¦é“¾æ¥ã€‚</p></li></ol><p>sqlå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">select one.id            one_id,</span><br><span class="line">       one.pname         one_pname,</span><br><span class="line">       one.parentid      one_parentid,</span><br><span class="line">       one.grade         one_grade,</span><br><span class="line">       one.media_type    one_mediaType,</span><br><span class="line">       one.start_time    one_stratTime,</span><br><span class="line">       one.end_time      one_endTime,</span><br><span class="line">       one.orderby       one_orderby,</span><br><span class="line">       one.course_id     one_courseId,</span><br><span class="line">       one.course_pub_id one_coursePubId,</span><br><span class="line">       two.id            two_id,</span><br><span class="line">       two.pname         two_pname,</span><br><span class="line">       two.parentid      two_parentid,</span><br><span class="line">       two.grade         two_grade,</span><br><span class="line">       two.media_type    two_mediaType,</span><br><span class="line">       two.start_time    two_stratTime,</span><br><span class="line">       two.end_time      two_endTime,</span><br><span class="line">       two.orderby       two_orderby,</span><br><span class="line">       two.course_id     two_courseId,</span><br><span class="line">       two.course_pub_id two_coursePubId,</span><br><span class="line">       tm.media_fileName mediaFilename,</span><br><span class="line">       tm.id             teachplanMeidaId,</span><br><span class="line">       tm.media_id       mediaId</span><br><span class="line"></span><br><span class="line">from teachplan one</span><br><span class="line">         inner join teachplan two on two.parentid = one.id</span><br><span class="line">         left join teachplan_media tm on two.id = tm.teachplan_id</span><br><span class="line">where one.parentid = 0</span><br><span class="line">  and one.course_id = 117</span><br><span class="line">order by one.orderby, two.orderby</span><br></pre></td></tr></table></figure><p>3ï¸âƒ£å®šä¹‰mapper.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;treeNodeResultMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.xuecheng.content.model.dto.TeachplanDto&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ä¸€çº§æ•°æ®æ˜ å°„ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;one_id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;one_pname&quot;</span> <span class="attr">property</span>=<span class="string">&quot;pname&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;one_parentid&quot;</span> <span class="attr">property</span>=<span class="string">&quot;parentid&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;one_grade&quot;</span> <span class="attr">property</span>=<span class="string">&quot;grade&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;one_mediaType&quot;</span> <span class="attr">property</span>=<span class="string">&quot;mediaType&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;one_stratTime&quot;</span> <span class="attr">property</span>=<span class="string">&quot;startTime&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;one_endTime&quot;</span> <span class="attr">property</span>=<span class="string">&quot;endTime&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;one_orderby&quot;</span> <span class="attr">property</span>=<span class="string">&quot;orderby&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;one_courseId&quot;</span> <span class="attr">property</span>=<span class="string">&quot;courseId&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;one_coursePubId&quot;</span> <span class="attr">property</span>=<span class="string">&quot;coursePubId&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æ˜ å°„å­èŠ‚ç‚¹ï¼Œä¸€å¯¹å¤šæ˜ å°„ï¼ŒofType Listä¸­çš„å¯¹è±¡ç±»å‹ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;teachplanDtoNodes&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;com.xuecheng.content.model.dto.TeachplanDto&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- äºŒçº§æ•°æ®æ˜ å°„ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;two_id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;two_pname&quot;</span> <span class="attr">property</span>=<span class="string">&quot;pname&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;two_parentid&quot;</span> <span class="attr">property</span>=<span class="string">&quot;parentid&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;two_grade&quot;</span> <span class="attr">property</span>=<span class="string">&quot;grade&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;two_mediaType&quot;</span> <span class="attr">property</span>=<span class="string">&quot;mediaType&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;two_stratTime&quot;</span> <span class="attr">property</span>=<span class="string">&quot;startTime&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;two_endTime&quot;</span> <span class="attr">property</span>=<span class="string">&quot;endTime&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;two_orderby&quot;</span> <span class="attr">property</span>=<span class="string">&quot;orderby&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;two_courseId&quot;</span> <span class="attr">property</span>=<span class="string">&quot;courseId&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;two_coursePubId&quot;</span> <span class="attr">property</span>=<span class="string">&quot;coursePubId&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--ä¸€å¯¹ä¸€æ˜ å°„--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;teachplanMedia&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;com.xuecheng.content.model.po.TeachplanMedia&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;teachplanMediaId&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;mediaFilename&quot;</span> <span class="attr">property</span>=<span class="string">&quot;mediaFilename&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;mediaId&quot;</span> <span class="attr">property</span>=<span class="string">&quot;mediaId&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectTreeNodes&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;long&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;treeNodeResultMap&quot;</span>&gt;</span></span><br><span class="line">    select one.id            one_id,</span><br><span class="line">    one.pname         one_pname,</span><br><span class="line">    one.parentid      one_parentid,</span><br><span class="line">    one.grade         one_grade,</span><br><span class="line">    one.media_type    one_mediaType,</span><br><span class="line">    one.start_time    one_stratTime,</span><br><span class="line">    one.end_time      one_endTime,</span><br><span class="line">    one.orderby       one_orderby,</span><br><span class="line">    one.course_id     one_courseId,</span><br><span class="line">    one.course_pub_id one_coursePubId,</span><br><span class="line">    two.id            two_id,</span><br><span class="line">    two.pname         two_pname,</span><br><span class="line">    two.parentid      two_parentid,</span><br><span class="line">    two.grade         two_grade,</span><br><span class="line">    two.media_type    two_mediaType,</span><br><span class="line">    two.start_time    two_stratTime,</span><br><span class="line">    two.end_time      two_endTime,</span><br><span class="line">    two.orderby       two_orderby,</span><br><span class="line">    two.course_id     two_courseId,</span><br><span class="line">    two.course_pub_id two_coursePubId,</span><br><span class="line">    tm.media_fileName mediaFilename,</span><br><span class="line">    tm.id             teachplanMeidaId,</span><br><span class="line">    tm.media_id       mediaId</span><br><span class="line"></span><br><span class="line">    from teachplan one</span><br><span class="line">    inner join teachplan two on two.parentid = one.id</span><br><span class="line">    left join teachplan_media tm on two.id = tm.teachplan_id</span><br><span class="line">    where one.parentid = 0</span><br><span class="line">    and one.course_id = #&#123;courseId&#125;</span><br><span class="line">    order by one.orderby, two.orderby</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>4ï¸âƒ£éšåè¿›è¡Œå•å…ƒæµ‹è¯•</p><h3 id="7-3-2-Service-å¼€å‘"><a href="#7-3-2-Service-å¼€å‘" class="headerlink" title="7.3.2 Service å¼€å‘"></a>7.3.2 Service å¼€å‘</h3><p>å®šä¹‰serviceæ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.content.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.model.dto.TeachplanDto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> v1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> è¯¾ç¨‹è®¡åˆ’ç®¡ç†ç›¸å…³çš„æ¥å£</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/25 16:43</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">TeachplanService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢è¯¾ç¨‹è®¡åˆ’</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> courseId è¯¾ç¨‹id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> è¯¾ç¨‹è®¡åˆ’ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;TeachplanDto&gt; <span class="title function_">findTeachplanTree</span><span class="params">(Long courseId)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰serviceæ¥å£å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.content.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.mapper.TeachplanMapper;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.model.dto.TeachplanDto;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.service.TeachplanService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> v1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> TODO</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/25 16:44</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TeachplanServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">TeachplanService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> TeachplanMapper teachplanMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;TeachplanDto&gt; <span class="title function_">findTeachplanTree</span><span class="params">(Long courseId)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> teachplanMapper.selectTreeNodes(courseId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="7-4-æ¥å£æµ‹è¯•"><a href="#7-4-æ¥å£æµ‹è¯•" class="headerlink" title="7.4 æ¥å£æµ‹è¯•"></a>7.4 æ¥å£æµ‹è¯•</h2><ol><li>å®Œå–„æ¥å£å±‚ä»£ç  </li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;æŸ¥è¯¢è¯¾ç¨‹è®¡åˆ’æ ‘å½¢ç»“æ„&quot;)</span></span><br><span class="line"><span class="meta">@ApiImplicitParam(value = &quot;courseId&quot;,name = &quot;è¯¾ç¨‹Id&quot;,required = true,dataType = &quot;Long&quot;,paramType = &quot;path&quot;)</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/teachplan/&#123;courseId&#125;/tree-nodes&quot;)</span></span><br><span class="line"><span class="keyword">public</span> List&lt;TeachplanDto&gt; <span class="title function_">getTreeNodes</span><span class="params">(<span class="meta">@PathVariable</span> Long courseId)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> teachplanService.findTeachplanTree(courseId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>ä½¿ç”¨httpclientæµ‹è¯•</li></ol><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">### æŸ¥è¯¢æŸä¸ªè¯¾ç¨‹çš„è¯¾ç¨‹è®¡åˆ’</span><br><span class="line"></span><br><span class="line">GET &#123;&#123;content_host&#125;&#125;/content/teachplan/117/tree-nodes</span><br></pre></td></tr></table></figure><ol><li>å‰åç«¯è”è°ƒ<ul><li>è¿›å…¥è¯¾ç¨‹ç¼–è¾‘é¡µé¢</li><li>ä¿å­˜è¿›å…¥ä¸‹ä¸€æ­¥</li></ul></li></ol><p>è§‚å¯Ÿè¯¾ç¨‹è®¡åˆ’è·å–æ˜¯å¦æˆåŠŸã€‚</p><ul><li>è¿›å…¥æ–°å¢è¯¾ç¨‹é¡µé¢</li><li>æ–°å¢è¯¾ç¨‹æˆåŠŸï¼Œè‡ªåŠ¨è¿›å…¥è¯¾ç¨‹è®¡åˆ’ç¼–è¾‘ç•Œé¢ã€‚</li></ul><p>ç”±äºæ˜¯æ–°å¢çš„è¯¾ç¨‹ï¼Œè¯¾ç¨‹è®¡åˆ’ä¸ºç©ºã€‚</p><h1 id="8-æ–°å¢-ä¿®æ”¹è®¡åˆ’"><a href="#8-æ–°å¢-ä¿®æ”¹è®¡åˆ’" class="headerlink" title="8. æ–°å¢/ä¿®æ”¹è®¡åˆ’"></a>8. æ–°å¢/ä¿®æ”¹è®¡åˆ’</h1><h2 id="8-1-éœ€æ±‚åˆ†æ"><a href="#8-1-éœ€æ±‚åˆ†æ" class="headerlink" title="8.1 éœ€æ±‚åˆ†æ"></a>8.1 éœ€æ±‚åˆ†æ</h2><h3 id="8-1-1-ä¸šåŠ¡æµç¨‹"><a href="#8-1-1-ä¸šåŠ¡æµç¨‹" class="headerlink" title="8.1.1 ä¸šåŠ¡æµç¨‹"></a>8.1.1 ä¸šåŠ¡æµç¨‹</h3><ol><li>è¿›å…¥è¯¾ç¨‹è®¡åˆ’ç•Œé¢</li></ol><p><img src="https://picbed1.taoyaopc.live/xczx/image-20230529150519028.png" alt="image-20230529150519028"></p><ol><li><p>ç‚¹å‡»â€œæ·»åŠ ç« â€æ–°å¢ç¬¬ä¸€çº§è¯¾ç¨‹è®¡åˆ’ã€‚</p><ul><li>æ–°å¢æˆåŠŸè‡ªåŠ¨åˆ·æ–°è¯¾ç¨‹è®¡åˆ’åˆ—è¡¨ã€‚</li></ul></li><li><p>ç‚¹å‡»â€œæ·»åŠ å°èŠ‚â€å‘æŸä¸ªç¬¬ä¸€çº§è¯¾ç¨‹è®¡åˆ’ä¸‹æ·»åŠ å°èŠ‚ã€‚</p><ul><li><p>æ–°å¢æˆåŠŸè‡ªåŠ¨åˆ·æ–°è¯¾ç¨‹è®¡åˆ’åˆ—è¡¨ã€‚</p></li><li><p>æ–°å¢çš„è¯¾ç¨‹è®¡åˆ’è‡ªåŠ¨æ’åºåˆ°æœ€åã€‚</p></li></ul></li><li><p>ç‚¹å‡»â€œç« â€ã€â€œèŠ‚â€çš„åç§°ï¼Œå¯ä»¥ä¿®æ”¹åç§°ã€é€‰æ‹©æ˜¯å¦å…è´¹ã€‚</p></li></ol><h3 id="8-1-2-æ•°æ®æ¨¡å‹"><a href="#8-1-2-æ•°æ®æ¨¡å‹" class="headerlink" title="8.1.2 æ•°æ®æ¨¡å‹"></a>8.1.2 æ•°æ®æ¨¡å‹</h3><ol><li><p>æ–°å¢ç¬¬ä¸€çº§è¯¾ç¨‹è®¡åˆ’</p><ul><li>åç§°é»˜è®¤ä¸ºï¼šæ–°ç« åç§° [ç‚¹å‡»ä¿®æ”¹]</li><li>gradeï¼š1</li><li>orderby:  æ‰€å±è¯¾ç¨‹ä¸­åŒçº§åˆ«ä¸‹æ’åœ¨æœ€å</li></ul></li><li><p>æ–°å¢ç¬¬äºŒçº§è¯¾ç¨‹è®¡åˆ’</p><ul><li><p>åç§°é»˜è®¤ä¸ºï¼šæ–°å°èŠ‚åç§° [ç‚¹å‡»ä¿®æ”¹]</p></li><li><p>gradeï¼š2</p></li><li><p>orderby:  æ‰€å±è¯¾ç¨‹è®¡åˆ’ä¸­æ’åœ¨æœ€å</p></li></ul></li><li><p>ä¿®æ”¹ç¬¬ä¸€çº§ã€ç¬¬äºŒçº§è¯¾ç¨‹è®¡åˆ’çš„åç§°ï¼Œä¿®æ”¹ç¬¬äºŒçº§è¯¾ç¨‹è®¡åˆ’æ˜¯å¦å…è´¹</p></li></ol><h2 id="8-2-æ¥å£å®šä¹‰"><a href="#8-2-æ¥å£å®šä¹‰" class="headerlink" title="8.2 æ¥å£å®šä¹‰"></a>8.2 æ¥å£å®šä¹‰</h2><p>1ï¸âƒ£æ¥å£ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">### æ–°å¢è¯¾ç¨‹è®¡åˆ’--ç« <span class="punctuation">,</span>å½“gradeä¸º<span class="number">1</span>æ—¶parentidä¸º<span class="number">0</span></span><br><span class="line">POST /teachplan</span><br><span class="line">Content-Type<span class="punctuation">:</span> application/json</span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;courseId&quot;</span> <span class="punctuation">:</span> <span class="number">74</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;parentid&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;grade&quot;</span> <span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;pname&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;æ–°ç« åç§° [ç‚¹å‡»ä¿®æ”¹]&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">### æ–°å¢è¯¾ç¨‹è®¡åˆ’--èŠ‚</span><br><span class="line">POST <span class="punctuation">&#123;</span><span class="punctuation">&#123;</span>content_host<span class="punctuation">&#125;</span><span class="punctuation">&#125;</span>/content/teachplan</span><br><span class="line">Content-Type<span class="punctuation">:</span> application/json</span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;courseId&quot;</span> <span class="punctuation">:</span> <span class="number">74</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;parentid&quot;</span><span class="punctuation">:</span> <span class="number">247</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;grade&quot;</span> <span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;pname&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;å°èŠ‚åç§° [ç‚¹å‡»ä¿®æ”¹]&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>2ï¸âƒ£å…·ä½“åˆ†æ</p><ul><li><p>åŒä¸€ä¸ªæ¥å£æ¥æ”¶æ–°å¢å’Œä¿®æ”¹ä¸¤ä¸ªä¸šåŠ¡è¯·æ±‚ï¼Œä»¥æ˜¯å¦ä¼ é€’è¯¾ç¨‹è®¡åˆ’id æ¥åˆ¤æ–­æ˜¯æ–°å¢è¿˜æ˜¯ä¿®æ”¹ã€‚</p></li><li><p>å¦‚æœä¼ é€’äº†è¯¾ç¨‹è®¡åˆ’idè¯´æ˜å½“å‰æ˜¯è¦ä¿®æ”¹è¯¥è¯¾ç¨‹è®¡åˆ’ï¼Œå¦åˆ™æ˜¯æ–°å¢ä¸€ä¸ªè¯¾ç¨‹è®¡åˆ’ã€‚</p></li></ul><p>3ï¸âƒ£å®šä¹‰æ¥æ”¶è¯·æ±‚å‚æ•°çš„æ•°æ®æ¨¡å‹ç±»ï¼š</p><ul><li>å®šä¹‰SaveTeachplanDto</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.content.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> v1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> æ–°å¢å¤§ç« èŠ‚ã€å°ç« èŠ‚ã€ä¿®æ”¹ç« èŠ‚ä¿¡æ¯</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/29 15:12</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SaveTeachplanDto</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * æ•™å­¦è®¡åˆ’id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯¾ç¨‹è®¡åˆ’åç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String pname;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯¾ç¨‹è®¡åˆ’çˆ¶çº§Id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long parentid;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å±‚çº§ï¼Œåˆ†ä¸º1ã€2ã€3çº§</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer grade;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯¾ç¨‹ç±»å‹:1è§†é¢‘ã€2æ–‡æ¡£</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String mediaType;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯¾ç¨‹æ ‡è¯†</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long courseId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯¾ç¨‹å‘å¸ƒæ ‡è¯†</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long coursePubId;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦æ”¯æŒè¯•å­¦æˆ–é¢„è§ˆï¼ˆè¯•çœ‹ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String isPreview;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4ï¸âƒ£æ¥å£å®šä¹‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;è¯¾ç¨‹è®¡åˆ’åˆ›å»ºæˆ–ä¿®æ”¹&quot;)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/teachplan&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveTeachplan</span><span class="params">(<span class="meta">@RequestBody</span> SaveTeachplanDto teachplan)</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="8-3-æ¥å£å¼€å‘"><a href="#8-3-æ¥å£å¼€å‘" class="headerlink" title="8.3 æ¥å£å¼€å‘"></a>8.3 æ¥å£å¼€å‘</h2><h3 id="8-3-1-Mapper-å¼€å‘"><a href="#8-3-1-Mapper-å¼€å‘" class="headerlink" title="8.3.1 Mapper å¼€å‘"></a>8.3.1 Mapper å¼€å‘</h3><p>æ ¹æ®ä¸šåŠ¡çš„åˆ†æï¼ŒMapperä½¿ç”¨è‡ªåŠ¨ç”Ÿæˆçš„mapperå³å¯æ»¡è¶³è¦æ±‚ã€‚</p><h3 id="8-3-2-Service-å¼€å‘"><a href="#8-3-2-Service-å¼€å‘" class="headerlink" title="8.3.2 Service å¼€å‘"></a>8.3.2 Service å¼€å‘</h3><p>å®šä¹‰ä¿å­˜è¯¾ç¨‹è®¡åˆ’çš„Serviceæ¥å£ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢/ä¿®æ”¹/ä¿å­˜è¯¾ç¨‹è®¡åˆ’</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> saveTeachplanDto ä¿å­˜æ¨¡å‹ç±»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">saveTeachplan</span><span class="params">(SaveTeachplanDto saveTeachplanDto)</span>;</span><br></pre></td></tr></table></figure><p>ç¼–å†™æ¥å£å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveTeachplan</span><span class="params">(SaveTeachplanDto saveTeachplanDto)</span> &#123;</span><br><span class="line">    <span class="comment">// é€šè¿‡æ–°å¢è¯¾ç¨‹è®¡åˆ’idåˆ¤æ–­æ˜¯æ–°å¢è¿˜æ˜¯ä¿®æ”¹</span></span><br><span class="line">    <span class="type">Long</span> <span class="variable">teachplanId</span> <span class="operator">=</span> saveTeachplanDto.getId();</span><br><span class="line">    <span class="keyword">if</span>(teachplanId == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// æ–°å¢</span></span><br><span class="line">        <span class="type">Teachplan</span> <span class="variable">teachplan</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Teachplan</span>();</span><br><span class="line">        BeanUtils.copyProperties(saveTeachplanDto, teachplan);</span><br><span class="line">        <span class="comment">// ç¡®å®šæ’åºå­—æ®µï¼Œæ‰¾åˆ°å®ƒçš„åŒçº§èŠ‚ç‚¹ä¸ªæ•°ï¼Œæ’åºå­—æ®µå°±æ˜¯ä¸ªæ•°åŠ  1</span></span><br><span class="line">        <span class="type">Long</span> <span class="variable">parentid</span> <span class="operator">=</span> saveTeachplanDto.getParentid();</span><br><span class="line">        <span class="type">Long</span> <span class="variable">courseId</span> <span class="operator">=</span> saveTeachplanDto.getCourseId();</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">count</span> <span class="operator">=</span> getTeachplanCount(parentid, courseId);</span><br><span class="line">        teachplan.setOrderby(count+<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        teachplanMapper.insert(teachplan);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// ä¿®æ”¹</span></span><br><span class="line">        <span class="type">Teachplan</span> <span class="variable">teachplan</span> <span class="operator">=</span> teachplanMapper.selectById(teachplanId);</span><br><span class="line">        <span class="comment">// å°†å‚æ•°å¤åˆ¶åˆ° teachplan</span></span><br><span class="line">        BeanUtils.copyProperties(saveTeachplanDto, teachplan);</span><br><span class="line">        teachplanMapper.updateById(teachplan);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> Integer <span class="title function_">getTeachplanCount</span><span class="params">(Long parentid, Long courseId)</span> &#123;</span><br><span class="line">    LambdaQueryWrapper&lt;Teachplan&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line">    queryWrapper.eq(Teachplan::getCourseId, courseId).eq(Teachplan::getParentid, parentid);</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">count</span> <span class="operator">=</span> teachplanMapper.selectCount(queryWrapper);</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="8-4-æ¥å£æµ‹è¯•"><a href="#8-4-æ¥å£æµ‹è¯•" class="headerlink" title="8.4 æ¥å£æµ‹è¯•"></a>8.4 æ¥å£æµ‹è¯•</h2><p>1ï¸âƒ£å®Œå–„æ¥å£çš„ä»£ç  ï¼Œè°ƒç”¨serviceæ–¹æ³•å®Œæˆè¯¾ç¨‹è®¡åˆ’çš„åˆ›å»ºå’Œä¿®æ”¹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;è¯¾ç¨‹è®¡åˆ’åˆ›å»ºæˆ–ä¿®æ”¹&quot;)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/teachplan&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveTeachplan</span><span class="params">(<span class="meta">@RequestBody</span> SaveTeachplanDto teachplan)</span> &#123;</span><br><span class="line"></span><br><span class="line">    teachplanService.saveTeachplan(teachplan);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ï¸âƒ£é¦–å…ˆä½¿ç”¨httpclientåšä»¥ä¸‹æµ‹è¯•ã€‚</p><ul><li>æ·»åŠ ç« </li></ul><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">### æ–°å¢è¯¾ç¨‹è®¡åˆ’--ç« </span><br><span class="line">POST &#123;&#123;content_host&#125;&#125;/content/teachplan</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;courseId&quot; : 74,</span><br><span class="line">  &quot;parentid&quot;: 0,</span><br><span class="line">  &quot;grade&quot; : 1,</span><br><span class="line">  &quot;pname&quot; : &quot;æ–°ç« åç§° [ç‚¹å‡»ä¿®æ”¹]&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ·»åŠ å°èŠ‚</li></ul><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">### æ–°å¢è¯¾ç¨‹è®¡åˆ’--èŠ‚,ä»æ•°æ®åº“æ‰¾åˆ°ç¬¬ä¸€çº§çš„è¯¾ç¨‹è®¡åˆ’idå‘å…¶ä¸‹è¾¹æ·»åŠ è®¡åˆ’</span><br><span class="line">POST &#123;&#123;content_host&#125;&#125;/content/teachplan</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;courseId&quot; : 74,</span><br><span class="line">  &quot;parentid&quot;: 247,</span><br><span class="line">  &quot;grade&quot; : 2,</span><br><span class="line">  &quot;pname&quot; : &quot;å°èŠ‚åç§° [ç‚¹å‡»ä¿®æ”¹]&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä¿å­˜è¯¾ç¨‹è®¡åˆ’</li></ul><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Java</span><br><span class="line">### è¯¾ç¨‹è¯¾ç¨‹è®¡åˆ’,éœ€è¦ä»æ•°æ®åº“æ‰¾åˆ°ä¿®æ”¹çš„è¯¾ç¨‹è®¡åˆ’id</span><br><span class="line">POST &#123;&#123;content_host&#125;&#125;/content/teachplan</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;changeDate&quot; : null,</span><br><span class="line">  &quot;courseId&quot; : 22,</span><br><span class="line">  &quot;cousePubId&quot; : null,</span><br><span class="line">  &quot;createDate&quot; : null,</span><br><span class="line">  &quot;ctlBarShow&quot; : false,</span><br><span class="line">  &quot;ctlEditTitle&quot; : true,</span><br><span class="line">  &quot;endTime&quot; : null,</span><br><span class="line">  &quot;grade&quot; : &quot;2&quot;,</span><br><span class="line">  &quot;isPreview&quot; : &quot;1&quot;,</span><br><span class="line">  &quot;mediaType&quot; : &quot;&quot;,</span><br><span class="line">  &quot;orderby&quot; : 1,</span><br><span class="line">  &quot;parentid&quot; : 237,</span><br><span class="line">  &quot;pname&quot; : &quot;ç¬¬1èŠ‚ä¿®æ”¹åç§°&quot;,</span><br><span class="line">  &quot;startTime&quot; : null,</span><br><span class="line">  &quot;status&quot; : null,</span><br><span class="line">  &quot;teachPlanId&quot; : 240</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3ï¸âƒ£å‰åç«¯è”è°ƒ</p><ul><li>åˆ†åˆ«è”è°ƒæ–°å¢ç« ã€æ–°å¢å°èŠ‚ã€ä¿å­˜è®¡åˆ’ä¿¡æ¯ã€‚</li></ul><h2 id="8-5-bug-ä¿®å¤"><a href="#8-5-bug-ä¿®å¤" class="headerlink" title="8.5 bug ä¿®å¤"></a>8.5 bug ä¿®å¤</h2><p>é€šè¿‡æ¥å£æµ‹è¯•æˆ‘ä»¬å‘ç°ï¼š</p><ol><li><p>ä½¿ç”¨ httpclient æµ‹è¯•æ²¡æœ‰é—®é¢˜</p></li><li><p>å‰åç«¯è”è°ƒæ—¶å‘ç°æ–°å¢çš„ç¬¬ä¸€çº§ç›®å½•ä¸èƒ½æ˜¾ç¤ºåœ¨åˆ—è¡¨ä¸­ã€‚</p></li></ol><p>è¯·è‡ªå·±åˆ†æå¹¶ä¿®å¤ã€‚</p><p>1ï¸âƒ£é€šè¿‡ F12 ç½‘é¡µç«¯è°ƒè¯•å·¥å…·å‘ç°</p><ul><li>æŸ¥è¯¢æ–¹æ³• tree-nodes å“åº”å€¼é‡Œé¢æœªå‡ºç°æ–°å¢ç« èŠ‚åç§°</li><li>ç”±æ­¤çŒœæµ‹å¯èƒ½æ˜¯æŸ¥è¯¢æ–¹æ³•æœ‰bug</li></ul><p><img src="https://picbed1.taoyaopc.live/xczx/image-20230529161700635.png" alt="image-20230529161700635"></p><p>2ï¸âƒ£è§‚å¯Ÿ controller å’Œ ServiceImpl </p><ul><li>å‘ç°æŸ¥è¯¢æ–¹æ³•æ˜¯ç”± mapper å®šä¹‰</li><li>mapper æ˜¯é€šè¿‡ è‡ªå®šä¹‰ sql è¯­å¥ç›´æ¥ä¸æ•°æ®åº“äº¤äº’</li><li>ç”±æ­¤å¯è§ï¼Œé—®é¢˜åœ¨sqlè¯­å¥ä¸­</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;æŸ¥è¯¢è¯¾ç¨‹è®¡åˆ’æ ‘å½¢ç»“æ„&quot;)</span></span><br><span class="line"><span class="meta">@ApiImplicitParam(value = &quot;courseId&quot;,name = &quot;è¯¾ç¨‹Id&quot;, required = true, dataType = &quot;Long&quot;,paramType = &quot;path&quot;)</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/teachplan/&#123;courseId&#125;/tree-nodes&quot;)</span></span><br><span class="line"><span class="keyword">public</span> List&lt;TeachplanDto&gt; <span class="title function_">getTreeNodes</span><span class="params">(<span class="meta">@PathVariable</span> Long courseId)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> teachplanService.findTeachplanTree(courseId);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;TeachplanDto&gt; <span class="title function_">findTeachplanTree</span><span class="params">(Long courseId)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> teachplanMapper.selectTreeNodes(courseId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3ï¸âƒ£æŸ¥è¯¢è¯¾ç¨‹è®¡åˆ’æ ‘å½¢ç»“æ„ sql è¯­å¥ å¦‚ä¸‹ï¼š</p><ul><li>å‘ç°ç”±äºæ–°å¢çš„å¤§ç« èŠ‚åº•ä¸‹æ— å°èŠ‚</li><li>è€Œè¡¨æŸ¥è¯¢é‡‡ç”¨å†…è¿æ¥ï¼Œç”±äºå†…è¿æ¥ï¼ˆinner joinï¼‰å·¦å³ä¸¤è¡¨éœ€éƒ½æœ‰å€¼æ‰æœ‰æ•ˆï¼Œè€Œæ–°å¢ç« èŠ‚æ²¡æœ‰å°èŠ‚</li><li>æŸ¥è¯¢è¿‡ç¨‹ä¸­ç•¥è¿‡äº†æ–°å¢ç« èŠ‚</li><li>å¦‚æ­¤éœ€å°†å†…è¿æ¥æ”¹ä¸ºå·¦å†…è¿æ¥ï¼ˆleft joinï¼‰ï¼Œåªè¦å·¦è¡¨æœ‰å€¼ä¾¿æœ‰æ•ˆ</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">select one.id            one_id,</span><br><span class="line">       one.pname         one_pname,</span><br><span class="line">       one.parentid      one_parentid,</span><br><span class="line">       one.grade         one_grade,</span><br><span class="line">       one.media_type    one_mediaType,</span><br><span class="line">       one.start_time    one_stratTime,</span><br><span class="line">       one.end_time      one_endTime,</span><br><span class="line">       one.orderby       one_orderby,</span><br><span class="line">       one.course_id     one_courseId,</span><br><span class="line">       one.course_pub_id one_coursePubId,</span><br><span class="line">       two.id            two_id,</span><br><span class="line">       two.pname         two_pname,</span><br><span class="line">       two.parentid      two_parentid,</span><br><span class="line">       two.grade         two_grade,</span><br><span class="line">       two.media_type    two_mediaType,</span><br><span class="line">       two.start_time    two_stratTime,</span><br><span class="line">       two.end_time      two_endTime,</span><br><span class="line">       two.orderby       two_orderby,</span><br><span class="line">       two.course_id     two_courseId,</span><br><span class="line">       two.course_pub_id two_coursePubId,</span><br><span class="line">       tm.media_fileName mediaFilename,</span><br><span class="line">       tm.id             teachplanMeidaId,</span><br><span class="line">       tm.media_id       mediaId</span><br><span class="line"></span><br><span class="line">from teachplan one</span><br><span class="line">         left join teachplan two on two.parentid = one.id</span><br><span class="line">         left join teachplan_media tm on two.id = tm.teachplan_id</span><br><span class="line">where one.parentid = 0</span><br><span class="line">  and one.course_id = 117</span><br><span class="line">order by one.orderby, two.orderby</span><br></pre></td></tr></table></figure><h1 id="9-é¡¹ç›®å®æˆ˜"><a href="#9-é¡¹ç›®å®æˆ˜" class="headerlink" title="9. é¡¹ç›®å®æˆ˜"></a>9. é¡¹ç›®å®æˆ˜</h1><h2 id="9-1-åˆ é™¤è¯¾ç¨‹è®¡åˆ’"><a href="#9-1-åˆ é™¤è¯¾ç¨‹è®¡åˆ’" class="headerlink" title="9.1 åˆ é™¤è¯¾ç¨‹è®¡åˆ’"></a>9.1 åˆ é™¤è¯¾ç¨‹è®¡åˆ’</h2><h3 id="9-1-1-éœ€æ±‚åˆ†æ"><a href="#9-1-1-éœ€æ±‚åˆ†æ" class="headerlink" title="9.1.1 éœ€æ±‚åˆ†æ"></a>9.1.1 éœ€æ±‚åˆ†æ</h3><p>è¯¾ç¨‹è®¡åˆ’æ·»åŠ æˆåŠŸï¼Œå¦‚æœè¯¾ç¨‹è¿˜æ²¡æœ‰æäº¤æ—¶å¯ä»¥åˆ é™¤è¯¾ç¨‹è®¡åˆ’ã€‚</p><ul><li>æœªæäº¤ï¼Œaudit_statusä¸º 202002</li></ul><p>åˆ é™¤ç¬¬ä¸€çº§åˆ«çš„å¤§ç« èŠ‚æ—¶è¦æ±‚å¤§ç« èŠ‚ä¸‹è¾¹æ²¡æœ‰å°ç« èŠ‚æ—¶æ–¹å¯åˆ é™¤ã€‚</p><ul><li>éœ€æ ¹æ®å¤§ç« èŠ‚çš„ parentid åŒ¹é… id = parentidï¼Œè‹¥count = 0 åˆ™å¯åˆ é™¤å¤§ç« èŠ‚</li></ul><p>åˆ é™¤ç¬¬äºŒçº§åˆ«çš„å°ç« èŠ‚çš„åŒæ—¶éœ€è¦å°†teachplan_mediaè¡¨å…³è”çš„ä¿¡æ¯ä¹Ÿåˆ é™¤ã€‚</p><ul><li><p>teachplan</p></li><li><p>teachplan_media</p></li><li>teachplan_work</li></ul><h3 id="9-1-2-æ¥å£å®šä¹‰"><a href="#9-1-2-æ¥å£å®šä¹‰" class="headerlink" title="9.1.2 æ¥å£å®šä¹‰"></a>9.1.2 æ¥å£å®šä¹‰</h3><p>åˆ é™¤è¯¾ç¨‹è®¡åˆ’çš„æ¥å£å®šä¹‰ï¼š</p><ul><li>ä¼ å…¥è¯¾ç¨‹è®¡åˆ’idè¿›è¡Œåˆ é™¤æ“ä½œã€‚</li></ul><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Request URL: /content/teachplan/246</span><br><span class="line">Request Method: DELETE</span><br><span class="line"></span><br><span class="line">å¦‚æœå¤±è´¥è¿”å›ï¼š</span><br><span class="line">&#123;&quot;errCode&quot;:&quot;120409&quot;,&quot;errMessage&quot;:&quot;è¯¾ç¨‹è®¡åˆ’ä¿¡æ¯è¿˜æœ‰å­çº§ä¿¡æ¯ï¼Œæ— æ³•æ“ä½œ&quot;&#125;</span><br><span class="line"></span><br><span class="line">å¦‚æœæˆåŠŸï¼šçŠ¶æ€ç 200ï¼Œä¸è¿”å›ä¿¡æ¯</span><br></pre></td></tr></table></figure><p>1ï¸âƒ£æ¥å£å®šä¹‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;åˆ é™¤è¯¾ç¨‹è®¡åˆ’&quot;)</span></span><br><span class="line"><span class="meta">@DeleteMapping(&quot;/teachplan/&#123;teachplanId&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteTeachplan</span><span class="params">(<span class="meta">@PathVariable</span> Long teachplanId)</span> &#123;</span><br><span class="line"></span><br><span class="line">    teachplanService.removeTeachplan(teachplanId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ï¸âƒ£Service å¼€å‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤è¯¾ç¨‹è®¡åˆ’</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> teachplanId è¯¾ç¨‹è®¡åˆ’id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">removeTeachplan</span><span class="params">(Long teachplanId)</span>;</span><br></pre></td></tr></table></figure><p>3ï¸âƒ£Service å®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">removeTeachplan</span><span class="params">(Long teachplanId)</span> &#123;</span><br><span class="line">    <span class="comment">// æ ¹æ®idæŸ¥è¯¢teachplan</span></span><br><span class="line">    <span class="type">Teachplan</span> <span class="variable">teachplan</span> <span class="operator">=</span> teachplanMapper.selectById(teachplanId);</span><br><span class="line">    <span class="comment">// å¦‚æœteachplançš„ å±‚çº§gradeä¸º1ï¼Œåˆ™æŸ¥è¯¢æ˜¯å¦æœ‰å­èŠ‚ç‚¹ï¼Œå¦‚æœä¸º2åˆ™ç›´æ¥åˆ é™¤</span></span><br><span class="line">    <span class="keyword">if</span>(teachplan.getGrade() == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="comment">// åˆ™æŸ¥è¯¢æ˜¯å¦æœ‰å­èŠ‚ç‚¹</span></span><br><span class="line">        LambdaQueryWrapper&lt;Teachplan&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line">        queryWrapper.eq(Teachplan::getParentid, teachplanId);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">count</span> <span class="operator">=</span> teachplanMapper.selectCount(queryWrapper);</span><br><span class="line">        <span class="keyword">if</span>(count &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// æœ‰å­èŠ‚ç‚¹ï¼Œæç¤ºé”™è¯¯ä¿¡æ¯</span></span><br><span class="line">            XueChengPlusException.cast(<span class="string">&quot;è¯¾ç¨‹è®¡åˆ’ä¿¡æ¯è¿˜æœ‰å­çº§ä¿¡æ¯ï¼Œæ— æ³•æ“ä½œ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        deleteTeachplanWithMediaAndWork(teachplanId);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœä¸º2åˆ™ç›´æ¥åˆ é™¤</span></span><br><span class="line">        deleteTeachplanWithMediaAndWork(teachplanId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">deleteTeachplanWithMediaAndWork</span><span class="params">(Long teachplanId)</span> &#123;</span><br><span class="line">    <span class="comment">// è¯¾ç¨‹è®¡åˆ’è¡¨ teachplan</span></span><br><span class="line">    teachplanMapper.deleteById(teachplanId);</span><br><span class="line">    <span class="comment">// è¯¾ç¨‹è®¡åˆ’è§†é¢‘è¡¨ teachplan_media</span></span><br><span class="line">    teachplanMapper.deleteById(teachplanId);</span><br><span class="line">    <span class="comment">// è¯¾ç¨‹è®¡åˆ’ä½œä¸šè¡¨ teachplan_work</span></span><br><span class="line">    teachplanMapper.deleteById(teachplanId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="9-1-3-æ¥å£æµ‹è¯•"><a href="#9-1-3-æ¥å£æµ‹è¯•" class="headerlink" title="9.1.3 æ¥å£æµ‹è¯•"></a>9.1.3 æ¥å£æµ‹è¯•</h3><p>é¦–å…ˆä½¿ç”¨httpclientå·¥å…·è¿›è¡Œæµ‹è¯•</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">### åˆ é™¤è¯¾ç¨‹è®¡åˆ’</span><br><span class="line">DELETE &#123;&#123;content_host&#125;&#125;/content/teachplan/43</span><br></pre></td></tr></table></figure><p>åˆ†ä»¥ä¸‹æƒ…å†µæµ‹è¯•ï¼š</p><ol><li><p>åˆ é™¤å¤§ç« èŠ‚ï¼Œå¤§ç« èŠ‚ä¸‹æœ‰å°ç« èŠ‚æ—¶ä¸å…è®¸åˆ é™¤ã€‚</p></li><li><p>åˆ é™¤å¤§ç« èŠ‚ï¼Œå¤§å•èŠ‚ä¸‹æ²¡æœ‰å°ç« èŠ‚æ—¶å¯ä»¥æ­£å¸¸åˆ é™¤ã€‚</p></li><li><p>åˆ é™¤å°ç« èŠ‚ï¼ŒåŒæ—¶å°†å…³è”çš„ä¿¡æ¯è¿›è¡Œåˆ é™¤ã€‚</p></li></ol><p>å…¶åè¿›è¡Œå‰åç«¯è”è°ƒ</p><h2 id="9-2-è¯¾ç¨‹è®¡åˆ’æ’åº"><a href="#9-2-è¯¾ç¨‹è®¡åˆ’æ’åº" class="headerlink" title="9.2 è¯¾ç¨‹è®¡åˆ’æ’åº"></a>9.2 è¯¾ç¨‹è®¡åˆ’æ’åº</h2><h3 id="9-2-1-éœ€æ±‚åˆ†æ"><a href="#9-2-1-éœ€æ±‚åˆ†æ" class="headerlink" title="9.2.1 éœ€æ±‚åˆ†æ"></a>9.2.1 éœ€æ±‚åˆ†æ</h3><p>è¯¾ç¨‹è®¡åˆ’æ–°å¢åé»˜è®¤æ’åœ¨åŒçº§åˆ«æœ€åï¼Œè¯¾ç¨‹è®¡åˆ’æ’åºåŠŸèƒ½æ˜¯å¯ä»¥çµæ´»è°ƒæ•´è¯¾ç¨‹è®¡åˆ’çš„æ˜¾ç¤ºé¡ºåºï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://picbed1.taoyaopc.live/xczx/wps1-1685428401982-1.jpg" alt="img"> </p><ul><li><p>ä¸Šç§»è¡¨ç¤ºå°†è¯¾ç¨‹è®¡åˆ’å‘ä¸Šç§»åŠ¨ã€‚</p></li><li><p>ä¸‹ç§»è¡¨ç¤ºå°†è¯¾ç¨‹è®¡åˆ’å‘ä¸‹ç§»åŠ¨ã€‚</p></li></ul><p><strong>ä¸šåŠ¡é€»è¾‘</strong>ï¼š</p><ul><li><p>å‘ä¸Šç§»åŠ¨åå’Œä¸Šè¾¹åŒçº§çš„è¯¾ç¨‹è®¡åˆ’äº¤æ¢ä½ç½®ï¼Œå¯ä»¥å°†ä¸¤ä¸ªè¯¾ç¨‹è®¡åˆ’çš„æ’åºå­—æ®µå€¼è¿›è¡Œäº¤æ¢ã€‚</p><ul><li>å…ˆæŸ¥å‡ºçˆ¶èŠ‚ç‚¹idç›¸åŒçš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œå†æŒ‰orderbyæ’åºï¼Œå³å¯çŸ¥é“ä¸Šä¸‹èŠ‚ç‚¹åˆ†åˆ«æ˜¯è°</li></ul></li><li><p>å‘ä¸‹ç§»åŠ¨åå’Œä¸‹è¾¹åŒçº§çš„è¯¾ç¨‹è®¡åˆ’äº¤æ¢ä½ç½®ï¼Œå¯ä»¥å°†ä¸¤ä¸ªè¯¾ç¨‹è®¡åˆ’çš„æ’åºå­—æ®µå€¼è¿›è¡Œäº¤æ¢ã€‚</p><ul><li>å…ˆæŸ¥å‡ºçˆ¶èŠ‚ç‚¹idç›¸åŒçš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œå†æŒ‰orderbyæ’åºï¼Œå³å¯çŸ¥é“ä¸Šä¸‹èŠ‚ç‚¹åˆ†åˆ«æ˜¯è°</li></ul></li></ul><h3 id="9-2-2-æ¥å£å®šä¹‰"><a href="#9-2-2-æ¥å£å®šä¹‰" class="headerlink" title="9.2.2 æ¥å£å®šä¹‰"></a>9.2.2 æ¥å£å®šä¹‰</h3><p>æ¥å£ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><p>å‘ä¸‹ç§»åŠ¨ï¼š</p><ul><li>å‚æ•°1ï¼šmovedown  ä¸º ç§»åŠ¨ç±»å‹ï¼Œè¡¨ç¤ºå‘ä¸‹ç§»åŠ¨</li><li>å‚æ•°2ï¼š43ä¸ºè¯¾ç¨‹è®¡åˆ’id</li></ul><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Request URL: http://localhost:8601/api/content/teachplan/movedown/43</span><br><span class="line">Request Method: POST</span><br></pre></td></tr></table></figure><p>å‘ä¸Šç§»åŠ¨ï¼š</p><ul><li>å‚æ•°1ï¼šmoveup ä¸º ç§»åŠ¨ç±»å‹ï¼Œè¡¨ç¤ºå‘ä¸Šç§»åŠ¨</li><li>å‚æ•°2ï¼š43ä¸ºè¯¾ç¨‹è®¡åˆ’id</li></ul><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Request URL: http://localhost:8601/api/content/teachplan/moveup/43</span><br><span class="line">Request Method: POST</span><br></pre></td></tr></table></figure><p>æ¯æ¬¡ç§»åŠ¨ä¼ é€’ä¸¤ä¸ªå‚æ•°ï¼š</p><ol><li><p>ç§»åŠ¨ç±»å‹: movedownå’Œmoveup</p></li><li><p>è¯¾ç¨‹è®¡åˆ’id</p></li></ol><p>1ï¸âƒ£ Controller æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;è¯¾ç¨‹è®¡åˆ’æ’åº---ä¸‹ç§»&quot;)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/teachplan/movedown/&#123;teachplanId&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">movedown</span><span class="params">(<span class="meta">@PathVariable</span> Long teachplanId)</span> &#123;</span><br><span class="line"></span><br><span class="line">    teachplanService.movedown(teachplanId);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ApiOperation(&quot;è¯¾ç¨‹è®¡åˆ’æ’åº---ä¸Šç§»&quot;)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/teachplan/moveup/&#123;teachplanId&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">moveup</span><span class="params">(<span class="meta">@PathVariable</span> Long teachplanId)</span> &#123;</span><br><span class="line"></span><br><span class="line">    teachplanService.moveup(teachplanId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ï¸âƒ£ Service æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯¾ç¨‹è®¡åˆ’ä¸‹ç§»</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> teachplanId è¯¾ç¨‹è®¡åˆ’id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">movedown</span><span class="params">(Long teachplanId)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯¾ç¨‹è®¡åˆ’ä¸‹ç§»</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> teachplanId è¯¾ç¨‹è®¡åˆ’id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">moveup</span><span class="params">(Long teachplanId)</span>;</span><br></pre></td></tr></table></figure><p>3ï¸âƒ£ ServiceImpl å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">movedown</span><span class="params">(Long teachplanId)</span> &#123;</span><br><span class="line">    <span class="comment">// å…ˆæŸ¥è¯¢æœ¬è¯¾ç¨‹è®¡åˆ’ï¼Œå¾—åˆ°çˆ¶èŠ‚ç‚¹id</span></span><br><span class="line">    <span class="type">Teachplan</span> <span class="variable">teachplan</span> <span class="operator">=</span> teachplanMapper.selectById(teachplanId);</span><br><span class="line">    <span class="type">Long</span> <span class="variable">parentid</span> <span class="operator">=</span> teachplan.getParentid();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŸ¥è¯¢æ‰€æœ‰çˆ¶èŠ‚ç‚¹ä¸€æ ·çš„è¯¾ç¨‹è®¡åˆ’</span></span><br><span class="line">    List&lt;Teachplan&gt; teachplanList = teachplanMapper.selectList(<span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;Teachplan&gt;()</span><br><span class="line">                                                               .eq(Teachplan::getParentid, parentid).eq(Teachplan::getCourseId, teachplan.getCourseId()));</span><br><span class="line">    Collections.sort(teachplanList, ((o1, o2) -&gt; (o1.getOrderby() - o2.getOrderby())));</span><br><span class="line">    moveList(teachplanId, teachplanList);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">moveup</span><span class="params">(Long teachplanId)</span> &#123;</span><br><span class="line">    <span class="comment">// å…ˆæŸ¥è¯¢æœ¬è¯¾ç¨‹è®¡åˆ’ï¼Œå¾—åˆ°çˆ¶èŠ‚ç‚¹id</span></span><br><span class="line">    <span class="type">Teachplan</span> <span class="variable">teachplan</span> <span class="operator">=</span> teachplanMapper.selectById(teachplanId);</span><br><span class="line">    <span class="type">Long</span> <span class="variable">parentid</span> <span class="operator">=</span> teachplan.getParentid();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŸ¥è¯¢æ‰€æœ‰çˆ¶èŠ‚ç‚¹ä¸€æ ·çš„è¯¾ç¨‹è®¡åˆ’</span></span><br><span class="line">    List&lt;Teachplan&gt; teachplanList = teachplanMapper.selectList(<span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;Teachplan&gt;()</span><br><span class="line">                                                               .eq(Teachplan::getParentid, parentid).eq(Teachplan::getCourseId, teachplan.getCourseId()));</span><br><span class="line">    Collections.sort(teachplanList, ((o1, o2) -&gt; (o2.getOrderby() - o1.getOrderby())));</span><br><span class="line">    moveList(teachplanId, teachplanList);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">moveList</span><span class="params">(Long teachplanId, List&lt;Teachplan&gt; teachplanList)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; teachplanList.size(); i++) &#123;</span><br><span class="line">        <span class="type">Teachplan</span> <span class="variable">teachplan1</span> <span class="operator">=</span> teachplanList.get(i);</span><br><span class="line">        <span class="keyword">if</span> (teachplanId.equals(teachplan1.getId()) &amp;&amp; i + <span class="number">1</span> &lt; teachplanList.size()) &#123;</span><br><span class="line">            <span class="comment">// è‹¥è¿˜æœ‰ä¸‹å®¶åˆ™äº¤æ¢</span></span><br><span class="line">            <span class="type">Teachplan</span> <span class="variable">teachplan2</span> <span class="operator">=</span> teachplanList.get(i + <span class="number">1</span>);</span><br><span class="line">            <span class="type">Integer</span> <span class="variable">orderby</span> <span class="operator">=</span> teachplan1.getOrderby();</span><br><span class="line">            teachplan1.setOrderby(teachplan2.getOrderby());</span><br><span class="line">            teachplan2.setOrderby(orderby);</span><br><span class="line">            <span class="comment">// æ›´æ–°æ•°æ®åº“</span></span><br><span class="line">            teachplanMapper.updateById(teachplan1);</span><br><span class="line">            teachplanMapper.updateById(teachplan2);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    XueChengPlusException.cast(<span class="string">&quot;æ— æ³•ç§»åŠ¨ï¼Œè¯·æ£€æŸ¥åé‡è¯•ï¼&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="9-2-3-æ¥å£æµ‹è¯•"><a href="#9-2-3-æ¥å£æµ‹è¯•" class="headerlink" title="9.2.3 æ¥å£æµ‹è¯•"></a>9.2.3 æ¥å£æµ‹è¯•</h3><p>è¯¥åŠŸèƒ½å¯ç›´æ¥è¿›è¡Œå‰åç«¯è”è°ƒï¼Œå¯ä»¥ç«‹å³çœ‹åˆ° æ•ˆæœã€‚</p><p>1ã€å‘ä¸Šç§»åŠ¨æµ‹è¯•</p><p> å…ˆæ‰¾ä¸€ä¸ªä¸Šè¾¹æœ‰è¯¾ç¨‹è®¡åˆ’çš„è¿›è¡Œæµ‹è¯•ï¼Œå‘ä¸Šç§»åŠ¨åä¸¤ä¸ªäº¤æ¢é¡ºåºã€‚</p><p>å†æ‰¾æœ€ä¸Šè¾¹çš„è¯¾ç¨‹è®¡åˆ’å‘ä¸Šç§»åŠ¨ï¼Œæ“ä½œåä½ç½®ä¸å˜å› ä¸ºå·²ç»åœ¨æœ€ä¸Šè¾¹äº†ã€‚</p><p>2ã€å‘ä¸‹ç§»åŠ¨æµ‹è¯•</p><p>å…ˆæ‰¾ä¸€ä¸ªä¸‹è¾¹æœ‰è¯¾ç¨‹è®¡åˆ’çš„è¿›è¡Œæµ‹è¯•ï¼Œå‘ä¸‹ç§»åŠ¨åä¸¤ä¸ªäº¤æ¢é¡ºåºã€‚</p><p>å†æ‰¾æœ€ä¸‹è¾¹çš„è¯¾ç¨‹è®¡åˆ’å‘ä¸‹ç§»åŠ¨ï¼Œæ“ä½œåä½ç½®ä¸å˜å› ä¸ºå·²ç»åœ¨æœ€ä¸‹è¾¹äº†ã€‚</p><h2 id="9-3-å¸ˆèµ„ç®¡ç†"><a href="#9-3-å¸ˆèµ„ç®¡ç†" class="headerlink" title="9.3 å¸ˆèµ„ç®¡ç†"></a>9.3 å¸ˆèµ„ç®¡ç†</h2><h3 id="9-3-1-éœ€æ±‚åˆ†æ"><a href="#9-3-1-éœ€æ±‚åˆ†æ" class="headerlink" title="9.3.1 éœ€æ±‚åˆ†æ"></a>9.3.1 éœ€æ±‚åˆ†æ</h3><p>åœ¨è¯¾ç¨‹è®¡åˆ’ç»´æŠ¤ç•Œé¢ç‚¹å‡»ä¸‹ä¸€æ­¥è¿›å…¥å¸ˆèµ„ç®¡ç†ç•Œé¢ï¼š</p><p><img src="https://picbed1.taoyaopc.live/xczx/wps2-1685431847017-3.jpg" alt="img"> </p><p>ç‚¹å‡»æ·»åŠ æ•™å¸ˆæ‰“å¼€æ·»åŠ ç•Œé¢ï¼Œå¦‚ä¸‹å›¾ï¼Œä¸ç”¨å®ç°ä¸Šä¼ ç…§ç‰‡ã€‚</p><p><img src="https://picbed1.taoyaopc.live/xczx/wps3-1685431847021-4.jpg" alt="img"> </p><p>æ·»åŠ æˆåŠŸæŸ¥è¯¢æ•™å¸ˆä¿¡æ¯å¦‚ä¸‹ï¼š</p><p><img src="https://picbed1.taoyaopc.live/xczx/wps4-1685431847021-5.jpg" alt="img"> </p><p>åœ¨è¿™ä¸ªç•Œé¢å¯ä»¥åˆ é™¤è€å¸ˆï¼Œä¹Ÿå¯ä»¥ç‚¹å‡»ç¼–è¾‘ï¼Œä¿®æ”¹æ•™å¸ˆä¿¡æ¯ï¼š</p><p><img src="https://picbed1.taoyaopc.live/xczx/wps5-1685431847021-6.jpg" alt="img"> </p><p>æ³¨æ„ï¼š</p><p>åªå…è®¸å‘æœºæ„è‡ªå·±çš„è¯¾ç¨‹ä¸­æ·»åŠ è€å¸ˆã€åˆ é™¤è€å¸ˆã€‚</p><p>æœºæ„idç»Ÿä¸€ä½¿ç”¨ï¼š1232141425L</p><h3 id="9-3-2-å¸ˆèµ„æŸ¥è¯¢"><a href="#9-3-2-å¸ˆèµ„æŸ¥è¯¢" class="headerlink" title="9.3.2 å¸ˆèµ„æŸ¥è¯¢"></a>9.3.2 å¸ˆèµ„æŸ¥è¯¢</h3><p>æŸ¥è¯¢æ•™å¸ˆæ¥å£è¯·æ±‚ç¤ºä¾‹</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">get /courseTeacher/list/<span class="number">75</span></span><br><span class="line"><span class="number">75</span>ä¸ºè¯¾ç¨‹idï¼Œè¯·æ±‚å‚æ•°ä¸ºè¯¾ç¨‹id</span><br><span class="line"></span><br><span class="line">å“åº”ç»“æœ</span><br><span class="line"><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span><span class="number">23</span><span class="punctuation">,</span><span class="attr">&quot;courseId&quot;</span><span class="punctuation">:</span><span class="number">75</span><span class="punctuation">,</span><span class="attr">&quot;teacherName&quot;</span><span class="punctuation">:</span><span class="string">&quot;å¼ è€å¸ˆ&quot;</span><span class="punctuation">,</span><span class="attr">&quot;position&quot;</span><span class="punctuation">:</span><span class="string">&quot;è®²å¸ˆ&quot;</span><span class="punctuation">,</span><span class="attr">&quot;introduction&quot;</span><span class="punctuation">:</span><span class="string">&quot;å¼ è€å¸ˆæ•™å¸ˆç®€ä»‹å¼ è€å¸ˆæ•™å¸ˆç®€ä»‹å¼ è€å¸ˆæ•™å¸ˆç®€ä»‹å¼ è€å¸ˆæ•™å¸ˆç®€ä»‹&quot;</span><span class="punctuation">,</span><span class="attr">&quot;photograph&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span><span class="attr">&quot;createDate&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">null</span></span><span class="punctuation">&#125;</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure><p>1ï¸âƒ£æ¥å£å®šä¹‰ï¼šController</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.content.api;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.model.po.CourseTeacher;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.service.CourseTeacherService;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> org.springframework.validation.annotation.Validated;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> v1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å¸ˆèµ„ä¿¡æ¯ç®¡ç†</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/30 15:34</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Api(value = &quot;å¸ˆèµ„ä¿¡æ¯ç®¡ç†æ¥å£&quot;, tags = &quot;å¸ˆèµ„ä¿¡æ¯ç®¡ç†æ¥å£&quot;)</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CourseTeacherController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> CourseTeacherService courseTeacherService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;è¯¾ç¨‹å¸ˆèµ„ä¿¡æ¯æŸ¥è¯¢&quot;)</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/courseTeacher/list/&#123;courseId&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;CourseTeacher&gt; <span class="title function_">list</span><span class="params">(<span class="meta">@PathVariable</span> Long courseId)</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> courseTeacherService.queryCourseTeacherList(courseId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ï¸âƒ£ Service æ¥å£å®šä¹‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.content.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.model.po.CourseTeacher;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> v1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å¸ˆèµ„ä¿¡æ¯ç®¡ç†</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/30 15:36</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">CourseTeacherService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢è¯¾ç¨‹æ‰€æœ‰å¸ˆèµ„ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> courseId è¯¾ç¨‹id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å¸ˆèµ„ä¿¡æ¯ list</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;CourseTeacher&gt; <span class="title function_">queryCourseTeacherList</span><span class="params">(Long courseId)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3ï¸âƒ£ ServiceImpl å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xuecheng.content.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.base.Exception.XueChengPlusException;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.mapper.CourseTeacherMapper;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.model.po.CourseTeacher;</span><br><span class="line"><span class="keyword">import</span> com.xuecheng.content.service.CourseTeacherService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> TaoYaopc</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> v1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> å¸ˆèµ„ä¿¡æ¯ç®¡ç†</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2023/5/30 15:36</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CourseTeacherServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">CourseTeacherService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> CourseTeacherMapper courseTeacherMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;CourseTeacher&gt; <span class="title function_">queryCourseTeacherList</span><span class="params">(Long courseId)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> courseTeacherMapper.selectList(</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;CourseTeacher&gt;().eq(CourseTeacher::getCourseId, courseId));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="9-3-3-æ·»åŠ æ•™å¸ˆ"><a href="#9-3-3-æ·»åŠ æ•™å¸ˆ" class="headerlink" title="9.3.3 æ·»åŠ æ•™å¸ˆ"></a>9.3.3 æ·»åŠ æ•™å¸ˆ</h3><p>æ·»åŠ æ•™å¸ˆè¯·æ±‚ç¤ºä¾‹</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">post  /courseTeacher</span><br><span class="line"></span><br><span class="line">è¯·æ±‚å‚æ•°ï¼š</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;courseId&quot;</span><span class="punctuation">:</span> <span class="number">75</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;teacherName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ç‹è€å¸ˆ&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;position&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æ•™å¸ˆèŒä½&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;introduction&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æ•™å¸ˆç®€ä»‹&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">å“åº”ç»“æœï¼š</span><br><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span><span class="number">24</span><span class="punctuation">,</span><span class="attr">&quot;courseId&quot;</span><span class="punctuation">:</span><span class="number">75</span><span class="punctuation">,</span><span class="attr">&quot;teacherName&quot;</span><span class="punctuation">:</span><span class="string">&quot;ç‹è€å¸ˆ&quot;</span><span class="punctuation">,</span><span class="attr">&quot;position&quot;</span><span class="punctuation">:</span><span class="string">&quot;æ•™å¸ˆèŒä½&quot;</span><span class="punctuation">,</span><span class="attr">&quot;introduction&quot;</span><span class="punctuation">:</span><span class="string">&quot;æ•™å¸ˆç®€ä»‹&quot;</span><span class="punctuation">,</span><span class="attr">&quot;photograph&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span><span class="attr">&quot;createDate&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">null</span></span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>1ï¸âƒ£æ¥å£å®šä¹‰ï¼šController</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;æ·»åŠ /ä¿®æ”¹æ•™å¸ˆä¿¡æ¯&quot;)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/courseTeacher&quot;)</span></span><br><span class="line"><span class="keyword">public</span> CourseTeacher <span class="title function_">modifyCourseTeacher</span><span class="params">(<span class="meta">@RequestBody</span> <span class="meta">@Validated</span> CourseTeacher courseTeacher)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> courseTeacherService.updateCourseTeacher(courseTeacher);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ï¸âƒ£ Service æ¥å£å®šä¹‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿®æ”¹/æ·»åŠ è€å¸ˆ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> courseTeacher è€å¸ˆä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> è€å¸ˆä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">CourseTeacher <span class="title function_">updateCourseTeacher</span><span class="params">(CourseTeacher courseTeacher)</span>;</span><br></pre></td></tr></table></figure><p>3ï¸âƒ£ ServiceImpl å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> CourseTeacher <span class="title function_">updateCourseTeacher</span><span class="params">(CourseTeacher courseTeacher)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (courseTeacher.getId() == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// æ·»åŠ æ“ä½œ</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">insert</span> <span class="operator">=</span> courseTeacherMapper.insert(courseTeacher);</span><br><span class="line">        <span class="keyword">if</span> (insert &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            XueChengPlusException.cast(<span class="string">&quot;æ·»åŠ æ•™å¸ˆå¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// ä¿®æ”¹æ“ä½œ</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> courseTeacherMapper.updateById(courseTeacher);</span><br><span class="line">        <span class="keyword">if</span> (i &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            XueChengPlusException.cast(<span class="string">&quot;ä¿®æ”¹æ•™å¸ˆå¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> courseTeacherMapper.selectOne(<span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;CourseTeacher&gt;().eq(CourseTeacher::getTeacherName, courseTeacher.getTeacherName()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="9-3-4-ä¿®æ”¹æ•™å¸ˆ"><a href="#9-3-4-ä¿®æ”¹æ•™å¸ˆ" class="headerlink" title="9.3.4 ä¿®æ”¹æ•™å¸ˆ"></a>9.3.4 ä¿®æ”¹æ•™å¸ˆ</h3><p>ä¿®æ”¹æ•™å¸ˆè¯·æ±‚ç¤ºä¾‹</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">put /courseTeacher</span><br><span class="line">è¯·æ±‚å‚æ•°ï¼š</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">24</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;courseId&quot;</span><span class="punctuation">:</span> <span class="number">75</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;teacherName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ç‹è€å¸ˆ&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;position&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æ•™å¸ˆèŒä½&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;introduction&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æ•™å¸ˆç®€ä»‹&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;photograph&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;createDate&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">å“åº”ï¼š</span><br><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span><span class="number">24</span><span class="punctuation">,</span><span class="attr">&quot;courseId&quot;</span><span class="punctuation">:</span><span class="number">75</span><span class="punctuation">,</span><span class="attr">&quot;teacherName&quot;</span><span class="punctuation">:</span><span class="string">&quot;ç‹è€å¸ˆ&quot;</span><span class="punctuation">,</span><span class="attr">&quot;position&quot;</span><span class="punctuation">:</span><span class="string">&quot;æ•™å¸ˆèŒä½&quot;</span><span class="punctuation">,</span><span class="attr">&quot;introduction&quot;</span><span class="punctuation">:</span><span class="string">&quot;æ•™å¸ˆç®€ä»‹&quot;</span><span class="punctuation">,</span><span class="attr">&quot;photograph&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span><span class="attr">&quot;createDate&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">null</span></span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>1ï¸âƒ£æ¥å£å®šä¹‰ï¼šController</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;æ·»åŠ /ä¿®æ”¹æ•™å¸ˆä¿¡æ¯&quot;)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/courseTeacher&quot;)</span></span><br><span class="line"><span class="keyword">public</span> CourseTeacher <span class="title function_">modifyCourseTeacher</span><span class="params">(<span class="meta">@RequestBody</span> <span class="meta">@Validated</span> CourseTeacher courseTeacher)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> courseTeacherService.updateCourseTeacher(courseTeacher);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ï¸âƒ£ Service æ¥å£å®šä¹‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿®æ”¹/æ·»åŠ è€å¸ˆ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> courseTeacher è€å¸ˆä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> è€å¸ˆä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">CourseTeacher <span class="title function_">updateCourseTeacher</span><span class="params">(CourseTeacher courseTeacher)</span>;</span><br></pre></td></tr></table></figure><p>3ï¸âƒ£ ServiceImpl å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> CourseTeacher <span class="title function_">updateCourseTeacher</span><span class="params">(CourseTeacher courseTeacher)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (courseTeacher.getId() == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// æ·»åŠ æ“ä½œ</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">insert</span> <span class="operator">=</span> courseTeacherMapper.insert(courseTeacher);</span><br><span class="line">        <span class="keyword">if</span> (insert &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            XueChengPlusException.cast(<span class="string">&quot;æ·»åŠ æ•™å¸ˆå¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// ä¿®æ”¹æ“ä½œ</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> courseTeacherMapper.updateById(courseTeacher);</span><br><span class="line">        <span class="keyword">if</span> (i &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            XueChengPlusException.cast(<span class="string">&quot;ä¿®æ”¹æ•™å¸ˆå¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> courseTeacherMapper.selectOne(<span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;CourseTeacher&gt;().eq(CourseTeacher::getTeacherName, courseTeacher.getTeacherName()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4ï¸âƒ£</p><h3 id="9-3-5-åˆ é™¤æ•™å¸ˆ"><a href="#9-3-5-åˆ é™¤æ•™å¸ˆ" class="headerlink" title="9.3.5 åˆ é™¤æ•™å¸ˆ"></a>9.3.5 åˆ é™¤æ•™å¸ˆ</h3><p>åˆ é™¤æ•™å¸ˆè¯·æ±‚ç¤ºä¾‹</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">delete /ourseTeacher/course/<span class="number">75</span>/<span class="number">26</span></span><br><span class="line"></span><br><span class="line"><span class="number">75</span><span class="punctuation">:</span>è¯¾ç¨‹id</span><br><span class="line"><span class="number">26</span><span class="punctuation">:</span>æ•™å¸ˆidï¼Œå³course_teacherè¡¨çš„ä¸»é”®</span><br><span class="line">è¯·æ±‚å‚æ•°ï¼šè¯¾ç¨‹idã€æ•™å¸ˆid</span><br><span class="line"></span><br><span class="line">å“åº”ï¼šçŠ¶æ€ç <span class="number">200</span>ï¼Œä¸è¿”å›ä¿¡æ¯</span><br></pre></td></tr></table></figure><p>1ï¸âƒ£æ¥å£å®šä¹‰ï¼šController</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;åˆ é™¤æ•™å¸ˆä¿¡æ¯&quot;)</span></span><br><span class="line"><span class="meta">@DeleteMapping(&quot;/courseTeacher/course/&#123;courseId&#125;/&#123;teacherId&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">modifyCourseTeacher</span><span class="params">(<span class="meta">@PathVariable</span> Long courseId, <span class="meta">@PathVariable</span> Long teacherId)</span> &#123;</span><br><span class="line"></span><br><span class="line">    courseTeacherService.deleteCourseTeacher(courseId, teacherId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ï¸âƒ£ Service æ¥å£å®šä¹‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">deleteCourseTeacher</span><span class="params">(Long courseId, Long teacherId)</span>;</span><br></pre></td></tr></table></figure><p>3ï¸âƒ£ ServiceImpl å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteCourseTeacher</span><span class="params">(Long courseId, Long teacherId)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">delete</span> <span class="operator">=</span> courseTeacherMapper.delete(<span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;CourseTeacher&gt;()</span><br><span class="line">                                            .eq(CourseTeacher::getId, teacherId).eq(CourseTeacher::getCourseId, courseId));</span><br><span class="line">    <span class="keyword">if</span> (delete &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        XueChengPlusException.cast(<span class="string">&quot;åˆ é™¤æ•™å¸ˆå¤±è´¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="9-3-6-æ¥å£æµ‹è¯•"><a href="#9-3-6-æ¥å£æµ‹è¯•" class="headerlink" title="9.3.6 æ¥å£æµ‹è¯•"></a>9.3.6 æ¥å£æµ‹è¯•</h3><p>1ã€æ·»åŠ æ•™å¸ˆ</p><p>2ã€æŸ¥è¯¢æ•™å¸ˆ</p><p>3ã€ä¿®æ”¹æ•™å¸ˆ</p><p>4ã€åˆ é™¤æ•™å¸ˆ</p><h2 id="9-4-åˆ é™¤è¯¾ç¨‹"><a href="#9-4-åˆ é™¤è¯¾ç¨‹" class="headerlink" title="9.4 åˆ é™¤è¯¾ç¨‹"></a>9.4 åˆ é™¤è¯¾ç¨‹</h2><h3 id="9-4-1-éœ€æ±‚åˆ†æ"><a href="#9-4-1-éœ€æ±‚åˆ†æ" class="headerlink" title="9.4.1 éœ€æ±‚åˆ†æ"></a>9.4.1 éœ€æ±‚åˆ†æ</h3><p>è¯¾ç¨‹çš„å®¡æ ¸çŠ¶æ€ä¸ºæœªæäº¤æ—¶æ–¹å¯åˆ é™¤ã€‚</p><p>åˆ é™¤è¯¾ç¨‹éœ€è¦åˆ é™¤è¯¾ç¨‹ç›¸å…³çš„åŸºæœ¬ä¿¡æ¯ã€è¥é”€ä¿¡æ¯ã€è¯¾ç¨‹è®¡åˆ’ã€è¯¾ç¨‹æ•™å¸ˆä¿¡æ¯ã€‚</p><h3 id="9-4-2-æ¥å£å®šä¹‰"><a href="#9-4-2-æ¥å£å®šä¹‰" class="headerlink" title="9.4.2 æ¥å£å®šä¹‰"></a>9.4.2 æ¥å£å®šä¹‰</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">delete  /course/<span class="number">87</span></span><br><span class="line"><span class="number">87</span>ä¸ºè¯¾ç¨‹id</span><br><span class="line">è¯·æ±‚å‚æ•°ï¼šè¯¾ç¨‹id</span><br><span class="line">å“åº”ï¼šçŠ¶æ€ç <span class="number">200</span>ï¼Œä¸è¿”å›ä¿¡æ¯</span><br></pre></td></tr></table></figure><p>1ï¸âƒ£æ¥å£å®šä¹‰ï¼šController</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;åˆ é™¤è¯¾ç¨‹&quot;)</span></span><br><span class="line"><span class="meta">@DeleteMapping(&quot;/course/&#123;courseId&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteCourse</span><span class="params">(<span class="meta">@PathVariable</span> Long courseId)</span> &#123;</span><br><span class="line"></span><br><span class="line">    courseBaseInfoService.deleteCourse(courseId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2ï¸âƒ£ Service æ¥å£å®šä¹‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤è¯¾ç¨‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> courseId è¯¾ç¨‹id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">deleteCourse</span><span class="params">(Long courseId)</span>;</span><br></pre></td></tr></table></figure><p>3ï¸âƒ£ ServiceImpl å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteCourse</span><span class="params">(Long courseId)</span> &#123;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­è¯¾ç¨‹æäº¤çŠ¶æ€ï¼Œæœªæäº¤æ‰å¯åˆ é™¤ï¼Œ202002</span></span><br><span class="line">    <span class="type">CourseBase</span> <span class="variable">courseBase</span> <span class="operator">=</span> courseBaseMapper.selectById(courseId);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="string">&quot;202002&quot;</span>.equals(courseBase.getAuditStatus())) &#123;</span><br><span class="line">        XueChengPlusException.cast(<span class="string">&quot;æ— æ³•åˆ é™¤ï¼Œè¯·æ£€æŸ¥è¯¾ç¨‹å®¡æ ¸çŠ¶æ€ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ é™¤è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ï¼šcourse_base</span></span><br><span class="line">    courseBaseMapper.deleteById(courseId);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ é™¤è¯¾ç¨‹è¥é”€ä¿¡æ¯ï¼šcourse_market</span></span><br><span class="line">    courseMarketMapper.deleteById(courseId);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ é™¤è¯¾ç¨‹æ•™å¸ˆä¿¡æ¯ï¼šcourse_teacher</span></span><br><span class="line">    courseTeacherMapper.delete(<span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;CourseTeacher&gt;()</span><br><span class="line">                               .eq(CourseTeacher::getCourseId, courseId));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ é™¤è¯¾ç¨‹è®¡åˆ’ï¼šteachplan</span></span><br><span class="line">    teachplanMapper.delete(<span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;Teachplan&gt;()</span><br><span class="line">                           .eq(Teachplan::getCourseId, courseId));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ é™¤è¯¾ç¨‹è®¡åˆ’åª’èµ„ä¿¡æ¯ï¼šteachplan_media</span></span><br><span class="line">    teachplanMediaMapper.delete(<span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;TeachplanMedia&gt;()</span><br><span class="line">                                .eq(TeachplanMedia::getCourseId, courseId));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ é™¤è¯¾ç¨‹è®¡åˆ’ä½œä¸šä¿¡æ¯ï¼šteachplan_work</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="9-4-3-æ¥å£æµ‹è¯•"><a href="#9-4-3-æ¥å£æµ‹è¯•" class="headerlink" title="9.4.3 æ¥å£æµ‹è¯•"></a>9.4.3 æ¥å£æµ‹è¯•</h3><p>æ‰¾åˆ°ä¸€é—¨è¯¾ç¨‹è¿›è¡Œåˆ é™¤ï¼Œåˆ é™¤åä»æ•°æ®åº“ç¡®è®¤è¯¾ç¨‹åŸºæœ¬ä¿¡æ¯ã€è¯¾ç¨‹è¥é”€ä¿¡æ¯ã€è¯¾ç¨‹è®¡åˆ’ã€è¯¾ç¨‹è®¡åˆ’å…³è”ä¿¡æ¯ã€è¯¾ç¨‹å¸ˆèµ„æ˜¯å¦åˆ é™¤æˆåŠŸã€‚</p>]]></content>
    
    
    <summary type="html">ç¬¬äºŒç«  å†…å®¹ç®¡ç†æ¨¡å—</summary>
    
    
    
    <category term="é¡¹ç›®" scheme="https://www.taoyaopc.live/categories/%E9%A1%B9%E7%9B%AE/"/>
    
    
    <category term="Java" scheme="https://www.taoyaopc.live/tags/Java/"/>
    
    <category term="Spring" scheme="https://www.taoyaopc.live/tags/Spring/"/>
    
    <category term="SpringCloud" scheme="https://www.taoyaopc.live/tags/SpringCloud/"/>
    
  </entry>
  
</feed>
